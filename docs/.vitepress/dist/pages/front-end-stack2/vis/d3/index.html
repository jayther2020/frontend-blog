<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>D3.js | 个人前端知识库</title>
    <meta name="description" content="用来整理自己所学的前端知识，收藏过的技术博客，心得体会等">
    <link rel="stylesheet" href="/frontend-blog/assets/style.efc7c571.css">
    <link rel="modulepreload" href="/frontend-blog/assets/app.faf1c2cf.js">
    <link rel="modulepreload" href="/frontend-blog/assets/pages_front-end-stack2_vis_d3_index.md.9c377a64.lean.js">
    
    <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-c6a644e1><!--[--><!--]--><!--[--><span tabindex="-1" data-v-151f2593></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-151f2593> Skip to content </a><!--]--><!----><header class="VPNav" data-v-c6a644e1 data-v-a71a30f1><div class="VPNavBar has-sidebar" data-v-a71a30f1 data-v-6f1d18b5><div class="container" data-v-6f1d18b5><div class="VPNavBarTitle has-sidebar" data-v-6f1d18b5 data-v-d5925166><a class="title" href="/frontend-blog/" data-v-d5925166><!--[--><!--]--><!----><!--[-->个人前端知识库<!--]--><!--[--><!--]--></a></div><div class="content" data-v-6f1d18b5><!--[--><!--]--><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-6f1d18b5 data-v-f83db6ba><span id="main-nav-aria-label" class="visually-hidden" data-v-f83db6ba>Main Navigation</span><!--[--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-f83db6ba data-v-6ffb57d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-6ffb57d3><span class="text" data-v-6ffb57d3><!----> 前端基础 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-6ffb57d3><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-6ffb57d3><div class="VPMenu" data-v-6ffb57d3 data-v-1c5d0cfc><div class="items" data-v-1c5d0cfc><!--[--><!--[--><div class="VPMenuLink" data-v-1c5d0cfc data-v-e8e0fb1d><a class="VPLink link" href="/frontend-blog/pages/front-end-stack1/basic/html/" data-v-e8e0fb1d data-v-3c355974><!--[-->HTML<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-1c5d0cfc data-v-e8e0fb1d><a class="VPLink link" href="/frontend-blog/pages/front-end-stack1/basic/css1/" data-v-e8e0fb1d data-v-3c355974><!--[-->CSS<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-1c5d0cfc data-v-e8e0fb1d><a class="VPLink link" href="/frontend-blog/pages/front-end-stack1/basic/js1/" data-v-e8e0fb1d data-v-3c355974><!--[-->Javascript<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-1c5d0cfc data-v-e8e0fb1d><a class="VPLink link" href="/frontend-blog/pages/front-end-stack1/basic/js4/" data-v-e8e0fb1d data-v-3c355974><!--[-->网络请求<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-1c5d0cfc data-v-e8e0fb1d><a class="VPLink link" href="/frontend-blog/pages/front-end-stack1/tools/jquery/" data-v-e8e0fb1d data-v-3c355974><!--[-->jQUERY<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-f83db6ba data-v-6ffb57d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-6ffb57d3><span class="text" data-v-6ffb57d3><!----> 前端框架 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-6ffb57d3><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-6ffb57d3><div class="VPMenu" data-v-6ffb57d3 data-v-1c5d0cfc><div class="items" data-v-1c5d0cfc><!--[--><!--[--><div class="VPMenuLink" data-v-1c5d0cfc data-v-e8e0fb1d><a class="VPLink link" href="/frontend-blog/pages/front-end-stack2/framework/vue1/" data-v-e8e0fb1d data-v-3c355974><!--[-->Vue<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-1c5d0cfc data-v-e8e0fb1d><a class="VPLink link" href="/frontend-blog/pages/front-end-stack2/framework/react/" data-v-e8e0fb1d data-v-3c355974><!--[-->React<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-1c5d0cfc data-v-e8e0fb1d><a class="VPLink link" href="/frontend-blog/pages/front-end-stack2/framework/nodejs/" data-v-e8e0fb1d data-v-3c355974><!--[-->Nodejs<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-1c5d0cfc data-v-e8e0fb1d><a class="VPLink link active" href="/frontend-blog/pages/front-end-stack2/vis/d3/" data-v-e8e0fb1d data-v-3c355974><!--[-->D3.js<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/frontend-blog/pages/computer-knowledge-stack/" data-v-f83db6ba data-v-47a2263e data-v-3c355974><!--[-->计算机基础<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/frontend-blog/pages/thoughts/" data-v-f83db6ba data-v-47a2263e data-v-3c355974><!--[-->心得体会<!--]--><!----></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-6f1d18b5 data-v-a3e7452b><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-a3e7452b data-v-31fdf26f data-v-eba7420e><span class="check" data-v-eba7420e><span class="icon" data-v-eba7420e><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-31fdf26f><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-31fdf26f><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-6f1d18b5 data-v-738bef5a data-v-f6988cfb><!--[--><a class="VPSocialLink" href="https://gitee.com/jayther2020" target="_blank" rel="noopener" data-v-f6988cfb data-v-e57698f6><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>码云</title><path d="M11.984 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.016 0zm6.09 5.333c.328 0 .593.266.592.593v1.482a.594.594 0 0 1-.593.592H9.777c-.982 0-1.778.796-1.778 1.778v5.63c0 .327.266.592.593.592h5.63c.982 0 1.778-.796 1.778-1.778v-.296a.593.593 0 0 0-.592-.593h-4.15a.592.592 0 0 1-.592-.592v-1.482a.593.593 0 0 1 .593-.592h6.815c.327 0 .593.265.593.592v3.408a4 4 0 0 1-4 4H5.926a.593.593 0 0 1-.593-.593V9.778a4.444 4.444 0 0 1 4.445-4.444h8.296Z"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-6f1d18b5 data-v-e4361c82 data-v-6ffb57d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-6ffb57d3><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-6ffb57d3><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-6ffb57d3><div class="VPMenu" data-v-6ffb57d3 data-v-1c5d0cfc><!----><!--[--><!--[--><!----><div class="group" data-v-e4361c82><div class="item appearance" data-v-e4361c82><p class="label" data-v-e4361c82>Appearance</p><div class="appearance-action" data-v-e4361c82><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-e4361c82 data-v-31fdf26f data-v-eba7420e><span class="check" data-v-eba7420e><span class="icon" data-v-eba7420e><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-31fdf26f><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-31fdf26f><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-e4361c82><div class="item social-links" data-v-e4361c82><div class="VPSocialLinks social-links-list" data-v-e4361c82 data-v-f6988cfb><!--[--><a class="VPSocialLink" href="https://gitee.com/jayther2020" target="_blank" rel="noopener" data-v-f6988cfb data-v-e57698f6><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>码云</title><path d="M11.984 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.016 0zm6.09 5.333c.328 0 .593.266.592.593v1.482a.594.594 0 0 1-.593.592H9.777c-.982 0-1.778.796-1.778 1.778v5.63c0 .327.266.592.593.592h5.63c.982 0 1.778-.796 1.778-1.778v-.296a.593.593 0 0 0-.592-.593h-4.15a.592.592 0 0 1-.592-.592v-1.482a.593.593 0 0 1 .593-.592h6.815c.327 0 .593.265.593.592v3.408a4 4 0 0 1-4 4H5.926a.593.593 0 0 1-.593-.593V9.778a4.444 4.444 0 0 1 4.445-4.444h8.296Z"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-6f1d18b5 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div><!----></header><div class="VPLocalNav" data-v-c6a644e1 data-v-aac27d5e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-aac27d5e><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-aac27d5e><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-aac27d5e>Menu</span></button><a class="top-link" href="#" data-v-aac27d5e> Return to top </a></div><aside class="VPSidebar" data-v-c6a644e1 data-v-0f582cdc><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-0f582cdc><span class="visually-hidden" id="sidebar-aria-label" data-v-0f582cdc> Sidebar Navigation </span><!--[--><div class="group" data-v-0f582cdc><section class="VPSidebarGroup collapsible" data-v-0f582cdc data-v-6e45c352><div class="title" role="button" data-v-6e45c352><h2 class="title-text" data-v-6e45c352>前端框架</h2><div class="action" data-v-6e45c352><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-6e45c352><!--[--><!--[--><a class="VPLink link link" href="/frontend-blog/pages/front-end-stack2/framework/vue1/" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Vue2</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/frontend-blog/pages/front-end-stack2/framework/vue2/" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Vue3</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/frontend-blog/pages/front-end-stack2/framework/react/" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>React</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/frontend-blog/pages/front-end-stack2/framework/nodejs/" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Nodejs</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/frontend-blog/pages/front-end-stack2/framework/typescript/" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>Typescript</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><div class="group" data-v-0f582cdc><section class="VPSidebarGroup collapsible" data-v-0f582cdc data-v-6e45c352><div class="title" role="button" data-v-6e45c352><h2 class="title-text" data-v-6e45c352>前端可视化</h2><div class="action" data-v-6e45c352><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-6e45c352><!--[--><!--[--><a class="VPLink link link" href="/frontend-blog/pages/front-end-stack2/vis/echarts/" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>echarts</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link active" href="/frontend-blog/pages/front-end-stack2/vis/d3/" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>d3js</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/frontend-blog/pages/front-end-stack2/vis/svg/" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>SVG</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/frontend-blog/pages/front-end-stack2/vis/canvas/" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>HTML5Canvas</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-c6a644e1 data-v-c95df128><div class="VPDoc has-sidebar has-aside" data-v-c95df128 data-v-37ebe389><div class="container" data-v-37ebe389><div class="aside" data-v-37ebe389><div class="aside-curtain" data-v-37ebe389></div><div class="aside-container" data-v-37ebe389><div class="aside-content" data-v-37ebe389><div class="VPDocAside" data-v-37ebe389 data-v-afc4c1a1><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" data-v-afc4c1a1 data-v-2865c0b0><div class="content" data-v-2865c0b0><div class="outline-marker" data-v-2865c0b0></div><div class="outline-title" data-v-2865c0b0>目录</div><nav aria-labelledby="doc-outline-aria-label" data-v-2865c0b0><span class="visually-hidden" id="doc-outline-aria-label" data-v-2865c0b0> Table of Contents for current page </span><ul class="root" data-v-2865c0b0 data-v-1188541a><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-afc4c1a1></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-37ebe389><div class="content-container" data-v-37ebe389><!--[--><!--]--><main class="main" data-v-37ebe389><div style="position:relative;" class="vp-doc _frontend-blog_pages_front-end-stack2_vis_d3_index" data-v-37ebe389><div><h1 id="d3-js" tabindex="-1">D3.js <a class="header-anchor" href="#d3-js" aria-hidden="true">#</a></h1><img src="/frontend-blog/assets/OIG.77e8e50a.jpg" alt="OIG (36-2)"><blockquote><p>D3.js不会给我们提供现成的图表，而是给我们提供制作图表的基本工具。所以有很强大的灵活性。</p><p>代价是方法和功能超多，而且就连普通的图表都需要几十行的代码来实现。</p><p>所以D3.js更适合用于高度自定义化的图表的设计。我们在这只记录我们最需要的。</p></blockquote><h2 id="开始使用" tabindex="-1">开始使用 <a class="header-anchor" href="#开始使用" aria-hidden="true">#</a></h2><p><strong>基本信息</strong></p><blockquote><p>最近版本：7</p><p>需要：SVG基础，D3用此来绘制图表</p><p>可参考教程：<a href="https://www.d3indepth.com/" target="_blank" rel="noreferrer">https://www.d3indepth.com/</a></p><p>可参考仓库：<a href="https://github.com/wantnocode/Learn-D3" target="_blank" rel="noreferrer">https://github.com/wantnocode/Learn-D3</a></p></blockquote><p><strong>安装</strong></p><blockquote><p>CDN：<a href="https://d3js.org/d3.v7.js" target="_blank" rel="noreferrer">d3js.org/d3.v7.js</a></p><p>压缩库CDN：<a href="https://d3js.org/d3.v7.min.js" target="_blank" rel="noreferrer">https://d3js.org/d3.v7.min.js</a></p><p>npm: <code>npm i d3 -S</code></p><p><strong>d3类型(不安装的话，你写代码没类型提示补全，会不太方便)。</strong>：<code>npm i @types/d3 -D</code></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#676E95;">/** </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">type</span><span style="color:#676E95;"> </span><span style="color:#89DDFF;">{</span><span style="color:#FFCB6B;">import(&#39;d3&#39;).BaseType</span><span style="color:#89DDFF;">}</span><span style="color:#676E95;"> */</span></span>
<span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">as</span><span style="color:#A6ACCD;"> d3 </span><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">d3</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span></code></pre></div></blockquote><p><strong>集成于Vue当中</strong></p><p><code>index.js</code></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">as</span><span style="color:#A6ACCD;"> d3 </span><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">d3</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> app </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">createApp</span><span style="color:#A6ACCD;">(App)</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">config</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">globalProperties</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">$d3 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> d3</span></span>
<span class="line"></span></code></pre></div><p><code>组件当中</code></p><div class="language-vue"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">script</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">setup</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#676E95;">// import * as d3 from &quot;d3&quot;;</span></span>
<span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">getCurrentInstance</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">vue</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">proxy</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">getCurrentInstance</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(proxy</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">$d3)</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre></div><p><code>只引入必需元素</code></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">axisTop</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">axisLeft</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">format</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">d3</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> store </span><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">module/store/index</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> useFieldPatternStore </span><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">module/store/fieldPattern/graph-thickness</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> diagramStore </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">useFieldPatternStore</span><span style="color:#A6ACCD;">(store)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">useAxis</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">xScale</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">yScale</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#676E95;">/** x轴 */</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">xAxis</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">axisTop</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">xScale</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ticks</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">10</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tickSize</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">6</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tickFormat</span><span style="color:#F07178;">(</span><span style="color:#82AAFF;">format</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">d</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">)) </span><span style="color:#676E95;">// * 主刻度的轴</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">xMinorAxis</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">axisTop</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">xScale</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ticks</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">100</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tickSize</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">3</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tickFormat</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;&#39;</span><span style="color:#F07178;">) </span><span style="color:#676E95;">// * 副刻度的轴</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#676E95;">/** y轴 */</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">yAxis</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">axisLeft</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">yScale</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ticks</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">5</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tickSize</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">6</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tickFormat</span><span style="color:#F07178;">(</span><span style="color:#82AAFF;">format</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">d</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">)) </span><span style="color:#676E95;">// * 主刻度的轴</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">yMinorAxis</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">axisLeft</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">yScale</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ticks</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">50</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tickSize</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">3</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tickFormat</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;&#39;</span><span style="color:#F07178;">) </span><span style="color:#676E95;">// * 副刻度的轴</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">xAxis</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">xMinorAxis</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">yAxis</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">yMinorAxis</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><h2 id="dom操作" tabindex="-1">DOM操作 <a class="header-anchor" href="#dom操作" aria-hidden="true">#</a></h2><table><thead><tr><th>方法</th><th>参数</th><th>用途</th></tr></thead><tbody><tr><td><code>select</code></td><td>CSS选择器/DOM元素</td><td>用选择器选择<em>第一个匹配的</em>元素</td></tr><tr><td><code>selectAll</code></td><td>CSS选择器</td><td>用选择器选择所有匹配的元素</td></tr><tr><td><code>append</code></td><td>被添加的元素/<em>返回DOM元素的函数</em></td><td>向添加元素</td></tr><tr><td><code>attr</code></td><td>元素属性名，属性值/<em>返回属性值的函数</em></td><td>向元素添加属性</td></tr><tr><td><code>style</code></td><td>CSS样式名，CSS样式值/<em>返回样式值的函数</em></td><td>向元素添加CSS样式</td></tr><tr><td><code>text</code></td><td>文本内容/<em>返回文本内容的函数</em></td><td>修改innerHtml（里面显示的文本内容）</td></tr><tr><td><code>create</code></td><td>标签名/<em>返回DOM元素的函数</em></td><td>创建指定的元素</td></tr><tr><td><code>size</code></td><td>/</td><td>返回当前选择对象的节点个数</td></tr><tr><td><code>empty</code></td><td>/</td><td>返回当前选择对象是否为空</td></tr></tbody></table><blockquote><ol><li><p>你会注意到有可以传进函数的选项，请参考<a href="#%E9%92%88%E5%AF%B9%60attr%60%E4%BC%A0%E5%8F%82">针对&#39;attr&#39;传参</a>部分来了解d3如何通过这些函数传递数据的</p></li><li><p>d3的select，selectAll，create返回的并不是DOM元素本身。</p><p>需要分别通过调用<code>.node()</code>，<code>.nodes()</code>方法来返回DOM节点和DOM节点数组。</p></li><li><p>在使用<code>d3.create()</code>==创建svg元素==的时候，==请记得加上前缀<code>svg:</code>==来代表它是<em>svg</em>的元素，不然会被当成自定义元素！比如：<code>create(svg:g)</code>是创建svg的分组，<code>create(g)</code>仅仅只是自定义元素<code>g</code></p></li></ol></blockquote><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#A6ACCD;">d3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">create</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">svg:g</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">) </span><span style="color:#676E95;">// an SVG G element</span></span>
<span class="line"><span style="color:#A6ACCD;">d3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">create</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">g</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">) </span><span style="color:#676E95;">// an HTML G (unknown) element</span></span>
<span class="line"></span></code></pre></div><p><strong>选择元素的属性</strong></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> bodySelection </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> d3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">select</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">body</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> svgSelection </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> bodySelection</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">append</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">svg</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">width</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">50</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">height</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">50</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> circleSelection </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> svgSelection</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">append</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">circle</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">cx</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">25</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">cy</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">25</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">r</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">25</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">style</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fill</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">purple</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h2 id="数据绑定" tabindex="-1">数据绑定 <a class="header-anchor" href="#数据绑定" aria-hidden="true">#</a></h2><h3 id="传参函数data" tabindex="-1">传参函数<code>data()</code> <a class="header-anchor" href="#传参函数data" aria-hidden="true">#</a></h3><blockquote><p>格式：<code>data(dataArray)</code>，其中<code>dataArray</code>是数据数组<code>Array&lt;&gt;</code>，如：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#A6ACCD;">[</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Sebastian</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;">384</span><span style="color:#89DDFF;">},{</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Ciel</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;">32</span><span style="color:#89DDFF;">},{</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Cai Yun</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;">value</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;">16</span><span style="color:#A6ACCD;">)]</span></span>
<span class="line"></span></code></pre></div><p>默认的绑定按照双方的索引顺序，数据的更新只需要重新绑定另一个<code>dataArray</code>即可</p><p><em>原理：每个图元数据会存储在对应的DOM元素的<code>__data__</code>属性下。</em></p></blockquote><img src="/frontend-blog/assets/inspect_data.97931b9a.gif" alt="Inspecting data" style="zoom:66%;"><h3 id="数据的三个阶段" tabindex="-1">数据的三个阶段 <a class="header-anchor" href="#数据的三个阶段" aria-hidden="true">#</a></h3><img src="/frontend-blog/assets/image-20240206013401430.59d04765.png" alt="image-20240206013401430" style="zoom:60%;"><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#A6ACCD;">d3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">select</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">body</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">selectAll</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">p</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">) </span><span style="color:#676E95;">// 创建虚拟的标签模板</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">data</span><span style="color:#A6ACCD;">(theData) </span><span style="color:#676E95;">// 绑定数据</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">enter</span><span style="color:#A6ACCD;">() </span><span style="color:#676E95;">// 填入选择集</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">append</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">p</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">) </span><span style="color:#676E95;">// 加入p元素，此时加入的还是空元素，需要改一下内容</span></span>
<span class="line"></span></code></pre></div><blockquote><p>D3.js 通过数据操作符（Data Operator）返回三个虚拟选择集（virtual selections），而不是像其他方法那样只返回一个。</p><p>它们分别是：enter、update 和 exit。对应数据处理涉及到的三个阶段：填入(enter)，更新(update)，退出(exit)</p><p>它们在不同的场景下使用，以便更有效地处理数据绑定和可视化元素的增删改。</p><p>解释可以看：<a href="https://bost.ocks.org/mike/join/" target="_blank" rel="noreferrer">Thinking with Joins (ocks.org)</a>； 备用链接：<a href="http://web.archive.org/web/20201109031013/https://bost.ocks.org/mike/join/" target="_blank" rel="noreferrer">Thinking with Joins (archive.org)</a></p></blockquote><h4 id="enter-选择集" tabindex="-1">Enter 选择集 <a class="header-anchor" href="#enter-选择集" aria-hidden="true">#</a></h4><p>用于处理在数据集中存在，但 DOM 中尚不存在的数据。</p><p>当将新数据绑定到已有元素时，enter 选择集将为这些新数据创建占位符。</p><p>在 enter 选择集中，你可以指定如何创建新元素（例如，添加 SVG 元素或其他元素），并设置其初始属性和样式。</p><p>使用场景包括：为新数据添加新的可视化元素、为新数据设置初始属性等。</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#A6ACCD;">d3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">select</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">svg</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">selectAll</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">circle</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">) </span><span style="color:#676E95;">// 选择所有元素返回空DOM数组对象</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">data</span><span style="color:#A6ACCD;">(newData) </span><span style="color:#676E95;">// 传进数组数据</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">enter</span><span style="color:#A6ACCD;">() </span><span style="color:#676E95;">// 使用 enter 选择集</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">append</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">circle</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">) </span><span style="color:#676E95;">// 向里面加入元素</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">r</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">5</span><span style="color:#A6ACCD;">) </span><span style="color:#676E95;">// 修改元素属性</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fill</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">blue</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h4 id="update-选择集" tabindex="-1">Update 选择集 <a class="header-anchor" href="#update-选择集" aria-hidden="true">#</a></h4><p>用于处理已经绑定到数据的现有元素。</p><p>当新的数据集与已有元素结合时，update 选择集将包含这些现有元素。</p><p>在 update 选择集中，你可以根据新数据对元素的属性和样式进行更新。</p><p>使用场景包括：根据新数据更新可视化元素的位置、根据新数据改变元素的颜色等。</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#A6ACCD;">d3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">select</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">svg</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">selectAll</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">circle</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">data</span><span style="color:#A6ACCD;">(newData) </span><span style="color:#676E95;">// 直接更新数据</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">cx</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">d</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> d</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">x) </span><span style="color:#676E95;">// 修改元素属性</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">cy</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">d</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> d</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">y)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fill</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">d</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> d</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">color)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h4 id="exit-选择集" tabindex="-1">Exit 选择集 <a class="header-anchor" href="#exit-选择集" aria-hidden="true">#</a></h4><p>用于处理在数据集中已不存在，但仍然存在于 DOM 中的元素。</p><p>当将新数据绑定到已有元素时，如果数据集中的元素数量减少，那么 exit 选择集将包含这些多余的元素。</p><p>在 exit 选择集中，你可以指定如何删除这些元素（例如，通过过渡动画来移除元素）。</p><p>使用场景包括：删除不再需要的可视化元素、为删除的元素添加过渡动画等。</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#A6ACCD;">d3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">select</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">svg</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">selectAll</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">circle</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">data</span><span style="color:#A6ACCD;">(newData) </span><span style="color:#676E95;">//更新数据</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">exit</span><span style="color:#A6ACCD;">() </span><span style="color:#676E95;">//多余，没用的数据</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">remove</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">//会被移除DOM</span></span>
<span class="line"></span></code></pre></div><h3 id="针对attr传参" tabindex="-1">针对<code>attr</code>传参 <a class="header-anchor" href="#针对attr传参" aria-hidden="true">#</a></h3><blockquote><p><code>selection.attr(&#39;attrbuteName&#39;,&#39;value&#39;)</code></p><ul><li>支持直接通过值来设置属性</li><li>支持通过函数来设置属性，格式如下：</li></ul><p><code>selection.attr(&#39;attrbuteName&#39;,(d,i)=&gt;{...})</code></p><ul><li>d为绑定给图元的数据（即将到来）</li><li>i为图元的索引，是一个整数，如<code>d3.selectAll(rect&#39;)</code>中的第几个矩形</li></ul></blockquote><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> theData </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> [</span><span style="color:#F78C6C;">10</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">20</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">30</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">onMounted</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#676E95;">/** 以后一律省略onMounted **/</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">var</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">p</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">d3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">select</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">body</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">selectAll</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">p</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">) </span><span style="color:#676E95;">// 选择</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">data</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">theData</span><span style="color:#F07178;">) </span><span style="color:#676E95;">// 绑定数据</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">enter</span><span style="color:#F07178;">() </span><span style="color:#676E95;">// 填入选择集</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">append</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">p</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">) </span><span style="color:#676E95;">// 加入p元素</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">text</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">msg</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">idx</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">`</span><span style="color:#C3E88D;">index: </span><span style="color:#89DDFF;">${</span><span style="color:#A6ACCD;">idx</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;"> ;message: </span><span style="color:#89DDFF;">${</span><span style="color:#A6ACCD;">msg</span><span style="color:#89DDFF;">}`</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span><span style="color:#F07178;"> </span><span style="color:#676E95;">// 使用传进去的数据来返回处理后的值</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><h3 id="join-绑定数据方法" tabindex="-1"><code>join()</code>绑定数据方法 <a class="header-anchor" href="#join-绑定数据方法" aria-hidden="true">#</a></h3><blockquote><p>是在<em>v5版本</em>当中新出的绑定数据的方法，可以代替上面提到的进入更新退出的繁琐方法。</p><p>有两种传参形式。使用方法如下。三个过程函数还是以之前的方法用即可。</p></blockquote><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#676E95;">// 方法1：只传进字符串作为要添加的元素</span></span>
<span class="line"><span style="color:#A6ACCD;">WellNodePosition</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">selectAll</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">circle</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">data</span><span style="color:#A6ACCD;">(fakeWellData)</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">join</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">circle</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">) </span><span style="color:#676E95;">// 完成数据绑定并用数据生成指定元素</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">cx</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> d</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">x)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">cy</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> d</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">y)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">r</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">fill</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> d</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">wellType </span><span style="color:#89DDFF;">?</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">red</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">white</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// 方法2：传进三个数据处理函数作为过程参数</span></span>
<span class="line"><span style="color:#A6ACCD;">WellNodePosition</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">selectAll</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">g</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">data</span><span style="color:#A6ACCD;">(fakeWellData)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">join</span><span style="color:#A6ACCD;">(</span><span style="color:#A6ACCD;">enter</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> enter</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">append</span><span style="color:#A6ACCD;">(</span><span style="color:#A6ACCD;">d</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">wellNodeFn</span><span style="color:#A6ACCD;">(d)))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// * 等价于：</span></span>
<span class="line"><span style="color:#A6ACCD;">WellNodePosition</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">selectAll</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">g</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">data</span><span style="color:#A6ACCD;">(fakeWellData)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">join</span><span style="color:#A6ACCD;">(</span><span style="color:#A6ACCD;">enter</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> enter</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">append</span><span style="color:#A6ACCD;">(</span><span style="color:#A6ACCD;">d</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">wellNodeFn</span><span style="color:#A6ACCD;">(d))</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">update</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> update</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">exit</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> exit</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">remove</span><span style="color:#A6ACCD;">())</span></span>
<span class="line"></span></code></pre></div><blockquote><p>可通过调用<code>each()</code>函数来直接自定义分配数据的流程。</p><p><code>each()</code>的传参函数的参数是数据<code>d</code>，索引号<code>i</code>，遍历本体<code>n</code>，而普通函数的<code>this</code>指向才是遍历的单个元素。</p></blockquote><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#A6ACCD;">WellNodePosition</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">selectAll</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">g</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">data</span><span style="color:#A6ACCD;">(fakeWellData)</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">join</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">g</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">each</span><span style="color:#A6ACCD;">(wellNodeFn) </span><span style="color:#676E95;">// 看成 d =&gt; wellNodeFn(d)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">/***** 用个普通函数可以用内置的this代表当前的被遍历的元素：*****/</span></span>
<span class="line"><span style="color:#A6ACCD;">WellNodePosition</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">selectAll</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">g</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">data</span><span style="color:#A6ACCD;">(fakeWellData)</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">join</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">g</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">each</span><span style="color:#A6ACCD;">(</span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">(){</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">doSomethingWithEntity</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">) </span><span style="color:#676E95;">// 无别的同类写法</span></span>
<span class="line"></span></code></pre></div><h2 id="建立映射（比例尺）" tabindex="-1">建立映射（比例尺） <a class="header-anchor" href="#建立映射（比例尺）" aria-hidden="true">#</a></h2><blockquote><p>作用：对于体量再大的数据，也有办法来在一个限定大小的图表空间表示。办法就是将数据范围给映射到视图范围即可</p><p>映射给出两个方法，分别定义数据范围domain和视图范围range。</p><p>查看所有的映射请参考：<a href="https://d3js.org/d3-scale" target="_blank" rel="noreferrer">d3-scale | D3 by Observable (d3js.org)</a></p></blockquote><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#676E95;">// 定义方法1</span></span>
<span class="line"><span style="color:#A6ACCD;">d3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">scaleUtc</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">domain</span><span style="color:#A6ACCD;">([</span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Date</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">2023-07-01</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Date</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">2024-07-05</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)])</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">range</span><span style="color:#A6ACCD;">([marginLeft</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> width </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> marginRight])</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// 定义方法2</span></span>
<span class="line"><span style="color:#A6ACCD;">d3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">scaleLinear</span><span style="color:#A6ACCD;">([</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">100</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> [height </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> marginBottom</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> marginTop])</span></span>
<span class="line"></span></code></pre></div><p><strong>基本映射</strong></p><table><thead><tr><th>映射类型，参数为domain和range</th><th>释义</th><th>备注</th></tr></thead><tbody><tr><td><code>scaleLinear()</code></td><td>线性比例尺，适用于数值型数据，将连续的输入域映射到连续的输出范围</td><td>可支持负值</td></tr><tr><td><code>scaleIdentity(range)</code></td><td><code>scaleLinear()</code>的特例，它定义域与值域映射相等</td><td>只用传入范围</td></tr><tr><td><code>scaleTime()</code>，<code>scaleUtc()</code></td><td>时间比例尺，用于将时间在一定范围内进行映射到连续的输出范围</td><td>只可以传入时间</td></tr></tbody></table><p><strong>大范围映射</strong>：用于超大范围的映射</p><p><img src="/frontend-blog/assets/image-20230704155556825.76acb54b.png" alt="image-20230704155556825"></p><table><thead><tr><th>映射类型，参数为domain和range</th><th>释义</th><th>备注</th></tr></thead><tbody><tr><td><code>scaleLog()</code></td><td>将输入域用对数型的映射关系映射到连续的输出范围，</td><td>默认基底为2，定义域<em>不能</em>包含0</td></tr><tr><td><code>scalePow()</code></td><td>将输入域用指数型的映射关系映射到连续的输出范围，</td><td>一开始必须通过<code>.exponent()</code>设定指数</td></tr><tr><td>*<code>scaleSymlog()</code></td><td>将输入域用与y轴对称的对数型的映射关系映射到连续的输出范围</td><td>参数为1，定义域<em>能</em>包含0</td></tr></tbody></table><p><strong>输入是离散的</strong>：将一组离散的输入值映射到一组连续的输出值</p><table><thead><tr><th>映射类型，参数为domain和range</th><th>释义</th></tr></thead><tbody><tr><td><code>scalePoint()</code></td><td>点状比例尺，将每个输入值映射到输出值中的一个点，而不是一个区间。</td></tr><tr><td><code>scaleBand()</code></td><td>分段比例尺，将每个输入值映射到输出值中的一个区间。<em>适用于条状图</em>。</td></tr><tr><td><code>scaleOrdinal()</code></td><td>将不连续的输入域映射到不连续的输出范围，适用于非数值型数据</td></tr></tbody></table><p><strong>输出是离散的</strong>：输出范围必须是离散值</p><table><thead><tr><th>映射类型，参数为domain和range</th><th>释义</th></tr></thead><tbody><tr><td><code>scaleThreshold()</code></td><td>将连续的输入域映射到离散的输出范围，根据输入值的阈值确定输出值</td></tr><tr><td><code>scaleQuantize()</code></td><td>定义域的范围会根据离散型值域中可取值的数量划分为等距的片段</td></tr><tr><td><code>scaleQuantile()</code></td><td>将输入的数据作为总体（一堆通过采样获取的离散值），这样就可以接受在该总体范围中的任意值输入（即定义域是连续型），可以计算出它在总体中的分位数，然后基于分位数再找出在值域中一些列离散值中的那个对应值。</td></tr></tbody></table><h2 id="坐标轴" tabindex="-1">坐标轴 <a class="header-anchor" href="#坐标轴" aria-hidden="true">#</a></h2><p><img src="/frontend-blog/assets/image-20230703220101406.b925efcf.png" alt="image-20230703220101406"></p><blockquote><p>将坐标轴的各个轴成分视为svg部件加入到SVG容器当中。一般分为两个步骤来进行坐标轴绘制：</p><ol><li><em>创建坐标轴对象</em>，在坐标轴对象来设置像刻度个数，刻度大小，刻度边距，刻度渲染格式等属性</li><li>新建或者选择某个要作为坐标轴的<code>&lt;g&gt;&lt;/g&gt;</code>元素<em>并应用坐标轴对象</em>以进行渲染，并在渲染完的基础上重新选择并<a href="#%E5%A4%96%E8%A7%82%E5%B1%9E%E6%80%A7">修改坐标轴外观</a>。</li></ol></blockquote><table><thead><tr><th>坐标轴类型</th><th>释义</th></tr></thead><tbody><tr><td><code>axisTop()</code></td><td>水平坐标轴</td></tr><tr><td><code>axisBottom()</code></td><td>水平坐标轴</td></tr><tr><td><code>axisLeft()</code></td><td>垂直坐标轴</td></tr><tr><td><code>axisRight()</code></td><td>垂直坐标轴</td></tr></tbody></table><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#676E95;">// 新建比例尺以设置坐标轴范围</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> xScale </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">scaleLinear</span><span style="color:#A6ACCD;">([</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#F78C6C;">100</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> [</span><span style="color:#F78C6C;">30</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">200</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">30</span><span style="color:#A6ACCD;">]) </span><span style="color:#676E95;">// x比例尺</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// 创建坐标轴对象并设置刻度属性</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> xAxis </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">axisTop</span><span style="color:#A6ACCD;">(xScale)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ticks</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">10</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tickSize</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">6</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tickFormat</span><span style="color:#A6ACCD;">(</span><span style="color:#82AAFF;">format</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">d</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)) </span><span style="color:#676E95;">// * 主刻度的轴</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> xMinorAxis </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">axisTop</span><span style="color:#A6ACCD;">(xScale)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ticks</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">100</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tickSize</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tickFormat</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">()</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">&#39;&#39;</span><span style="color:#A6ACCD;">) </span><span style="color:#676E95;">// * 副刻度的轴</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// 选择svg的部件并应用坐标轴对象以生成坐标轴图例</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> xAxisInt </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> svg</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">select</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">g.axis_x</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">transform</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">`</span><span style="color:#C3E88D;">translate(</span><span style="color:#89DDFF;">${</span><span style="color:#F78C6C;">100</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">,</span><span style="color:#89DDFF;">${</span><span style="color:#F78C6C;">100</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">)</span><span style="color:#89DDFF;">`</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">call</span><span style="color:#A6ACCD;">(xAxis)</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> xMinorAxisInt </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> svg</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">select</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">g.axis_xm</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">transform</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">`</span><span style="color:#C3E88D;">translate(</span><span style="color:#89DDFF;">${</span><span style="color:#F78C6C;">100</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">,</span><span style="color:#89DDFF;">${</span><span style="color:#F78C6C;">100</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">)</span><span style="color:#89DDFF;">`</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">call</span><span style="color:#A6ACCD;">(xMinorAxis)</span></span>
<span class="line"></span></code></pre></div><blockquote><p>属性更改后，请再次调用<code>坐标轴图元对象.call(修改后的坐标轴)</code>来完成坐标轴数据或者参数更改。</p><p>可以通过设置transition的方式来更改更平滑地更改数据。</p></blockquote><h3 id="刻度属性" tabindex="-1">刻度属性 <a class="header-anchor" href="#刻度属性" aria-hidden="true">#</a></h3><p>在<em>坐标轴对象</em>当中设置。</p><table><thead><tr><th>参数</th><th>释义</th><th>默认值</th><th>备注</th></tr></thead><tbody><tr><td><code>ticks()</code></td><td>坐标轴刻度的个数，和格式化符</td><td>10</td><td>刻度个数只可为<em>1,2,5的倍数</em>及<em>10次幂</em></td></tr><tr><td><code>tickSize()</code></td><td>每个坐标刻度的大小</td><td>6</td><td>和下面两个属性不能同时设置</td></tr><tr><td><code>tickSizeInner()</code></td><td>标尺内部的刻度线长短</td><td>6</td><td>和上面tickSize不能同时设置，会优先展示</td></tr><tr><td><code>tickSizeOuter()</code></td><td>标尺外部的刻度线长短</td><td>6</td><td>和上面tickSize不能同时设置，会优先展示</td></tr><tr><td><code>tickPadding()</code></td><td>标号到刻度的距离</td><td>3</td><td>/</td></tr><tr><td><code>tickFormat()</code></td><td>刻度数据的格式化</td><td>null</td><td>见下面刻度格式化部分</td></tr></tbody></table><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#676E95;">// 设置坐标轴范围</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> xScale </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> d3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">scaleLinear</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">domain</span><span style="color:#A6ACCD;">([</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">10</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10</span><span style="color:#A6ACCD;">])</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">range</span><span style="color:#A6ACCD;">([</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">500</span><span style="color:#A6ACCD;">])</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> yScale </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> d3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">scaleLinear</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">domain</span><span style="color:#A6ACCD;">([</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">10</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10</span><span style="color:#A6ACCD;">])</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">range</span><span style="color:#A6ACCD;">([</span><span style="color:#F78C6C;">200</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">])</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// 在画布左上角放置坐标轴</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> gX </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> svg</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">append</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">g</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">transform</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">translate(50,50)</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">call</span><span style="color:#A6ACCD;">(d3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">axisBottom</span><span style="color:#A6ACCD;">(xScale)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tickSize</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">10</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tickPadding</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">10</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tickFormat</span><span style="color:#A6ACCD;">(d3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">format</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.1f</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)))</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> gY </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> svg</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">append</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">g</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">transform</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">translate(50,50)</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">call</span><span style="color:#A6ACCD;">(d3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">axisLeft</span><span style="color:#A6ACCD;">(yScale)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ticks</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">5</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tickSizeInner</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">12</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tickSizeOuter</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">4</span><span style="color:#A6ACCD;">))</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><img src="/frontend-blog/assets/image-20230705183114908.007edc31.png" alt="image-20230705183114908" style="zoom:67%;"><p><strong>刻度格式化</strong></p><blockquote><p>可以给D3提供的<a href="#D3%E6%A0%BC%E5%BC%8F%E7%AC%A6">格式化函数</a>来作为参数，也可以自己编写传入坐标数值并返回处理后的数值的函数。</p><p>有一个经验是通过一定的规则来返回正常数值还是<code>null</code>。返回<code>null</code>或者<code>&#39;&#39;</code>则不会渲染。</p></blockquote><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> xAxis1 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">axisBottom</span><span style="color:#A6ACCD;">(xScale)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ticks</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">50</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tickSize</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tickFormat</span><span style="color:#A6ACCD;">( </span><span style="color:#A6ACCD;">d</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">null</span><span style="color:#A6ACCD;"> ) </span><span style="color:#676E95;">// * 不渲染坐标数值, 效果等同于.tickFormat(‘’), 但能通过类型识别</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> xAxis2 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">axisBottom</span><span style="color:#A6ACCD;">(xScale)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ticks</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">50</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tickSize</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">6</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tickFormat</span><span style="color:#A6ACCD;">( </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">d</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">i</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;">i</span><span style="color:#89DDFF;">%</span><span style="color:#F78C6C;">10</span><span style="color:#89DDFF;">===</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">?</span><span style="color:#A6ACCD;">d</span><span style="color:#89DDFF;">:null</span><span style="color:#A6ACCD;"> ) </span><span style="color:#676E95;">// * 每隔10个刻度线才显示一次坐标数值</span></span>
<span class="line"></span></code></pre></div><h3 id="外观属性" tabindex="-1">外观属性 <a class="header-anchor" href="#外观属性" aria-hidden="true">#</a></h3><blockquote><p>通过call函数传进去的g正是坐标轴对象本身。</p><p>通过对坐标轴的svg部件的解析，可以分析出下面的内容：</p><ol><li><p>整个<code>g</code>便是坐标轴实例，已有可调属性包括<code>fill</code>,<code>font-size</code>,<code>font-family</code>,<code>text-anchor</code>,</p></li><li><p>有专门绘制主轴的<code>path.domain</code>，已有可调属性包括<code>stroke</code></p></li><li><p>有刻度线对象<code>g.tick</code>，内含刻度线<code>line</code>和刻度标记<code>text</code>，已有可调属性包括<code>opacity</code></p><p>刻度线<code>line</code>已有可调属性包括<code>stroke</code>、<code>y2</code>控制刻度线长度，</p><p>刻度标记<code>text</code>已有可调属性包括<code>fill</code>，<code>y</code>控制标记的位置。</p></li></ol></blockquote><p><img src="/frontend-blog/assets/image-20230724183137029.e8d77b80.png" alt="image-20230724183137029"></p><p><strong>坐标轴位置</strong></p><blockquote><p>默认在原点（0，0）渲染，通过在<code>.attr(&quot;transform&quot;,translate(x坐标,y坐标))</code>设置渲染位置。</p><p>一般图表渲染可参照下图的数据（查看<a href="https://observablehq.com/@d3/margin-convention?collection=@d3/d3-axis" target="_blank" rel="noreferrer">Margin Convention / D3 | Observable (observablehq.com)</a>）。</p></blockquote><img src="/frontend-blog/assets/image-20230724081330108.89a0d3b5.png" alt="image-20230724081330108" style="zoom:50%;"><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#676E95;">// 设置坐标轴范围</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> xAxis </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> d3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">scaleLinear</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">domain</span><span style="color:#A6ACCD;">([</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">50</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">50</span><span style="color:#A6ACCD;">])</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">range</span><span style="color:#A6ACCD;">([marginLeft</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> width </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> marginRight])</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// 创建坐标轴</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> gx </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> svg</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">append</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">g</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">transform</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">`</span><span style="color:#C3E88D;">translate(0,</span><span style="color:#89DDFF;">${</span><span style="color:#A6ACCD;">marginTop </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">50</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">)</span><span style="color:#89DDFF;">`</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">call</span><span style="color:#A6ACCD;">(d3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">axisTop</span><span style="color:#A6ACCD;">(xAxis))</span></span>
<span class="line"></span></code></pre></div><p><strong>取消显示主轴线</strong></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA6IAAAA7CAIAAADuG6DGAAAG4ElEQVR4nO3cP0/bWhjH8efcF8AbYIkjIfDOGwAEg1EydGUkgNTb28UJM3PBy72wGGdl7NAID0SJeAPMroiUk4k3wAvwHQix86+tVMdOTr+fidrpkeWT4+dn++SoOI4FAAAAMMtfRR8AAAAAkD1iLgAAAAxEzAUAAICBiLkAAAAwEDEXAAAABiLmAgAAwEDEXAAAABiImAsAAAADEXMBAABgIGIuAAAADETMBQAAgIGIuQAAADAQMRcAAAAGIuYCAADAQMRcAAAAGIiYCwAAAAMRcwEAAGAgYi4AAAAMRMwFAACAgYi5AAAAMBAxFwAAAAb6rZj7/PyslLq7u8vqaEREKXVxcZFhg5ubm0dHRxk2WK1Wt7e3M2ywXq+vra1l2KDv+0qpl5eXrBp8fHxUSj0+PmbV4MvLi1LK9/2sGhSRtbW1er2eYYPb29vVajXDBo+OjjY3NzNs8OLiQimVYYN3d3dKqefn56wafHp6Ukq1Wq2sGnx9fVVKeZ6XVYMisr6+fnZ2lmGDOzs7Ozs7GTZ4dna2vr6eYYOe5ymlXl9fs2qw1WoppZ6enrJqkOKSCYpLJiguv6/A4sLTXAAAABiImAsAAAADEXMBAABgIGIuAAAADETMBQAAgIGIuQAAADAQMRcAAAAGIuYCAADAQCqO46KPAQAAAMgYT3MBAABgIGIuAAAADETMBQAAgIGWIubq20N13p2xceiwOSjkuP5Ug+bo1E+dfN2svu+pNnVRR/hnSvXL4e3Eue/WRz02NZSQj+751HhpJ91Sbxd2YH+isYvYZL9QXIrVPVezxgXFpRCp2pEeMEmJWfniUnTMHTQPlSqfhhOb9e1h+dTuxHEcx31fahYXo9zo5uevH3Qczzj5ulkt17aG3RJIrczFKD/d+me5fusVHchpefwytBf5/TiO47jjXu6t6MVotQ2a3uX4lnZdHUTB21B6cL0Dkm6OelEobiceuT8uDfdQXAqlm1W1J0nPXO2PtlNcCrF7FY97cEVc98QSEUOKS1ycvu9IJejH/aAi0khdkeKOK+I+JB8MKuIMTzRy1nHl/eQ/uJKuHDpwxAn03P+Jxek0kiHzPo7eTXQT8tAPKuI03NSImLxqpbsMCzd3FFBcijR5sRqhuCyLsRFhRnEp8mmudXIffzu2pne0Q08ceyP5oLUlYavLvV2xum1PKnbSXyXLlvBrm27Jn9bfk7+7rVC2rKRfNmxHvJAHhznqnpdrElx/tJNNg+7XltilpFusDUcuwxV8ErKS9CCavYPiUqTuzWno/jOj6FNcloS+/VST4Hr4KNeQ4lL0pIVZ9CASsa1SssXacKQV8ZUvQDv0xPmwbw2jVfobL5ZdkbBHt+SufVNrOcHHXRER0VFLnI1Ut5QsWyQa0C95adf3Lt3OxB17LwrH4pRYJVsk0rwfz4+3NzUBl+JSpIGOxLElNW16+Aac4rIkJu5DDCkuyxhzsSzadXXgScM9Lv38s1i40e+Z/rP7qbmGKNKgeXjguQ9Xu0UfCNKsk/vRK8tOI6xZTIxeAr0olLB2ELlvHaMD53Jv6te0KIy+9bxK8Pd+0ceRtdWJuek3Glg43awqdeA5fj/+8qMKPnarh4Xaf/+pwL/y6Wc/ek2/LsfCdOtWTfz+1a8WhrHniMjH7pd+UBGvPX+8UFxylNwTlo6vfSc8vZnXMRSXfHVvTkOnsvvTk75yxWUZY+702z3dm1yKAYvUratyreUEOr4/GX2hLWtL5LtO3XrrqFXE0aF0fP/gyqXXHMiMt3sDPWdaIjKmbz1PJDwtD5+yW7VQwpqlVLWpN2xHwqiX+vC82aJYOMvaev+L4lKgDdsZn8nzjuKyBJIJiiOGFJdljLkyWSG0/i6/cpOBLOhmdc+rBNOvxScnsQ10NDkqkKe3R4NTFaIXheI6xr14WkLpN+PDl7BvPw//dmxNTWLTvVAaDnMbipD6ySbFpUAlyx6/9xMZPkqnuBSu2/ak8mF3rOibUlxyWtHhR6YXFIs7DRmtW9H3nVVcw2JV/Wgll44ro56a0WtYnL7vpJY9SnfEW5eNloBJLQCHnI2Pnb7vyOifD66wQFKOOo3kbHcakj75FJcCjZ1wHTjJ4m4Ul2LNKRxGFJcljbnx8GL0hstQjh7cGTdDycp5nWQ3l6F8pUbE1LVGB868XcjN1C1i30+6hYybr35QmVtBKC4FSg2K9ALGMcWlSGO3HDN2rXRxUXEc/+JzXwAAAGBVLOXcXAAAAOD3EHMBAABgIGIuAAAADETMBQAAgIGIuQAAADAQMRcAAAAGIuYCAADAQMRcAAAAGIiYCwAAAAMRcwEAAGAgYi4AAAAMRMwFAACAgf4HgdnwopWHWpIAAAAASUVORK5CYII=" alt="image-20230724143826710"></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#A6ACCD;">xAxisInt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">call</span><span style="color:#A6ACCD;">(xAxis)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">call</span><span style="color:#A6ACCD;">(</span><span style="color:#A6ACCD;">g</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> g</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">select</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">.domain</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">remove</span><span style="color:#A6ACCD;">()) </span><span style="color:#676E95;">// * 关键代码</span></span>
<span class="line"></span></code></pre></div><p><strong>副刻度</strong></p><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABXIAAABLCAIAAABSnegNAAALAUlEQVR4nO3dv28Ta7oH8NerbZGo2SZGApGafyA/RApHTnFKmi2Sk2Lv7mmc0JLTnsRCupdTEJyS9hTh4iJRnJEokFiQkCh8ICJjCYFEgYRAQkJXaG4RJ3acH8Bk4jHs51MldvLI8qtnvpMnr2cKSZIEAAAAgG/3l7xfAAAAAPC9MlYAAAAAUjJWAAAAAFIyVgAAAABSMlYAAAAAUjJWAAAAAFIyVgAAAABSMlYAAAAAUjJWAAAAAFIyVgAAAABSMlYAAAAAUjJWAAAAAFIyVgAAAABSMlYAAAAAUjJWAAAAAFIyVgAAAABSMlYAAAAAUjJWAAAAAFIyVgAAAABSMlYAAAAAUjJWAAAAAFIyVgAAAABSMlYAAAAAUjJWAAAAAFL660l+eXR0NKvXAQAAAAyC69evj4yMfOUPn2i3wpMnT548eXKSCj2eP3/+4MGDDAu+fPkyiqLPnz9nVfDt27dRFH348CGrgh8/foyi6M2bN1kVDCFEUdRqtTIs+PDhw2azmWHBp0+fPn78OMOCL168uH//foYFX79+HUXRp0+fsir47t27KIrevXuXVcFPnz5FUfT69eusCoYQ7t+//+LFiwwLPn78+OnTpxkWbDabDx8+zLBgq9WKoijDgm/evImi6OPHj1kV/PDhQxRFb9++zarg58+foyh6+fJlVgVDCA8ePHj+/HmGBYXLyQmXTAiXTAiXkxMumRAuJydcMvG9hMu39UtyAmfPnj179uxJKvSYnZ09d+5chgWXlpZCCO/fv8+q4Orqagjh0aNHWRV89uxZCOHOnTtZFUySJISwsLCQYcGLFy9evXo1w4Llcvny5csZFqxUKmfOnMmw4K1bt0IIr169yqrg5uZmCGFzczOrgq9evQoh3Lp1K6uCSZKcOXOmUqlkWPDy5cvlcjnDglevXr148WKGBRcWFk54GOxx586dEMKzZ8+yKvjo0aMQwurqalYF379/H0JYWlrKqmCSJOfOnZudnc2w4MjIyMjISIYFhUsmhMvJCZdMCJeTEy6ZEC6ZEC4nl3m43LhxI4Rw48aNr/8V11b4MSVJkvdLgO+AToFvomXga+gU+CZa5gdgrAAAAACkZKwAAAAApGSs8GMqFAp5vwT4DugU+CZaBr6GToFvomV+AMYKAAAAQErGCgAAAEBKxgo/JtdTBSBzwgWAzAmXH0DhJKs4OjoaQti5ZzKDo1AoXL9+feeeyQyIKIpGR0c3NzdHRkbyfi10LCws/Prrr8Js0AiXwSRcBpBwGUzCZTAJl8EkXAZQinCxWwEAAABIyVgBAAAASMlYAQAAAEjJWAEAAABIyVgBAAAASMlYAQAAAEjJWAEAAABIyVgBAAAASCn1WCFemSpEURRFUWFqJc7yJZFGfHuycK2x83WSJAsLC+0H2yZXWrm+vv80rZW9t37nzR8ZGUmSZGRkZKd32vROn3Wty+TtOISwsLCQJEkIIYTG3N6K7bYSfda41u6Xzc3Nzc3NEEJY7yzL3Hrer+8/yr6DWHtdhMuAaFzrLMz//p9wyVdXdnT599/+LlwGQNebP7USB+EyEA4miHDJU2tlsjDXe2xanxsdHQ0hjI6O9jbI+txRldKNFeKVqfMzlzaSJEmS7VqYOS/ActRamSwUzs/Wex6Ob0+enx1uL9JymCnqz76JV37546c4SQ558/VOjhpzv4SbO6sS18Ls+Z3JQvupwnhzeTtJkiTZqCyOO/nLQWulurj/kfW5wkSzttNKa5XqhJO/Ptpq1kNlI9lzb3qo/YxwyVW8MlUYD52VWbqy97hwycXYUrLfWiWESuXnYghBuOSptTJZGK/OH9YUwiU/jWuFvQRJ1oa7E0S49F28MlUoFGd6/4Y8pkHW5woTzSPrJSmsVUL32UZcK4VSLT7mFzgt28ulUK5tJ9u1cgjzXWeAyUYlhMpa5wdr5VBqBxt9tlEJu2++3hkYG/Odltnto109y0Q/bNfKoTRf6eqI3qNW95Jx6o7sAuGSp96D1R7hMij2dYRwyVPPu71WCe2mEC75iWulfQnS/eYLl/7ajYnt5dL+49IxDfKFRUmzW6GxXg3l4eLe90PF4VD/Y91YPAfFn+8lq9PFg0+s16uhNHyh84PFS6F+t2GR8qV3BkYc/9n5unG3Hi4VO+tyYbgUqnX/u+ijxrXzM6F28x/DnYdajT/uhuGhzrIUL5TCYt1/+vojbh3x7wjhkqfG77P1yr8OCX3hMiDi2/+cCbWb7a0KwmXQDBeHhEvuuhMkFC+Uwp9xHIRL3w1N3+vah9hxTIMceKpHirFCHP8Z9h0lQ3G4HOpb1n2AxK1m++i5q3ihFO42LVIO1uvVUPrpSlHvDJD132fulmr/GAshhBA374bSha5lGSoOh9BsWZd+WZ8bX6xs9ExIt5r1npOPoeEQmrEtkf1THT/wGVfhkqdW3Ayl4dB12Yv2jnrhMiB65j7CJVdXlraXm+PtHmnMTVQra0tjQbjkrt7c6nwTb9V3EkS4DIpjGuTAUz3cCQJO0/pcYaIa5iuHjAPpv71LNP3P8PahM1r6r7UyuXe2x8Ao/nyvawNkfabos8cDYKtZD/WZiWZlbwvr4njXNWLIWXy7Wi3X/utK3q+DXfFWPSzuTEfHq3m/GEIIYWjsp3KoTuxeIPDgNZX4nmU2Vtg3jmUwde+Q5NTFK1OFwkS1tLyd/HbcX0x6p3+u7F5a67/DP790Ue5jdnmRncZccSYsby997Yn4vn9l0B9jv23XyqG6fnS/CJc+6szghqZvLpfqs78ftTDCpb8av8/WS+WxL77pwqU/4tuT44udK4xszIfqxDGXABQu/VGcXt2ulXe3wv0SKsul4xJEuAyKr2qQFGOFYvFSaH8Mpi1u3v32Mpymgxu64q3ey3xymhpzhfMzd0u1OLn3894hUe8MjKHpe2uVsFhdaYVDdgu34qOvckuW4tvVagj12fPtXSTFmXqozxQLhamV+MJwqWer5FGf9ufUFYuXdr8SLjm6MFw6fAOqcBkAnQ887hEuOYobd+ul5Zt72xLHftuo7FxwRLjkrDi9ursXbnU6bLWvPyJcBsUxDXLgqR5pdiv0ftalFTd7j6TkrXfh4/jP8DVDdLIQr0yNV8u1g9vs9c6A2Rm+Hjgj32rWQ6VkI+vp695p331d4mR1unjgQ8jxVj3Ml3xWIg9dlzgVLjkaKg4fPKUrDxeFywBorFdD+aexfaEvXAaScBkgjfpiqFwZC0G4DIxjGuSLV4dJc0eKZKMS9t1qwn1Z8nbIKmzMh737hRy4dwin6bg7e+md3Gwvl7puitO9EO07HpX2bi0e3NMoJ/t7Z3u5FPa+7dwbjH7YmN+3ebj7zRcuOdr3hu+7VZtwydcRwSFc8rMvQQ45cAmXfGzM70VG75FKuOTi4Ft9TIPsPHVUqXRjhaQdYDtEV/4OP4fYmN9bJJ3ZR2uVcFDnztV6JzddHXHg3C6ulY56ir45MJLbXu4si9O+/tqulY9MEOGSo66m2Hf7d+GSp30jnkOeEi756D4f65yGJYlwyVPnSHWwI4RL/x06wTmmQbaXjxwrFJIkOeRPIAAAAIAvcYNJAAAAICVjBQAAACAlYwUAAAAgJWMFAAAAICVjBQAAACAlYwUAAAAgJWMFAAAAICVjBQAAACAlYwUAAAAgJWMFAAAAICVjBQAAACAlYwUAAAAgJWMFAAAAICVjBQAAACAlYwUAAAAgJWMFAAAAICVjBQAAACAlYwUAAAAgJWMFAAAAIKX/Bw2nU0uPflPnAAAAAElFTkSuQmCC" alt="image-20230724153847772"></p><blockquote><p>方法1：在同一个位置再做一个刻度分度更细的坐标轴。可以在基础上<em>只保留副刻度坐标轴的刻度</em></p></blockquote><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#676E95;">// 坐标轴</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> xAxis </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> d3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">axisBottom</span><span style="color:#A6ACCD;">(xScale)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ticks</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">10</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#676E95;">// 添加小刻度</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> xMinorAxis </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> d3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">axisBottom</span><span style="color:#A6ACCD;">(xScale) </span><span style="color:#676E95;">// * 用同一个标尺</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ticks</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">50</span><span style="color:#A6ACCD;">) </span><span style="color:#676E95;">// * 与主尺度呈5倍关系</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tickSize</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;">) </span><span style="color:#676E95;">// * 比主刻度小一点</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tickFormat</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;&quot;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">// * 取消显示值</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// 添加x轴</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> xAxisInt </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> svg</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">append</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">g</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">transform</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">translate(50, 350)</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">call</span><span style="color:#A6ACCD;">(xAxis)</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> xMinorAxisInt </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> svg</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">append</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">g</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">transform</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">translate(50, 350)</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">) </span><span style="color:#676E95;">// * 与主坐标轴在同一位置</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">call</span><span style="color:#A6ACCD;">(xMinorAxis)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><blockquote><p>方法2：只用一个坐标轴，活用刻度渲染格式函数<code>.tickFormat()</code>以及坐标轴批量编辑的方法来完成此复杂方法</p><p>注意：若是竖着的坐标轴，需要把下面的属性字段里面的<code>y</code>改为<code>x</code>，（怎么改？）并修改符号。</p></blockquote><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> xAxis </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">axisBottom</span><span style="color:#A6ACCD;">(xScale)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ticks</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">50</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tickSize</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">6</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tickFormat</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">d</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">i</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;">i</span><span style="color:#89DDFF;">%</span><span style="color:#F78C6C;">5</span><span style="color:#89DDFF;">===</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">?</span><span style="color:#A6ACCD;">d</span><span style="color:#89DDFF;">:null</span><span style="color:#A6ACCD;">) </span><span style="color:#676E95;">// * 主刻度的轴</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">xAxisInt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">call</span><span style="color:#A6ACCD;">(xAxis)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">call</span><span style="color:#A6ACCD;">(</span><span style="color:#A6ACCD;">g</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> g</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">selectAll</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">g.tick line</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">y2</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">_</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">i</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> i </span><span style="color:#89DDFF;">%</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">5</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">===</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">?</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">12</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">6</span><span style="color:#A6ACCD;">) </span><span style="color:#676E95;">// 根据刻度的编号修改每个刻度线的长度</span></span>
<span class="line"><span style="color:#A6ACCD;">    )</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">call</span><span style="color:#A6ACCD;">(</span><span style="color:#A6ACCD;">g</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> g</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">selectAll</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">g.tick text</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">y</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">12</span><span style="color:#A6ACCD;">)) </span><span style="color:#676E95;">// 统一修改每个文本的渲染位置（只考虑纵坐标）</span></span>
<span class="line"></span></code></pre></div><p><strong>绘制网格</strong></p><blockquote><p>你可以将网格线画在刻度线里面，也可以在做一个坐标轴再改造成网格线。</p></blockquote><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> yNetGrid </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">axisLeft</span><span style="color:#A6ACCD;">(yScale)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ticks</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">50</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tickSize</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">(width</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">left</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">right)) </span><span style="color:#676E95;">// 宽度/高度要与图标网格的宽度/高度相同，有必要的话需要加负号</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tickFormat</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;&#39;</span><span style="color:#A6ACCD;">) </span><span style="color:#676E95;">// * 网格</span></span>
<span class="line"></span></code></pre></div><img src="/frontend-blog/assets/image-20230725135758998.bce54ad0.png" alt="image-20230725135758998" style="zoom:67%;"><p><strong>其他个数的刻度</strong></p><blockquote><p>你可以将网格线画在刻度线里面，也可以在做一个坐标轴再改造成网格线。</p></blockquote><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> yNetGrid </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">axisLeft</span><span style="color:#A6ACCD;">(yScale)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ticks</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">50</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tickSize</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">(width</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">left</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">right)) </span><span style="color:#676E95;">// 宽度/高度要与图标网格的宽度/高度相同，有必要的话需要加负号</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tickFormat</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;&#39;</span><span style="color:#A6ACCD;">) </span><span style="color:#676E95;">// * 网格</span></span>
<span class="line"></span></code></pre></div><img src="/frontend-blog/assets/image-20230725135758998.bce54ad0.png" alt="image-20230725135758998" style="zoom:67%;"><p><strong>D3格式符</strong></p><blockquote><p>D3中的数字格式化与坐标轴的格式化：d3.format(specifier),specifier遵循下述规则 <code>[[fill]align][sign][symbol][o][width][,][.precision][-]type]</code></p><p>典型的formater,<code>.</code>后的数字表示精度：</p><ul><li><code>d3.format(.2f)(666.666)</code>：小数点后保留两位，666.67</li><li><code>d3.format(&#39;.2r&#39;)(2467)</code>：只保留两位有效数字2500</li><li><code>d3.format(&#39;.3s&#39;)(2366.666)</code>：只保留三位有效数字且加以后缀2.37k</li><li><code>d3.tickFormat(d3.format())</code>：根据formater来设置坐标轴上的数字格式</li><li>时间的格式化：<code>d3.timeFormat(…)</code>如<code>d3.timeFormat((&#39;%b-%d&#39;)</code></li></ul></blockquote><h2 id="d3形状和曲线" tabindex="-1">D3形状和曲线 <a class="header-anchor" href="#d3形状和曲线" aria-hidden="true">#</a></h2><p>D3.js有一组用于生成SVG形状指令的辅助类函数，包括线性路径数据生成器，以使创建形状更容易。</p><h3 id="路径生成器line" tabindex="-1">路径生成器line <a class="header-anchor" href="#路径生成器line" aria-hidden="true">#</a></h3><blockquote><p>给定一些点的数据，<code>d3.line()</code>可以通过这些点来绘制出连接这些点的路径的数据。其相关配置项可见下表：</p></blockquote><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> valueLineGen </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> d3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">line</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">x</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">([</span><span style="color:#A6ACCD;">x</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">_</span><span style="color:#89DDFF;">])</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">xScale</span><span style="color:#A6ACCD;">(x))</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">y</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">([</span><span style="color:#A6ACCD;">_</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">y</span><span style="color:#89DDFF;">])</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">yScale</span><span style="color:#A6ACCD;">(y))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">mainDisplay</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">select</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">path.graph-line</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">d</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">valueLineGen</span><span style="color:#A6ACCD;">(rawData))</span></span>
<span class="line"></span></code></pre></div><table><thead><tr><th>选项</th><th>配置释义</th></tr></thead><tbody><tr><td>x</td><td>规定点的横坐标数据怎么转换</td></tr><tr><td>y</td><td>规定点的纵坐标数据怎么转换</td></tr><tr><td>curve</td><td>连接的曲线的类型</td></tr><tr><td>defined</td><td>当数据中存在异常(缺失字段问题) 可以通过defined表示已定义跳过<br>传入一个函数，true如果数据定义明确，则返回该函数。如果函数返回false，线生成器将跳过它</td></tr></tbody></table><blockquote><p><code>d3.line()</code>的曲线类型有很多，可以实现包括平滑曲线、折线等等类型的线。</p><p>全部类型的曲线参照：<a href="https://www.d3indepth.com/examples-merged/shapes/curve-explorer/" target="_blank" rel="noreferrer">D3 Curve Explorer (d3indepth.com)</a></p><p>需要实现像<em>函数</em>般的曲线需要考虑函数曲线的<em>单调性</em>（curveMonotoneX，curveMonotoneY）。</p></blockquote><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> valueLineGen </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> d3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">line</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">defined</span><span style="color:#A6ACCD;">(</span><span style="color:#A6ACCD;">d</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> d </span><span style="color:#89DDFF;">!==</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">null</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">curve</span><span style="color:#A6ACCD;">(d3</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">curveCardinal)</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">x</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">([</span><span style="color:#A6ACCD;">x</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">_</span><span style="color:#89DDFF;">])</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">xScale</span><span style="color:#A6ACCD;">(x))</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">y</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">([</span><span style="color:#A6ACCD;">_</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">y</span><span style="color:#89DDFF;">])</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">yScale</span><span style="color:#A6ACCD;">(y))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">mainDisplay</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">select</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">path.graph-line</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">d</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">valueLineGen</span><span style="color:#A6ACCD;">(rawData))</span></span>
<span class="line"></span></code></pre></div><img src="/frontend-blog/assets/image-20230905105234953.5bb7eb60.png" alt="image-20230905105234953" style="zoom:50%;"><h3 id="符号symbol" tabindex="-1">符号symbol <a class="header-anchor" href="#符号symbol" aria-hidden="true">#</a></h3><blockquote><p>适合用来生成曲线图上面的点，该功能给指定的点位置上生成相应的点。用于散点图，曲线图等等图当中。</p><p>符号始终以⟨0,0⟩为中心；使用变换属性<code>transform</code>将符号移动到不同的位置。</p></blockquote><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> symbolGenerator </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> d3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">symbol</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">type</span><span style="color:#A6ACCD;">(d3</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">symbolCircle) </span><span style="color:#676E95;">// 指定符号类型</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">size</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">80</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">// 指定大小，默认64</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">mainDisplay</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">select</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">g.graph-symbol</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">selectAll</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">path</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">data</span><span style="color:#A6ACCD;">(pathData) </span><span style="color:#676E95;">// 按照输入的点的数据</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">join</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">path</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">transform</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">([</span><span style="color:#A6ACCD;">x</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">y</span><span style="color:#89DDFF;">])</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">`</span><span style="color:#C3E88D;">translate(</span><span style="color:#89DDFF;">${</span><span style="color:#A6ACCD;">[</span><span style="color:#82AAFF;">xScale</span><span style="color:#A6ACCD;">(x)</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">yScale</span><span style="color:#A6ACCD;">(y)]</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">)</span><span style="color:#89DDFF;">`</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">d</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">symbolGenerator</span><span style="color:#A6ACCD;">())</span></span>
<span class="line"></span></code></pre></div><p><strong>自定义symbol</strong>：多参照源码</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> symbolInvertedTriangle </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">draw</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">context</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">size</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">y</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">Math</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">sqrt</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">size</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">/</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">Math</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">sqrt</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">3</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">*</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">3</span><span style="color:#F07178;">))</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">moveTo</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">y</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">*</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">2</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">lineTo</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">Math</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">sqrt</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">3</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">*</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">y</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">y</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">lineTo</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">Math</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">sqrt</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">3</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">*</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">y</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">y</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">closePath</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span></code></pre></div><h2 id="交互行为" tabindex="-1">交互行为 <a class="header-anchor" href="#交互行为" aria-hidden="true">#</a></h2><h3 id="zoom缩放和平移" tabindex="-1">zoom缩放和平移 <a class="header-anchor" href="#zoom缩放和平移" aria-hidden="true">#</a></h3><blockquote><p>使用<code>d3.zoom()</code>创建svg缩放行为，然后需要施加在能够缩放的部分上，<em>不能直接应用于整个svg</em>！</p><p>d3的zoom功能支持缩放方法有滚轮、双击、触碰事件，拖动功能支持鼠标事件</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#A6ACCD;">d3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">on</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;&quot;</span><span style="color:#89DDFF;">,null</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div></blockquote><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> PanWindow </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> svg</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">append</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">g</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">) </span><span style="color:#676E95;">// * 用来缩放的视口</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">/******** 缩放主要代码 ********/</span></span>
<span class="line"><span style="color:#A6ACCD;">svg</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">call</span><span style="color:#A6ACCD;">(d3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">zoom</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">on</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">zoom</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#676E95;">// * 创建用来缩放的实例</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">svg</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">select</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">g</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">transform</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">transform</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span><span style="color:#F07178;"> </span><span style="color:#676E95;">// * 对用来缩放的窗口进行缩放</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">))</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><blockquote><p>通过<code>scaleExtent()</code>来调控放大倍数。通过<code>translateExtent()</code>来调控移动平移范围。</p></blockquote><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> zoom </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> d3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">zoom</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">scaleExtent</span><span style="color:#A6ACCD;">([</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;">]) </span><span style="color:#676E95;">// 最小一倍，最大三倍</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">translateExtent</span><span style="color:#A6ACCD;">([[</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> [</span><span style="color:#F78C6C;">800</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">600</span><span style="color:#A6ACCD;">]]) </span><span style="color:#676E95;">// 限制在800*600的范围内拖动</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">on</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">zoom</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#676E95;">// * 创建用来缩放的实例</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">svg</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">select</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">g</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">transform</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">e</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">transform</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span><span style="color:#F07178;"> </span><span style="color:#676E95;">// * 对用来缩放的窗口进行缩放</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p><strong>重置坐标轴</strong></p><blockquote><p>在zoom当中变换过程中，坐标轴需要按照zoom的变化来的话需要通过<code>transform.rescaleX()</code>、<code>transform.rescaleY()</code>进行重置坐标轴缩放的操作：</p></blockquote><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> zoom </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> d3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">zoom</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">on</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">zoom</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">({</span><span style="color:#A6ACCD;">transform</span><span style="color:#89DDFF;">})</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#676E95;">// * 创建用来缩放的实例</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">svg</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">select</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">g.zoom-container</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">transform</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">transform</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span><span style="color:#F07178;"> </span><span style="color:#676E95;">// * 对用来缩放的窗口进行缩放</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#676E95;">/** 重置坐标轴缩放 */</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">xAxis</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">scale</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">transform</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">rescaleX</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">xScale</span><span style="color:#F07178;">))</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">yAxis</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">scale</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">transform</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">rescaleY</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">yScale</span><span style="color:#F07178;">))</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#82AAFF;">renderCoordinateSystem</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">xAxis</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">yAxis</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">svg</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">call</span><span style="color:#A6ACCD;">(zoom)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><blockquote><p>在zoom响应函数之外，当坐标轴需要重置时，需要通过<code>d3.zoomTransform(node)</code>函数获取当前元素的缩放状态。</p><p><code>d3.zoomTransform(node)</code>需要传进DOM元素。</p><p><code>d3.zoomTransform(node)</code>会先在该元素寻找<code>_zoom</code>属性，再在其父节点来找。找不到则返回<code>zoomIdentity</code></p></blockquote><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#676E95;">/** 需要下列代码以此实时追踪坐标轴更新 */</span></span>
<span class="line"><span style="color:#82AAFF;">watchEffect</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#676E95;">/** 更改比例尺 */</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">xScale</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">range</span><span style="color:#F07178;">([</span><span style="color:#A6ACCD;">MarginLeft</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">value</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">layoutWidth</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">value</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">MarginRight</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">value</span><span style="color:#F07178;">])</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">yScale</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">range</span><span style="color:#F07178;">([</span><span style="color:#A6ACCD;">layoutHeight</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">value</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">MarginTop</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">value</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">MarginBottom</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">value</span><span style="color:#F07178;">])</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#676E95;">/** 应用经过缩放处理的比例尺 */</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">currentZoom</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">d3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">zoomTransform</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">svg</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">node</span><span style="color:#F07178;">())</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">xAxis</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">scale</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">currentZoom</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">rescaleX</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">xScale</span><span style="color:#F07178;">))</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">yAxis</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">scale</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">currentZoom</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">rescaleY</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">yScale</span><span style="color:#F07178;">))</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#676E95;">/** 渲染一次坐标系 */</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">renderCoordinateSystem</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">xAxis</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">yAxis</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">renderGraphLines</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">xScale</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">yScale</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><h3 id="drag拖动" tabindex="-1">drag拖动 <a class="header-anchor" href="#drag拖动" aria-hidden="true">#</a></h3><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#676E95;">// 使用方法如下</span></span>
<span class="line"><span style="color:#A6ACCD;">dragItem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">call</span><span style="color:#A6ACCD;">(d3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">drag</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">on</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">drag</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">dragItem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">transform</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">`</span><span style="color:#C3E88D;">translate(</span><span style="color:#89DDFF;">${</span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">x</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">,</span><span style="color:#89DDFF;">${</span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">y</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">)</span><span style="color:#89DDFF;">`</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">))</span></span>
<span class="line"></span></code></pre></div><blockquote><p>在此做了个拖动的一个小封装，能够保证<em>鼠标拖动物件移动</em>的功能自然。</p></blockquote><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#676E95;">// 对于单个形状</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> greatDragCircle </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> d3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">drag</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">on</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">start</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">subject</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">fx</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">x</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">dragCircle2</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">cx</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">subject</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">fy</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">y</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">dragCircle2</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">cy</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">on</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">drag</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">d</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">dragCircle2</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">cx</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">x</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">subject</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">fx</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">dragCircle2</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">cy</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">y</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">subject</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">fy</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">dragCircle2</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">call</span><span style="color:#A6ACCD;">(greatDragCircle)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// 对于一个svg组</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> greatDragGroup </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> d3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">drag</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">subject</span><span style="color:#A6ACCD;">(targetElem)</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">on</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">start</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">offsetX</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">offsetY</span><span style="color:#89DDFF;">]</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">targetElem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">transform</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">match</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">/</span><span style="color:#C3E88D;">translate</span><span style="color:#A6ACCD;">\(</span><span style="color:#89DDFF;">([^</span><span style="color:#C3E88D;">,</span><span style="color:#89DDFF;">]*)</span><span style="color:#C3E88D;">,</span><span style="color:#89DDFF;">([^</span><span style="color:#C3E88D;">)</span><span style="color:#89DDFF;">]*)</span><span style="color:#A6ACCD;">\)</span><span style="color:#89DDFF;">/</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">slice</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">1</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">map</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">parseFloat</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">subject</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">fx</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">x</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">offsetX</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">subject</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">fy</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">y</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">offsetY</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">on</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">drag</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">d</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">offsetX</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">x</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">subject</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">fx</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">offsetY</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">y</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">subject</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">fy</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">targetElem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">transform</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">`</span><span style="color:#C3E88D;">translate(</span><span style="color:#89DDFF;">${</span><span style="color:#A6ACCD;">offsetX</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">,</span><span style="color:#89DDFF;">${</span><span style="color:#A6ACCD;">offsetY</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">)</span><span style="color:#89DDFF;">`</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">targetElem</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">call</span><span style="color:#A6ACCD;">(greatDragGroup)</span></span>
<span class="line"></span></code></pre></div><h3 id="brush拖动选择" tabindex="-1">brush拖动选择 <a class="header-anchor" href="#brush拖动选择" aria-hidden="true">#</a></h3><blockquote><p>d3提供的专门处理二维空间点集选择的工具</p></blockquote><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> brush </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> d3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">brush</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">on</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">start brush end</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> brushed)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">brushed</span><span style="color:#89DDFF;">({</span><span style="color:#A6ACCD;">selection</span><span style="color:#89DDFF;">})</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">value</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> []</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">selection</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">[[</span><span style="color:#A6ACCD;">x0</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">y0</span><span style="color:#89DDFF;">],</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">x1</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">y1</span><span style="color:#89DDFF;">]]</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">selection</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">value</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">dot</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">stroke-width</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#F07178;">) </span><span style="color:#676E95;">// 所有点的样式</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">filter</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">d</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">x0</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">xScale</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">d</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">x</span><span style="color:#F07178;">) </span><span style="color:#676E95;">// 选择在选择区域的所有点</span></span>
<span class="line"><span style="color:#F07178;">                    </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">xScale</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">d</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">x</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">x1</span><span style="color:#F07178;"> </span></span>
<span class="line"><span style="color:#F07178;">                    </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">y0</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">yScale</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">d</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">y</span><span style="color:#F07178;">) </span></span>
<span class="line"><span style="color:#F07178;">                    </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">yScale</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">d</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">y</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">y1</span></span>
<span class="line"><span style="color:#F07178;">               )</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attr</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">stroke-width</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">3</span><span style="color:#F07178;">) </span><span style="color:#676E95;">// 被框选的点的样式</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">data</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">dot</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">style</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">stroke-width</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span><span style="color:#F07178;"> </span><span style="color:#676E95;">// 未框选所有点的样式</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">svg</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">property</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">value</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">value</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">dispatch</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">input</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">mainDisplay</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">call</span><span style="color:#A6ACCD;">(brush)</span></span>
<span class="line"></span></code></pre></div><h2 id="插值器" tabindex="-1">插值器 <a class="header-anchor" href="#插值器" aria-hidden="true">#</a></h2><p>当我们使用D3.js创建可视化图表时，经常需要在不同的数据值之间进行平滑的过渡。这就是插值器（Interpolate）的作用。插值器可以帮助我们根据起始值和目标值之间的差异，生成中间的过渡值。</p><p>换句话说，插值器可以帮助我们在两个不同的数值之间创建平滑的过渡。它会根据你指定的起始值和目标值，生成一个函数，这个函数会在一个时间范围内（通常是从0到1）返回插值的中间值。</p><h3 id="颜色映射" tabindex="-1">颜色映射 <a class="header-anchor" href="#颜色映射" aria-hidden="true">#</a></h3><p>在D3中可以通过以下两种主要方式实现颜色映射:</p><p><strong>连续映射</strong></p><p><code>scaleSequential</code>：用于将连续的输入值映射到连续的输出值。</p><p>可以很容易把一个连续的数值映射到颜色上,自动生成流畅的颜色变化。也可以生成连续变化的位置、大小等视觉编码。</p><p>只要数据是连续的,用<code>scaleSequential</code>映射到视觉通道上,就能很直观表达数据的变化。</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">_color </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> d3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">scaleSequential</span><span style="color:#A6ACCD;">(valueRange</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> d3</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">interpolateRainbow)</span></span>
<span class="line"></span></code></pre></div><p><strong>离散映射</strong></p><p>这是离散的分段颜色 scale,适用于分类数据。</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> colorScale </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> d3</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">scaleOrdinal</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">domain</span><span style="color:#A6ACCD;">([</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">a</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">b</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">c</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">])</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">range</span><span style="color:#A6ACCD;">([</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">red</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">green</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">blue</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">colorScale</span><span style="color:#A6ACCD;">(category)</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">// 返回颜色</span></span>
<span class="line"></span></code></pre></div><p>另外还可以使用<code>scaleThreshold</code>,定义分段的阈值实现分段映射。</p><h2 id="d3导入数据" tabindex="-1">D3导入数据 <a class="header-anchor" href="#d3导入数据" aria-hidden="true">#</a></h2><blockquote><p>可导入数据如下：</p><ul><li>XMLHttpRequest 请求</li><li>a text file 文本文件</li><li>a JSON blob JSON数据</li><li>an HTML document fragment HTML片段</li><li>an XML document fragment XML片段</li><li>a comma-separated values (CSV) file CSV文件</li><li>a tab-separated values (TSV) file TSV文件</li></ul></blockquote></div></div></main><!--[--><!--]--><footer class="VPDocFooter" data-v-37ebe389 data-v-a54a85bd><!----><div class="prev-next" data-v-a54a85bd><div class="pager" data-v-a54a85bd><a class="pager-link prev" href="/frontend-blog/pages/front-end-stack2/vis/echarts/" data-v-a54a85bd><span class="desc" data-v-a54a85bd>Previous page</span><span class="title" data-v-a54a85bd>echarts</span></a></div><div class="has-prev pager" data-v-a54a85bd><a class="pager-link next" href="/frontend-blog/pages/front-end-stack2/vis/svg/" data-v-a54a85bd><span class="desc" data-v-a54a85bd>Next page</span><span class="title" data-v-a54a85bd>SVG</span></a></div></div></footer><!--[--><!--]--></div></div></div></div></div><!----><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"index.md\":\"6b8588ad\",\"pages_computer-knowledge-stack_algorithm_index.md\":\"e960a6a8\",\"pages_computer-knowledge-stack_index.md\":\"69ea9b06\",\"pages_computer-knowledge-stack_sql_index.md\":\"c015faca\",\"pages_front-end-stack1_basic_css1_index.md\":\"2bb683d7\",\"pages_front-end-stack1_basic_css2_index.md\":\"d4d9ce0f\",\"pages_front-end-stack1_basic_html_index.md\":\"b1256eb6\",\"pages_front-end-stack1_basic_js1_index.md\":\"35feb230\",\"pages_front-end-stack1_basic_js2_index.md\":\"59ece64c\",\"pages_front-end-stack1_basic_js3_index.md\":\"e3c043bb\",\"pages_front-end-stack1_basic_js4_index.md\":\"1bed5b82\",\"pages_front-end-stack1_index.md\":\"b191358b\",\"pages_front-end-stack1_tools_emmet_index.md\":\"de1820f5\",\"pages_front-end-stack1_tools_jquery_index.md\":\"7dede189\",\"pages_front-end-stack2_framework_nodejs_index.md\":\"f8a07a81\",\"pages_front-end-stack2_framework_react_index.md\":\"213deaff\",\"pages_front-end-stack2_framework_typescript_index.md\":\"d616d746\",\"pages_front-end-stack2_framework_vue1_index.md\":\"9be0a8d1\",\"pages_front-end-stack2_framework_vue2_index.md\":\"ead90d53\",\"pages_front-end-stack2_index.md\":\"aa98f5c6\",\"pages_front-end-stack2_vis_canvas_index.md\":\"ab6a89f0\",\"pages_front-end-stack2_vis_d3_index.md\":\"9c377a64\",\"pages_front-end-stack2_vis_echarts_index.md\":\"c8ee2e9d\",\"pages_front-end-stack2_vis_svg_index.md\":\"6019b3c3\",\"pages_thoughts_index.md\":\"6ce4540a\"}")</script>
    <script type="module" async src="/frontend-blog/assets/app.faf1c2cf.js"></script>
    
  </body>
</html>
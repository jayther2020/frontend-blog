<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SQL笔记 | 个人前端知识库</title>
    <meta name="description" content="用来整理自己所学的前端知识，收藏过的技术博客，心得体会等">
    <link rel="stylesheet" href="/frontend-blog/assets/style.efc7c571.css">
    <link rel="modulepreload" href="/frontend-blog/assets/app.1804b206.js">
    <link rel="modulepreload" href="/frontend-blog/assets/pages_computer-knowledge-stack_sql_index.md.12f61af7.lean.js">
    
    <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-c6a644e1><!--[--><!--]--><!--[--><span tabindex="-1" data-v-151f2593></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-151f2593> Skip to content </a><!--]--><!----><header class="VPNav" data-v-c6a644e1 data-v-a71a30f1><div class="VPNavBar has-sidebar" data-v-a71a30f1 data-v-6f1d18b5><div class="container" data-v-6f1d18b5><div class="VPNavBarTitle has-sidebar" data-v-6f1d18b5 data-v-d5925166><a class="title" href="/frontend-blog/" data-v-d5925166><!--[--><!--]--><!----><!--[-->个人前端知识库<!--]--><!--[--><!--]--></a></div><div class="content" data-v-6f1d18b5><!--[--><!--]--><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-6f1d18b5 data-v-f83db6ba><span id="main-nav-aria-label" class="visually-hidden" data-v-f83db6ba>Main Navigation</span><!--[--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-f83db6ba data-v-6ffb57d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-6ffb57d3><span class="text" data-v-6ffb57d3><!----> 前端基础 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-6ffb57d3><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-6ffb57d3><div class="VPMenu" data-v-6ffb57d3 data-v-1c5d0cfc><div class="items" data-v-1c5d0cfc><!--[--><!--[--><div class="VPMenuLink" data-v-1c5d0cfc data-v-e8e0fb1d><a class="VPLink link" href="/frontend-blog/pages/front-end-stack1/basic/html/" data-v-e8e0fb1d data-v-3c355974><!--[-->HTML<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-1c5d0cfc data-v-e8e0fb1d><a class="VPLink link" href="/frontend-blog/pages/front-end-stack1/basic/css1/" data-v-e8e0fb1d data-v-3c355974><!--[-->CSS<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-1c5d0cfc data-v-e8e0fb1d><a class="VPLink link" href="/frontend-blog/pages/front-end-stack1/basic/js1/" data-v-e8e0fb1d data-v-3c355974><!--[-->Javascript<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-1c5d0cfc data-v-e8e0fb1d><a class="VPLink link" href="/frontend-blog/pages/front-end-stack1/basic/js4/" data-v-e8e0fb1d data-v-3c355974><!--[-->网络请求<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-1c5d0cfc data-v-e8e0fb1d><a class="VPLink link" href="/frontend-blog/pages/front-end-stack1/tools/jquery/" data-v-e8e0fb1d data-v-3c355974><!--[-->jQUERY<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-f83db6ba data-v-6ffb57d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-6ffb57d3><span class="text" data-v-6ffb57d3><!----> 前端框架 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-6ffb57d3><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-6ffb57d3><div class="VPMenu" data-v-6ffb57d3 data-v-1c5d0cfc><div class="items" data-v-1c5d0cfc><!--[--><!--[--><div class="VPMenuLink" data-v-1c5d0cfc data-v-e8e0fb1d><a class="VPLink link" href="/frontend-blog/pages/front-end-stack2/framework/vue1/" data-v-e8e0fb1d data-v-3c355974><!--[-->Vue<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-1c5d0cfc data-v-e8e0fb1d><a class="VPLink link" href="/frontend-blog/pages/front-end-stack2/framework/react/" data-v-e8e0fb1d data-v-3c355974><!--[-->React<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-1c5d0cfc data-v-e8e0fb1d><a class="VPLink link" href="/frontend-blog/pages/front-end-stack2/framework/nodejs/" data-v-e8e0fb1d data-v-3c355974><!--[-->Nodejs<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-1c5d0cfc data-v-e8e0fb1d><a class="VPLink link" href="/frontend-blog/pages/front-end-stack2/vis/d3/" data-v-e8e0fb1d data-v-3c355974><!--[-->D3.js<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/frontend-blog/pages/computer-knowledge-stack/" data-v-f83db6ba data-v-47a2263e data-v-3c355974><!--[-->计算机基础<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/frontend-blog/pages/thoughts/" data-v-f83db6ba data-v-47a2263e data-v-3c355974><!--[-->心得体会<!--]--><!----></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-6f1d18b5 data-v-a3e7452b><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-a3e7452b data-v-31fdf26f data-v-eba7420e><span class="check" data-v-eba7420e><span class="icon" data-v-eba7420e><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-31fdf26f><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-31fdf26f><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-6f1d18b5 data-v-738bef5a data-v-f6988cfb><!--[--><a class="VPSocialLink" href="https://gitee.com/jayther2020" target="_blank" rel="noopener" data-v-f6988cfb data-v-e57698f6><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>码云</title><path d="M11.984 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.016 0zm6.09 5.333c.328 0 .593.266.592.593v1.482a.594.594 0 0 1-.593.592H9.777c-.982 0-1.778.796-1.778 1.778v5.63c0 .327.266.592.593.592h5.63c.982 0 1.778-.796 1.778-1.778v-.296a.593.593 0 0 0-.592-.593h-4.15a.592.592 0 0 1-.592-.592v-1.482a.593.593 0 0 1 .593-.592h6.815c.327 0 .593.265.593.592v3.408a4 4 0 0 1-4 4H5.926a.593.593 0 0 1-.593-.593V9.778a4.444 4.444 0 0 1 4.445-4.444h8.296Z"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-6f1d18b5 data-v-e4361c82 data-v-6ffb57d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-6ffb57d3><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-6ffb57d3><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-6ffb57d3><div class="VPMenu" data-v-6ffb57d3 data-v-1c5d0cfc><!----><!--[--><!--[--><!----><div class="group" data-v-e4361c82><div class="item appearance" data-v-e4361c82><p class="label" data-v-e4361c82>Appearance</p><div class="appearance-action" data-v-e4361c82><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-e4361c82 data-v-31fdf26f data-v-eba7420e><span class="check" data-v-eba7420e><span class="icon" data-v-eba7420e><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-31fdf26f><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-31fdf26f><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-e4361c82><div class="item social-links" data-v-e4361c82><div class="VPSocialLinks social-links-list" data-v-e4361c82 data-v-f6988cfb><!--[--><a class="VPSocialLink" href="https://gitee.com/jayther2020" target="_blank" rel="noopener" data-v-f6988cfb data-v-e57698f6><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>码云</title><path d="M11.984 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.016 0zm6.09 5.333c.328 0 .593.266.592.593v1.482a.594.594 0 0 1-.593.592H9.777c-.982 0-1.778.796-1.778 1.778v5.63c0 .327.266.592.593.592h5.63c.982 0 1.778-.796 1.778-1.778v-.296a.593.593 0 0 0-.592-.593h-4.15a.592.592 0 0 1-.592-.592v-1.482a.593.593 0 0 1 .593-.592h6.815c.327 0 .593.265.593.592v3.408a4 4 0 0 1-4 4H5.926a.593.593 0 0 1-.593-.593V9.778a4.444 4.444 0 0 1 4.445-4.444h8.296Z"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-6f1d18b5 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div><!----></header><div class="VPLocalNav" data-v-c6a644e1 data-v-aac27d5e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-aac27d5e><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-aac27d5e><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-aac27d5e>Menu</span></button><a class="top-link" href="#" data-v-aac27d5e> Return to top </a></div><aside class="VPSidebar" data-v-c6a644e1 data-v-0f582cdc><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-0f582cdc><span class="visually-hidden" id="sidebar-aria-label" data-v-0f582cdc> Sidebar Navigation </span><!--[--><div class="group" data-v-0f582cdc><section class="VPSidebarGroup collapsible" data-v-0f582cdc data-v-6e45c352><div class="title" role="button" data-v-6e45c352><h2 class="title-text" data-v-6e45c352>计算机基础笔记</h2><div class="action" data-v-6e45c352><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-6e45c352><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-6e45c352><!--[--><!--[--><a class="VPLink link link active" href="/frontend-blog/pages/computer-knowledge-stack/sql/" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>SQL</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/frontend-blog/pages/computer-knowledge-stack/db-theorm/" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>数据库原理</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/frontend-blog/pages/computer-knowledge-stack/os/" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>操作系统</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/frontend-blog/pages/computer-knowledge-stack/ds/" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>数据结构</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/frontend-blog/pages/computer-knowledge-stack/algorithm/" style="padding-left:0px;" data-v-36b976d1 data-v-3c355974><!--[--><span class="link-text" data-v-36b976d1>算法</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-c6a644e1 data-v-c95df128><div class="VPDoc has-sidebar has-aside" data-v-c95df128 data-v-37ebe389><div class="container" data-v-37ebe389><div class="aside" data-v-37ebe389><div class="aside-curtain" data-v-37ebe389></div><div class="aside-container" data-v-37ebe389><div class="aside-content" data-v-37ebe389><div class="VPDocAside" data-v-37ebe389 data-v-afc4c1a1><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" data-v-afc4c1a1 data-v-2865c0b0><div class="content" data-v-2865c0b0><div class="outline-marker" data-v-2865c0b0></div><div class="outline-title" data-v-2865c0b0>目录</div><nav aria-labelledby="doc-outline-aria-label" data-v-2865c0b0><span class="visually-hidden" id="doc-outline-aria-label" data-v-2865c0b0> Table of Contents for current page </span><ul class="root" data-v-2865c0b0 data-v-1188541a><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-afc4c1a1></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-37ebe389><div class="content-container" data-v-37ebe389><!--[--><!--]--><main class="main" data-v-37ebe389><div style="position:relative;" class="vp-doc _frontend-blog_pages_computer-knowledge-stack_sql_index" data-v-37ebe389><div><p><img src="/frontend-blog/assets/IMG_20220825_124216.c01fe838.jpg" alt=""></p><h1 id="sql笔记" tabindex="-1">SQL笔记 <a class="header-anchor" href="#sql笔记" aria-hidden="true">#</a></h1><blockquote><p>SQL，全称Structured Query Language（结构化查询语言）是非过程化查询语言</p><p>我们是在查询窗口来执行相关SQL命令。在Navicat快捷键<code>ctrl+q</code>可以新建一个查询，可以在里面书写SQL代码。要执行代码，可以选中要执行的代码，<code>ctrl+R</code>执行。</p><p>也可以在命令行运行。在Navicat用<code>F6</code>打开sql命令行，用<code>shift+F6</code>在新窗口打开命令行。</p><p>每个SQL语句完需要分号隔开，作为结束标志。</p></blockquote><p>下面就以**字符集和校对规则（排序规则）**来阐述sql的使用方法吧</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#676E95;">-- 1.注释：用双减号一空格标识注释，ctrl+/可以开启关闭一行注释。</span></span>
<span class="line"><span style="color:#A6ACCD;">字符集：字符的编码；</span></span>
<span class="line"><span style="color:#676E95;">-- 查看字符集</span></span>
<span class="line"><span style="color:#A6ACCD;">show </span><span style="color:#F78C6C;">character</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#676E95;">-- 查看校对规则</span></span>
<span class="line"><span style="color:#A6ACCD;">show collation;</span></span>
<span class="line"></span></code></pre></div><p>执行所选代码，<code>show character set;</code>查询结果如下：</p><p><img src="/frontend-blog/assets/image-20220919231051304.a7cd36ba.png" alt="image-20220919231051304"></p><p>而<code>show collation;</code>查询结果如下：</p><p><img src="/frontend-blog/assets/image-20220919231320345.8a18d0f5.png" alt="image-20220919231320345"></p><p>由此可见字符集与校对规则之间是==一对多==的关系。</p><h2 id="数据库相关" tabindex="-1">数据库相关 <a class="header-anchor" href="#数据库相关" aria-hidden="true">#</a></h2><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#676E95;">-- 1.创建数据库</span></span>
<span class="line"><span style="color:#676E95;">-- create database 数据库名;</span></span>
<span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">database</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">not</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">exists</span><span style="color:#A6ACCD;"> testDB;</span></span>
<span class="line"><span style="color:#676E95;">-- 如果数据库名不合法，数据库名要用反引号括起来。</span></span>
<span class="line"><span style="color:#676E95;">-- 为规避报错，建议这样做。</span></span>
<span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">database</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">`</span><span style="color:#C3E88D;">123</span><span style="color:#89DDFF;">`</span><span style="color:#A6ACCD;">; </span><span style="color:#676E95;">-- 不会报错，且会创建成功</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">-- 2.改动数据库</span></span>
<span class="line"><span style="color:#676E95;">-- alter database 数据库名 改动项目;</span></span>
<span class="line"><span style="color:#F78C6C;">alter</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">database</span><span style="color:#A6ACCD;"> testDB </span><span style="color:#C792EA;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">character</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> gb2312;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">-- 3.选择数据库</span></span>
<span class="line"><span style="color:#F78C6C;">use</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">database</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#676E95;">-- 选择后就可以用下面的语句选择它的指定数据表了</span></span>
<span class="line"><span style="color:#676E95;">-- select * from 数据表：会选择某数据表的全部数据</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> tables;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">-- 4.删除数据库</span></span>
<span class="line"><span style="color:#F78C6C;">drop</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">database</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">exists</span><span style="color:#A6ACCD;"> testDB;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">-- 5.查看所有数据库</span></span>
<span class="line"><span style="color:#A6ACCD;">show databases</span></span>
<span class="line"><span style="color:#676E95;">-- 6.</span></span>
<span class="line"><span style="color:#676E95;">-- 格式：show create database 数据库名</span></span>
<span class="line"><span style="color:#A6ACCD;">show </span><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">database</span><span style="color:#A6ACCD;"> testDB</span></span>
<span class="line"></span></code></pre></div><h2 id="数据表基础" tabindex="-1">数据表基础 <a class="header-anchor" href="#数据表基础" aria-hidden="true">#</a></h2><h3 id="数据类型" tabindex="-1">数据类型 <a class="header-anchor" href="#数据类型" aria-hidden="true">#</a></h3><p><strong>整数类型</strong>：tinyint，int（integer），smallint，mediumint，bigint，</p><p>各有各的取值范围。</p><table><thead><tr><th>类型</th><th>字节数</th><th>有符号（默认）</th><th>无符号（unsigned）</th></tr></thead><tbody><tr><td>tinyint</td><td>1</td><td>-128~127（-2^7,2^7-1）</td><td>0~255</td></tr><tr><td>smallint</td><td>2</td><td>-32 768~32 767</td><td>0~65 535</td></tr><tr><td>mediumint</td><td>3</td><td>-8 388 608, 8 388 607</td><td>0~16 777 215</td></tr><tr><td>int</td><td>4</td><td>-2 147 483 648, 2 147 483 647</td><td>0~4 294 967 295</td></tr><tr><td>bigint</td><td>8</td><td>-2^63~2^63-1</td><td>0~2^64-1</td></tr></tbody></table><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">use</span><span style="color:#A6ACCD;"> TestDB;</span></span>
<span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> t1</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">	id </span><span style="color:#F78C6C;">tinyint</span></span>
<span class="line"><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">insert</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> t1 </span><span style="color:#F78C6C;">values</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">128</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">insert</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> t1 </span><span style="color:#F78C6C;">values</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">127</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">insert</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> t1 </span><span style="color:#F78C6C;">values</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">250</span><span style="color:#A6ACCD;">);  </span><span style="color:#676E95;">-- 超出范围的会报错</span></span>
<span class="line"><span style="color:#676E95;">-- eg: 无符号的tinyint</span></span>
<span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> t2</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">	id </span><span style="color:#F78C6C;">tinyint</span><span style="color:#A6ACCD;"> unsigned</span></span>
<span class="line"><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">insert</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> t2 </span><span style="color:#F78C6C;">values</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">255</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">insert</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> t2 </span><span style="color:#F78C6C;">values</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">256</span><span style="color:#A6ACCD;">);  </span><span style="color:#676E95;">-- 超出范围的会报错</span></span>
<span class="line"><span style="color:#F78C6C;">insert</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> t2 </span><span style="color:#F78C6C;">values</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">insert</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> t2 </span><span style="color:#F78C6C;">values</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">);  </span><span style="color:#676E95;">-- 超出范围的会报错</span></span>
<span class="line"></span></code></pre></div><p><strong>字符串类型</strong></p><p><code>char</code>：定长字符串；<code>varchar</code>：不定长字符串</p><p>mysql中长度5可以存5个汉字，在其他字符串就只能存一半数量的汉字。</p><p><strong>小数类型</strong></p><p>float，double，decimal</p><p>小数格式：<code>decimal(小数位+整数位，小数位)</code></p><blockquote><p>不论是定点还是浮点类型，如果用户指定的精度超出精度范围，则会四舍五入进行处理。</p></blockquote><table><thead><tr><th>小数 数据类型</th><th>有符号（默认）可表示范围</th><th>无符号（unsigned）可表示范围</th></tr></thead><tbody><tr><td>FLOAT(<em>size</em>,<em>d</em>)</td><td>-3.402823466E+38～-1.175494351E-38</td><td>0 和 1.175494351E-38～3.402823466E+38。</td></tr><tr><td>DOUBLE(<em>size</em>,<em>d</em>)</td><td></td><td></td></tr><tr><td>DECIMAL(<em>size</em>,<em>d</em>)</td><td></td><td></td></tr></tbody></table><p>在用户指定的相同精度下，decimal的精度最高。</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> t4(</span></span>
<span class="line"><span style="color:#A6ACCD;">    c1 double(</span><span style="color:#F78C6C;">21</span><span style="color:#A6ACCD;">,</span><span style="color:#F78C6C;">20</span><span style="color:#A6ACCD;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">    c2 </span><span style="color:#F78C6C;">float</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">21</span><span style="color:#A6ACCD;">,</span><span style="color:#F78C6C;">20</span><span style="color:#A6ACCD;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">    c3 </span><span style="color:#F78C6C;">decimal</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">21</span><span style="color:#A6ACCD;">,</span><span style="color:#F78C6C;">20</span><span style="color:#A6ACCD;">）</span></span>
<span class="line"><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">insert</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">values</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;">-- 报错</span></span>
<span class="line"><span style="color:#F78C6C;">insert</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> t4 </span><span style="color:#F78C6C;">values</span></span>
<span class="line"></span></code></pre></div><p><strong>时间日期</strong></p><p>有四种类型：datetime，date，time，year</p><table><thead><tr><th>时间日期 数据类型</th><th>格式</th></tr></thead><tbody><tr><td>datetime</td><td>YYYY-MM-DD HH:MM:SS</td></tr><tr><td>date</td><td>YYYY-MM-DD</td></tr><tr><td>time</td><td>HH:MM:SS</td></tr><tr><td>year</td><td>2 位或 4 位格式的年。</td></tr></tbody></table><p><a href="#%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0">now()函数链接</a></p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> t5(</span></span>
<span class="line"><span style="color:#A6ACCD;">    c1 </span><span style="color:#F78C6C;">datetime</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    c2 </span><span style="color:#F78C6C;">date</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    c3 </span><span style="color:#82AAFF;">year</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    c4 </span><span style="color:#F78C6C;">time</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#F78C6C;">insert</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> t5 </span><span style="color:#F78C6C;">values</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">now</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;">,</span><span style="color:#F78C6C;">now</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;">,</span><span style="color:#F78C6C;">now</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;">,</span><span style="color:#F78C6C;">now</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> t5;</span></span>
<span class="line"></span></code></pre></div><p><img src="/frontend-blog/assets/image-20220930085149825.40653a53.png" alt="image-20220930085149825"></p><p><strong>枚举类型enum</strong>：只能取其一：<code>字段名 enum(&quot;值1&quot;,&quot;值2&quot;,&quot;值3&quot;,...,&quot;值n&quot;)</code></p><p><strong>集合类型set</strong>：可以取其中多个：<code>字段名 set(&quot;值1&quot;,&quot;值2&quot;,&quot;值3&quot;,...,&quot;值n&quot;)</code></p><blockquote><p>ENUM 类型相当于单选题，SET 类型相当于多选题。</p><p>enum还有多种写法：比如<code>Ssex enum(&#39;男&#39;，&#39;女)default&#39;男&#39;;</code>可以被写成：</p><p><code>Ssex char(l) check(Ssex=&#39;男&#39;or Ssex=&#39;女&#39;)default&#39;男&#39;;</code><code>Ssex char(l) check(Ssex in(&#39;男&#39;，&#39;女&#39;)default&#39;男&#39;;</code></p></blockquote><p>输入值中间不能加空格：<code>values(&quot;唱,跳,rap,篮球&quot;)</code></p><h3 id="数据约束" tabindex="-1">数据约束 <a class="header-anchor" href="#数据约束" aria-hidden="true">#</a></h3><blockquote><ol><li><p>统一格式：<code>约束条件</code></p><p>带名字约束：<code>CONSTRAINT 外键名 约束条件</code></p></li><li><p>约束分为==列级约束==和==表级约束==，有的用法无法使用列级约束，参考如下：</p><table><thead><tr><th>约束种类</th><th>是否能使用表级约束？</th><th>是否能使用列级约束？</th></tr></thead><tbody><tr><td><code>primary key</code></td><td>T</td><td>T</td></tr><tr><td><code>foreign key</code></td><td>T</td><td>T</td></tr><tr><td><code>unique</code></td><td>T</td><td>T</td></tr><tr><td><code>check</code></td><td>T</td><td>T</td></tr><tr><td><code>default</code></td><td><em>F</em></td><td>T</td></tr><tr><td><code>not null / null</code></td><td><em>F</em></td><td>T</td></tr></tbody></table></li></ol></blockquote><p><strong>主键</strong></p><p>关键字：<code>primary key</code></p><p>主键，是表中一列或者多列的组合，主键约束遵从<em>实体完整性</em>，要求主键列的==数据唯一==，并且==不允许为空==。</p><p>即主键能够唯一的标识表中的每一条记录。</p><blockquote><p>有两种方式可以添加主键约束：</p><ol><li>在定义列的同时指定主键，是列级约束，==只可指定一个==主键；</li><li>在定义完字段之后再指定主键，是表级约束，==可以指定多个==主键。</li></ol></blockquote><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> t_dept(</span></span>
<span class="line"><span style="color:#A6ACCD;">    id </span><span style="color:#F78C6C;">INT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">PRIMARY</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">KEY</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">name</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">22</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">NOT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">location</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">50</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><blockquote><p>注意！设为主键的都有非空约束和唯一约束。</p><p><img src="/frontend-blog/assets/image-20220930092821710.7dceae88.png" alt="image-20220930092821710"></p></blockquote><p><strong>外键约束</strong></p><p>关键字：<code>foreign key</code>。外键遵循参照完整性，其取值：要么取空值，要么取它所参照的主码的值。</p><blockquote><p>在以后我们统一将外部关键字叫做==外键==，外键就是==另一张表中的主键==。</p><p>外键的主要作用就是保持数据的一致性，完整性。</p><p>格式：<code>FOREIGN KEY 字段名 REFERENCES 主表名(主键名)</code></p><p>带名字格式：<code>CONSTRAINT 外键名 FOREIGN KEY 字段名 REFERENCES 主表名(主键名)</code></p></blockquote><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> t_dept</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">    deptId </span><span style="color:#F78C6C;">INT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">PRIMARY</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">KEY</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">name</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">22</span><span style="color:#A6ACCD;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">location</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">50</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> t_emp</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">    id </span><span style="color:#F78C6C;">INT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">PRIMARY</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">KEY</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">name</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">22</span><span style="color:#A6ACCD;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">    deptId </span><span style="color:#F78C6C;">INT</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#676E95;">--    CONSTRAINT fk_emp_dept1 FOREIGN KEY(deptId) REFERENCES t_dept(deptId)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">FOREIGN KEY</span><span style="color:#A6ACCD;">(deptId) </span><span style="color:#C792EA;">REFERENCES</span><span style="color:#A6ACCD;"> t_dept(deptId)</span></span>
<span class="line"><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span></code></pre></div><p><strong>取值唯一</strong></p><p>关键字：unique</p><p>唯一约束<code>（Unique Constraint）</code>要求该列唯一，允许为空，但是只能有一个空值。唯一约束可以确保一列或者几列不出现重复值。</p><p>定义部门表的部门名称唯一，<code>SQL</code>语句如下：关键词 <code>UNIQUE</code>。</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> t_dept(</span></span>
<span class="line"><span style="color:#A6ACCD;">    id </span><span style="color:#F78C6C;">INT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">PRIMARY</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">KEY</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">name</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">22</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">UNIQUE</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">location</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">50</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p><strong>检查约束</strong></p><p>关键字：check</p><p>里面可以自定义数据约束，相关约束写法参见<a href="#%E9%99%90%E5%88%B6%E8%8C%83%E5%9B%B4">单表查询限制</a>。</p><p>此约束保证用户自定义完整性，也就是反映==实际的语义要求==。</p><p><code>Grade int check(Grade&gt;=0 and Grade &lt;=100)</code><code>Grade int check(Grade between 0 and 100)</code></p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#A6ACCD;">Ssex </span><span style="color:#F78C6C;">char</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">)</span><span style="color:#C792EA;">check</span><span style="color:#A6ACCD;">(Ssex</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">男</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F78C6C;">or</span><span style="color:#A6ACCD;"> Ssex</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">女</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">Ssex </span><span style="color:#F78C6C;">char</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">)</span><span style="color:#C792EA;">check</span><span style="color:#A6ACCD;">(Ssex </span><span style="color:#F78C6C;">in</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">男</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">，</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">女</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p><strong>默认值</strong></p><p>关键字：default</p><p>默认约束：即给字段一个默认值。</p><blockquote><ul><li>如果是添加字符串型默认值要使用单引号，如果是整型则不需要加任何符号；</li><li>如果要添加的是中文默认值，则需要加上<code>DEFAULT CHARSET=utf8;</code>使用英文字符则不需要。</li></ul></blockquote><p><strong>非空</strong></p><p>关键字：<code>not null</code>；被选定的字段不允许有空值。</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> t_dept(</span></span>
<span class="line"><span style="color:#A6ACCD;">    id </span><span style="color:#F78C6C;">INT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">PRIMARY</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">KEY</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">name</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">22</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">NOT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">location</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">50</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p><strong>自增字段</strong></p><p>在数据库应用中，经常有个需求就是，在每次插入新纪录时，系统<em>自动生成</em>字段的主键值</p><p>关键词：<code>AUTO_INCREMENT</code>，默认情况下初始值和增量都为<code>1</code>。</p><p>注意！自增字段必须是主键约束之一，所以别忘了给自增字段设定<code>primary key</code></p><p>可以查看当前自增变量的默认初值和增量<code>show variables like &#39;auto incr%&#39;;</code></p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> t8(</span></span>
<span class="line"><span style="color:#A6ACCD;">    id </span><span style="color:#F78C6C;">int</span><span style="color:#A6ACCD;"> auto_increment </span><span style="color:#F78C6C;">primary</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">key</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">name</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">char</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">    age </span><span style="color:#F78C6C;">int</span></span>
<span class="line"><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#676E95;">-- SQL Server</span></span>
<span class="line"><span style="color:#A6ACCD;">id </span><span style="color:#F78C6C;">int</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">identity</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">,</span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">)</span><span style="color:#F78C6C;">primary</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">key</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"></span></code></pre></div><h3 id="存储引擎" tabindex="-1">存储引擎 <a class="header-anchor" href="#存储引擎" aria-hidden="true">#</a></h3><p>存储引擎其实是如何存储数据、如何查询数据、更新数据的机制。也称为<em>表类型</em>。默认的存储引擎是InnoDB (1) <strong>InnoDB</strong>：支持事务，支持外键，支持行级锁。</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> t9</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">id </span><span style="color:#F78C6C;">int</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#F78C6C;">name</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">char</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">age </span><span style="color:#F78C6C;">int</span></span>
<span class="line"><span style="color:#A6ACCD;">)engine </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> InnoDB;</span></span>
<span class="line"></span></code></pre></div><p>(2) <strong>MylSAM</strong>：不支持外键，支持表级锁。</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">alter</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> SC engine MylSAM;</span></span>
<span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> t10</span></span>
<span class="line"><span style="color:#A6ACCD;">id </span><span style="color:#F78C6C;">int</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#F78C6C;">name</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">char</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">age </span><span style="color:#F78C6C;">int</span></span>
<span class="line"><span style="color:#A6ACCD;">)engine </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> MylSAM;</span></span>
<span class="line"></span></code></pre></div><p>(3) <strong>CSV</strong>：只由逗号分隔数据的存储方式</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> t11</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">id </span><span style="color:#F78C6C;">int</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">not</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">null</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#F78C6C;">name</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">char</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;">)</span><span style="color:#F78C6C;">not</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">null</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">age </span><span style="color:#F78C6C;">int</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">not</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">null</span></span>
<span class="line"><span style="color:#A6ACCD;">)engine</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">CSV;</span></span>
<span class="line"></span></code></pre></div><p>(4)<strong>Memory</strong></p><blockquote><p>表中的数据存放是内存中的，一旦系统重启，数据就丢失了。</p></blockquote><h3 id="聚合函数" tabindex="-1">聚合函数 <a class="header-anchor" href="#聚合函数" aria-hidden="true">#</a></h3><p>聚合函数的特点：</p><ul><li>每个函数接收一个参数（字段名或者表达式）；</li><li>默认情况下，组函数忽略列值为<code>null</code>的行，不参与计算；</li><li>不允许出现嵌套 比如<code>sum(max(xx))</code>；</li><li>常与<code>group by</code>关键字一起使用。（后面章节会讲到）；</li><li>一个<code>SELECT</code>子句中可出现多个聚集函数。</li></ul><table><thead><tr><th>函数名</th><th>用法</th><th></th></tr></thead><tbody><tr><td>count</td><td><code>select count(Sno) from student;</code></td><td>返回字段的值的数量，计重复值。</td></tr><tr><td>max</td><td><code>select max(Grade) from sc;</code></td><td>返回字段的值的最大值</td></tr><tr><td>min</td><td><code>select min(Grade) from sc;</code></td><td>返回字段的值的最小值</td></tr><tr><td>sum</td><td><code>select sum(score) from tb_class;</code></td><td>返回字段的值的和</td></tr><tr><td>avg</td><td><code>select ave(score) from student;</code></td><td>返回字段的值的平均值</td></tr></tbody></table><p><strong>count()</strong></p><blockquote><p>使用方法：<code>count([all | distinct] 字段名)</code></p><p>限制参数：默认是all，去重用distinct</p></blockquote><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#676E95;">-- 默认计重复值</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">count</span><span style="color:#A6ACCD;">(Ssex) </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student; </span><span style="color:#676E95;">-- 累计重复值</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">count</span><span style="color:#A6ACCD;">(all Ssex) </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student; </span><span style="color:#676E95;">-- 与上面等价</span></span>
<span class="line"><span style="color:#676E95;">-- 取消计重复值</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">count</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">distinct</span><span style="color:#A6ACCD;"> Ssex) </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student; </span><span style="color:#676E95;">--不累计重复值</span></span>
<span class="line"><span style="color:#676E95;">-- 统计有多少记录(多少行)：count(*)</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">count</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student; </span><span style="color:#676E95;">-- Student中元组的个数</span></span>
<span class="line"><span style="color:#676E95;">-- 查询选修了课程的学生人数</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">count</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">distinct</span><span style="color:#A6ACCD;"> Sno) </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Sc;</span></span>
<span class="line"><span style="color:#676E95;">-- 查询选修了2号课程的学生的人数</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">count</span><span style="color:#A6ACCD;">(Sno) </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> sc </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Cno </span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><h3 id="其他函数" tabindex="-1">其他函数 <a class="header-anchor" href="#其他函数" aria-hidden="true">#</a></h3><h4 id="字符串相关" tabindex="-1">字符串相关 <a class="header-anchor" href="#字符串相关" aria-hidden="true">#</a></h4><table><thead><tr><th>函数名</th><th>用法</th><th>释义</th></tr></thead><tbody><tr><td>concat()</td><td><code>concat(&quot;字符串1&quot;,&quot;字符串2&quot;)</code></td><td>连接一个或多个字符串</td></tr><tr><td>concat_ws()</td><td><code>concat_ws(&quot;连接字符串&quot;,&quot;字符串1&quot;,&quot;字符串2&quot;)</code></td><td>用所给连接字符串连接一个或多个字符串</td></tr><tr><td>lower()</td><td><code>lower(&quot;Welcome to China!&quot;)</code></td><td>将字符串转小写</td></tr><tr><td>upper()</td><td><code>upper(&quot;Welcome to China!&quot;)</code></td><td>将字符串转大写</td></tr><tr><td>substring()</td><td></td><td>取子字符串</td></tr></tbody></table><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#676E95;">-- 连接字符串</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">concat</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hello</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">world</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">); # helloworld</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> concat_ws(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">!!!</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Holy</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Jesus</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">); # Holy!!!Jesus</span></span>
<span class="line"><span style="color:#A6ACCD;"># 连接多个字符串 </span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">concat</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hello</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> world</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> hello</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;"> sql</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">); # hello world, hello </span><span style="color:#F78C6C;">sql</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> concat_ws(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">apple</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">banana</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">cherry</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">mango</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">watermelon</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#A6ACCD;"># apple,banana,cherry,mango,watermelon</span></span>
<span class="line"><span style="color:#676E95;">-- 大小写转换</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">lower</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Welcome to China!</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">) result; # welcome </span><span style="color:#F78C6C;">to</span><span style="color:#A6ACCD;"> china!</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">upper</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Welcome to China!</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">) result; # WELCOME </span><span style="color:#F78C6C;">TO</span><span style="color:#A6ACCD;"> CHINA!</span></span>
<span class="line"><span style="color:#676E95;">-- 取子字符串</span></span>
<span class="line"></span></code></pre></div><p>封装将字符串改写为首字母大写，其余字母小写的函数</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">PROCEDURE</span><span style="color:#A6ACCD;"> fn(inout </span><span style="color:#82AAFF;">str</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">255</span><span style="color:#A6ACCD;">))</span></span>
<span class="line"><span style="color:#F78C6C;">BEGIN</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">SUBSTRING</span><span style="color:#A6ACCD;">(</span><span style="color:#82AAFF;">str</span><span style="color:#A6ACCD;">,</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">,</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> @head;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">SUBSTRING</span><span style="color:#A6ACCD;">(</span><span style="color:#82AAFF;">str</span><span style="color:#A6ACCD;">,</span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> @tail;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">CONCAT</span><span style="color:#A6ACCD;">(</span><span style="color:#82AAFF;">UPPER</span><span style="color:#A6ACCD;">(@head),</span><span style="color:#82AAFF;">LOWER</span><span style="color:#A6ACCD;">(@tail)) </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">str</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">END</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">biBoGraphy</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> @test;</span></span>
<span class="line"><span style="color:#F78C6C;">CALL</span><span style="color:#A6ACCD;"> fn(@test);</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> @test;</span></span>
<span class="line"></span></code></pre></div><h4 id="日期时间相关" tabindex="-1">日期时间相关 <a class="header-anchor" href="#日期时间相关" aria-hidden="true">#</a></h4><table><thead><tr><th>函数名</th><th>替代函数</th><th>释义</th></tr></thead><tbody><tr><td>now()</td><td>sysdate()</td><td>现在系统的<em>年月日时分秒</em></td></tr><tr><td>curdate()</td><td>current_date()</td><td>现在系统的<em>年月日</em></td></tr><tr><td>curtime()</td><td>current_time()</td><td>现在系统的<em>时分秒</em></td></tr></tbody></table><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">now</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;">; # 等价于 </span><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">sysdate</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#676E95;">-- 年-月-日 时:分:秒</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> curdate</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;">; # 等价于 </span><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> current_date</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#676E95;">-- 年-月-日</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> curtime</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;">; # 等价于 </span><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">current_time</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#676E95;">-- 时:分:秒</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">### 从具体日期抽出年月日###</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2022-2-4</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">INTO</span><span style="color:#A6ACCD;"> @date;</span></span>
<span class="line"><span style="color:#676E95;">-- 方法1</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">YEAR</span><span style="color:#A6ACCD;">(@date) </span><span style="color:#82AAFF;">year</span><span style="color:#A6ACCD;">,</span><span style="color:#82AAFF;">MONTH</span><span style="color:#A6ACCD;">(@date) </span><span style="color:#82AAFF;">month</span><span style="color:#A6ACCD;">,</span><span style="color:#82AAFF;">DAY</span><span style="color:#A6ACCD;">(@date) </span><span style="color:#82AAFF;">day</span><span style="color:#A6ACCD;">; #等价于</span></span>
<span class="line"><span style="color:#676E95;">-- 方法2</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> extract(</span><span style="color:#82AAFF;">year</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> @date) </span><span style="color:#82AAFF;">year</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">		extract(</span><span style="color:#82AAFF;">month</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> @date) </span><span style="color:#82AAFF;">month</span><span style="color:#A6ACCD;">, </span></span>
<span class="line"><span style="color:#A6ACCD;">		extract(</span><span style="color:#82AAFF;">day</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> @date) </span><span style="color:#82AAFF;">day</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">		</span></span>
<span class="line"><span style="color:#A6ACCD;">### 从具体时间抽出时分秒,同理 ###</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">18:22:34</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">INTO</span><span style="color:#A6ACCD;"> @date;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> HOUR(@date) hour, MINUTE(@date) minute, SECOND(@date) second; #等价于</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> extract(HOUR </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> @date) hour,</span></span>
<span class="line"><span style="color:#A6ACCD;">		extract(MINUTE </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> @date) minute,</span></span>
<span class="line"><span style="color:#A6ACCD;">        extract(SECOND </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> @date) second;</span></span>
<span class="line"></span></code></pre></div><table><thead><tr><th><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQkAAABNCAIAAAA6tAb9AAAI3ElEQVR4nO2dQWjbyBrH//t4hxxzq6s6UUouvrkQxZhgQ48hptgUGmwwvOB9BwcECyGPXJolbPcSEgIFQ33YmiwEbFooMSUlhz2UjSnGVSG+5VJaJ16t99Zjj+8gyZbksWU7tmTZ3+8US5++GY3mr/m+GXX6g8/ngxGPx6P/+e3bNwALCwvKHy5ldnb269evTtdiaLj9cQCYnZ0d81v4l9MVIIgxhbRBEGxIGwTB5t+WFgsLC8ofs7OzI64M0QcT8DjG/BastTFJKezEQA/FBiimIgg2pA2CYEPaIAg2pA2CYEPaIAg2pA2CYGM9h2v6vKoX++/fvw9aHxcwMzPTaDScroXzeDwe97aDx+Mpl8vdbWjcIAg2pA2CYEPaIAg2pA2CYEPaIAg2pA2CYEPamBD4xFGhUNgOOV0PPaHtsatSP5A2XInLe507IG24EX6Oc7oKUwBpgyDYWH8zMjCBzWzK3zj/de+03u1wYDOb8qvnzNb6c0A1l35RMZyq5n79e+3pqqf9SpvgE0f7UU7KxMvBgiioB6VM/LCE0Lb5iB79WdP5Lj6bZwEAglgoiIBc3NnK15ie28sdKfqi5eLO1k1XC131QtsFUTDdR+fDdjFCbVQ+VVN+/+qjwGmrRwOBJT9Qfaf0Y00n6dO6+utp9q6mAG9sb+lTOv1CvW4zm0rtxWSDAu6s/ffOpXq1gwhiAZl4/BDq4xQLBRFycSd+WFM7s3iUuGk+YaWDGHq7WDiaM3YBnU+Dh1p+K55vysfc8wWxwBnKLWzDHnkoVWp15NB24WhZNpsEy8otKQaidlOlsiQKQvRJKK+vaygoANIbZ4SB0cZUlbfnDcC/FGgd8sbW/Gicv60AQGAz5Uc11+ztlRe5KuBfi3kBAPXTPZ2oKm/PG/CsPtI5Azy4/M1pYQCAlNGeael1UQYAufhcfaa1/POiDG55hVcsQtuiALm40+wFtfxWRgIX/SnBs32qHqJPesi9pcyWoVwIQTsydj7xU5TTFQ6UDuNvZGNWVMtv6bp+6bXuppRmM9SVTzwWIBdf2zjumRhpvlGXLo3i8AoPPGhcSsqgseQHqp90YwrkvxuA5257oumN7T1dbf8eWHPlMFK59QBrNzIA+eMH09uOuzcHoMPLsFSWoJOP2afqtM+aqFdxc3xH82HBryxz7f24VJY6X9EKDQEAtQ8fjeJQXLY1o52MMKYCUD99V11N+ZcCqFSgSqOaU970Xu4OAH8qm011uNqYbbD4Rx4HaVhRu5EBtR/wcxwg/2WOxG/+kiG0XWiCm+MBB/tKZ+bucYB0Y1U3Y7ZhpJZ/I0VFIRhCqQRVGlLGsXgKGLU2tKRjLeatnNYDj1Y9jfPf9AOFMb/W443tKcJoZtnWUiHGGD5xpAijmZOYpKIkHY8TfClfCz2JcnLxuXPxFGDDHK6SJzwQvAgs+fVBUF3+B8Adzsu8zCs88ADVXDrtxPTT6FDGEDW+ajF3jwNkyxfvWNMWvBlWYfiVZQ6QMvF4x1knJQNZXuERCgoOx1OAHesbdemyAc8DIbbkb85PAQAqn6pQVNMTgaWJGDRKZQkQHhvzbiUJKTv7mrwFjHxJU0NnQkFzfFX78FEGt7ySCApOzk9p2LD2Vz99V4VnddVvSry1qaenm625p8BmVvllSuObEZb7KR1mJHDR/eYXH0qw0ZqW6oG2zNVpWDe1vwzdDIKpys0Iy0At/0YCF40KY/GiGHW+AUBLOrSp2xb10720vJlNtfLxVvpRP93L3W2dqubSuaUJyTdKh/GbxNG+snIHAHJxJ97fW7KWf15c3o9qCykOLY7pKR3GsV0QmzclZeJb2C6IzaGjlt/K3GsZSJl4JtiemitJh6NTt01+sPy/aWZmZvryyNhLwRvbe7oKZ1auhw/tpaAwkr0U+MTRfhSjV/u47KUQeLTqMaYaBMEk9CTKjUOqAcAObXhja35Uc+yZWoJowSce95l4jZQR5hvNteyOaxgEAUC3Sm7zx5HdsSXfmCwo31CgvdsIYkohbRAEm+Hvh4v+wzDXMUCbTCST3Q7W2ug3eZiZmbGM5FyNq+PsIeLqduhF1RRTEQQb0gZBsCFtEAQb0gZBsCFtEAQb0gZBsLHl328MCZ/46jg53/p98Sz4v7NuNm0Glh56KWIamJh2iByUd8O4PtlYz1z1e617xo3IwXESJxtBlY2T6/Bu+ZXoM5iUWzbtBpYeeihiKpiYdvCJ/wkPfvXg2shms4MXOwCfX24EdeK/yvx8co355I8R7UjkYDeMi2eazVVm/dmFwcDSg6XBlDAh7eATf9GPfX1zq3HDVnlcXZkGxas//rwG+Pvq6yzyMAxcvNeP/GfvL4Dww0iPHqwNpoSJaAef+Ety/vrk2cn1oB5uG1PZPXroWeR1bwXffR64rn02WHyudX+kBg8DGUwJrmsHVRk/Zz5b23ZiCPmGU/KIPAwDqH1R3nGL/Hzrh8bVlxowzy/25GEQgynBbe3QVMatKjycXNx+efjEV7th4PrkpRJE+e73u+ur2UP/BlOC69ohcnA8BGUMcZ7KTnlEDsrHyXnoEu+he7h9EZOB69pBUfJQqju09Y10Oj0sV91oTrybpqyV6Ok2Hno3mBLc2A7qkLExlMWY4WjDJmEoCzldHhZ/3wfoTrQl6JYeLA2mBFe2g7qcMZ88LieNZ5LH5WTf9zIEbdg3YihhL/sGz95f7IbD/KJBG4v8PHChpZAWHnowmBLc2g5XmfVgxnTMJ746TsKRdXGbhAFEfrQIe02LGYAyvdJKIS09WBpMCdQOCrfShm3C0KKjrlMlZy9PrhHePVDVoSZlv2sP2NJDD0VMBdQOKoPHVDYKA9riU3sgCd13cFeZ9eCXg/JuubyrnVg/691DL0VMA9QOKtZ7t/W7lwTtpTAluLodeqm8e77DJQh7IW0QBBvSBkGwIW0QBBvSBkGwIW0QBBvSBkGwsV77G2BT9MneXhtTcIM9MtntYK2NyV7II4hOUExFEGxIGwTBhrRBEGxIGwTBhrRBEGz+DxlquDEZ8b9MAAAAAElFTkSuQmCC" alt="image-20221024181620119"></th><th><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAABCCAIAAAB4qpwyAAAIzUlEQVR4nO2dwWvbyBfH3/74HfIfRKskNstefPPCOkEUe8lhD6E+OCz8ggKGNW4PCQgKxiGXuJgkF2NjKAjqw27IgsEihaU+ZMmhh7I2i8i6UN98CUV2qrq3Hnv8HSTLkixLluORY+V9TrXmafRmMt+ZeW9c+ZvNzU3Q8eXLF0AQZEb8Z94OIIifQYEhCEFQYAhCEBQYghDkv6bPFEW5up+iqK9fv87On3vB0tJSv9+ftxf3C4qisE9MUBQliqK9Da5gCEIQFBiCEAQFhiAEQYEhCEFQYAhCEBQYghBklgJb3c5XKpX9jRlWuZAEd8uCIJR3g/N25METzQqCkI3O0wVcwRaDezBUkGkwHzQjd0eqZdjabKsMrtGzrRDxCFzBEIQgRFawjf1KOqz+u3229/J6bKmpfGO/kg73r07zr28Hl1a380dboF3a2K+kw+2z00+Pj7YoAKMtCYK75UKCbvGsyAhcRL3Y4tlSE6JZ8xWVaFbgItoVmxp05nL9MFOTDE+F+mGmJim3AwBAhBMEDkBvqvfBWAVZdF4Z2+7kkv5G0536G01ljn1o/eje1O2bGbMXWDhdWb463Xt5q4ojXdkHTUOKuDRRrW7nj9KVPO1SJcuPny6/P90jqywDEU4AnmVLoP4ROUHgQK4fsiVJ/etz5d2e3fDW1TCRvYZUy7A1bYCNjGS5fsjWJPVTQVgZGXQEMD44uJvdDTaVpti7pLRCKwaIZrPRZqk5uBEMkxInlNeM8rTtQ63yjOZKeV0m3RWOENgits8Gcrl9/dtVHyD8o5pY3NhPh6F/daotWbev82dtoLaebq+6eQIF73/zUF0AAC1+MG6br+oyAIBcf6H+baXai7oM9Poj27ThsAbVPvG/O+UsolkuAi1eG2DNEt8CiPxCPnkZZSIArT8HD5ZqJU0vdi4Fd58laH0xQLOk9Ek0y0VArh9qc4NUy/AtoBPPjK0Z34ejlTdL7J/y/CPX2Qus/U63I7yVPwPAMr0KALDxYxig/ZdRGtfv2gDUDxE3Cuu/b3krL2iJw2VB6skAIP/7j2n5oVfWJqxBreJOKKNcXyn0PspOXsyOCDMyPdi7FHy0ToNcf2WxvpoUq9AUW2Catcb3oXXlTbHlqk0k8DCLuEovA/Q/mYeW/KkPYcsbxvJZ9lhfTkg9GcD1bEmvBQGmjJmUtKIalHlM76MMETrCCcIv+hDL3qXgo3UaoNWzaG9wjQaQP5oDpt5HGSKj1kbUPlxbGVf5vME0/SIzGuZ7gVTL8CsCFwGgEwUhYcxkjHPpoZ66e5imv5U/A1Dfmid6+lvqHq5J9x1lg0SvzWncNkssy7K8sgNTQyV7l2xKlfV/ZGu7tkIDyC5WpZHK78PpoZfnYNfv2gDhx8aEhhKYqXGb/Klv0uBq5Ad3/8V6ARmNnZT9lC0WIYrnNEsse1jXnLd3yaa0KVqkZywiOhtPrCqfoBfJ4+lB8/XLszZQW0fa1xVXt/PpMLTPBmnF29b7vl6Dq9tPt3yvL5D++VfWDzAlI2Zlok8sNF/VZaATBd33p6JZT75NFc3qnqJEP4oO7F1qlvgW0ImC7kuag5oGRdqNwd0yF9ElDR2xqqGwDvNP03scg12/3JO380fpSiWtXOhfGc6zbl/nTyF/tHVU2VJLT6+eHm1566TnSLXMIZQLiYKQAACQ64eH9WeFhNHkRX29kBicv2VqEki1DNvLCtwwq+BRSNYsidlhJkN3rOXkUrPENpWzscSwVCvq7ZYLwxv11U7oFQv6R7d4NgNZgZvzIvaN6c2+S0tLru7Hl948EPClN6PgS28QZM6gwBCEICgwBCEICgxBCIICQxCCoMAQhCB3fTc9uM/sLwRT9IPvwT6ZArPA3B5qLS0tOR4FLBx45jMK9skok8w4uEVEEIKgwBCEICgwBCEICgxBCIICQxCCoMAQhCC+fSdHiLs4T0onzMGldVFA/dCwNPEVhvaCRZMdDfxIvCjmYoMP9i1WTLvV1A7fcfsYH65gIe5CFEXDiDEWniehmmIYhmGYk0YsJ15wIa999JB4UddehklVu6YmOxr4jxB3IW6+nbDFIe7XmHXJJEwqsEqlMv1DPCPEXYjiMTxnmFS1a2UQf5IMQLf6fDATXR6cNCCQfBL30ktvufk9xehm3g7/vNo1NNnRwH90+B3dimXb4hB3bD1VT4iLFWwBNNbhdxjGcR2XPugMbqQuQPA7/87XnY6pOzpv/jY02dHA/3Q+jHk5QYg7Tga61RPr6XoS3G0RF0Bj9ozK6ftgALp/v3G9t15gvg86TMmOBn4j9F0QoCvdmC8r8nrOmwtc4DoGW2yNdfg/GhBInhfV3UC8mItB4w/3sesCE9+MgWkZd2ngL5QUjy5u0K4fW112yTRZxEqlsre3d5enzpHLAwaKYi4nijkAeCAZsyEh7iIXA+hWfx/TaEcDn6BPIjZOmB1za+PF82SgW03dde6dMou4sOtYvCiKuaCWM0tVgznR5ymzIfGiklxtnIyJUx0N/MPlwSCJyJxAThRFsTjMcSizzEx6YUqBLegKpuwIdf3W4XdOGhBIHvtdYiHuQhSVpSlluWQ7GviXywMmVe1CLKdKbLB4zaQXptkiLqi61OCi8dbYb5dvG7lY7KefQ7w5m+YbBtuhsUeljgZ+p/NBAggo2S/l2CuQPBeTRqPkuZh03UWuBbaw6nqoaEHVuIHhaPAQuJG6oIRkHX6H4U2lIe7iPAkefJNjwdV1I3UBYpvG88T4Zgx8nKiPP3EIqhwNHgKhn38idFrjQmALri4YHNnHcsOkhjp7+zdRr5zw2KQEHQ18SLxoyGuNy9PPhEm3iIuvLgBQ1v833MX5cH/draYYv6oLBmfGo/EEDA4oHA18iHJUo3uVDMFBYP7xB7dvDsKX3jwQsE9GmaRPfPhtegS5P6DAEIQgKDAEIQgKDEEIggJDEIKgwBCEICgwBCGI+aB5ip9K8eWPbviyUXcE+2QKzALz36kxgswR3CIiCEH+D/ITpVHwBBGKAAAAAElFTkSuQmCC" alt="image-20221024182817946"></th></tr></thead></table><h4 id="日期时间处理相关" tabindex="-1">日期时间处理相关 <a class="header-anchor" href="#日期时间处理相关" aria-hidden="true">#</a></h4><table><thead><tr><th>函数名</th><th>用法</th><th>释义</th></tr></thead><tbody><tr><td><code>DATE_ADD()</code></td><td><code>DATE_ADD(基准日期,INTERVAL 间隔表达式 单位)</code></td><td>在基准日期上发生增或减的变化，可代替<code>DATE_SUB()</code></td></tr><tr><td><code>DATE_SUB()</code></td><td><code>DATE_SUB(基准日期,INTERVAL 间隔表达式 单位)</code></td><td>在基准日期上发生减的变化</td></tr><tr><td><code>DATEDIFF()</code></td><td><code>DATEDIFF(日期1,日期2)</code></td><td></td></tr><tr><td><code>DATE_FORMAT()</code></td><td><code>DATE_FORMAT(基准日期,格式)</code></td><td>日期格式化，转换成指定格式。</td></tr></tbody></table><p><code>format</code>字符串中常用的说明符如下：</p><table><thead><tr><th>格式</th><th>描述</th></tr></thead><tbody><tr><td><code>%d</code></td><td>月的天，数值（<code>00-31</code>）</td></tr><tr><td><code>%H</code></td><td>小时 （<code>00-23</code>）</td></tr><tr><td><code>%h</code></td><td>小时 （<code>01-12</code>）</td></tr><tr><td><code>%m</code></td><td>月，数值（<code>00-12</code>）</td></tr><tr><td><code>%p</code></td><td>AM 或 PM</td></tr><tr><td><code>%s</code></td><td>秒（<code>00-59</code>）</td></tr><tr><td><code>%T</code></td><td>时间，<code>24</code>-小时（<code>hh:mm:ss</code>）</td></tr><tr><td><code>%Y</code></td><td>年，<code>4</code> 位</td></tr></tbody></table><blockquote><p>1</p></blockquote><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><h4 id="条件判断相关" tabindex="-1">条件判断相关 <a class="header-anchor" href="#条件判断相关" aria-hidden="true">#</a></h4><p><strong>if</strong></p><p><code>IFNULL()</code>函数：<code>IFNULL(a,b)</code> 如果<code>a</code>不为<code>null</code>返回<code>a</code>，否则返回<code>b</code>；</p><blockquote><p><code>IF()</code>函数：<code>IF(a,b,c)</code> 如果<code>a</code>为真返回<code>b</code>，否则返回<code>c</code>；</p></blockquote><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"></span>
<span class="line"></span></code></pre></div><p><strong>case</strong></p><blockquote><p><code>CASE</code>：<code>CASE WHEN a then b end</code> 判断如果<code>a</code>为真返回<code>b</code>。</p></blockquote><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"></span>
<span class="line"></span></code></pre></div><h2 id="数据表操作" tabindex="-1">数据表操作 <a class="header-anchor" href="#数据表操作" aria-hidden="true">#</a></h2><h3 id="创建数据表" tabindex="-1">创建数据表 <a class="header-anchor" href="#创建数据表" aria-hidden="true">#</a></h3><blockquote><p>创建数据表的格式如下： <code>CREATE TABLE 表名</code><code>(</code><code>字段名,数据类型,</code><code>字段名,数据类型,</code><code>.....</code><code>)</code></p></blockquote><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> table1(</span></span>
<span class="line"><span style="color:#A6ACCD;">    c1 </span><span style="color:#F78C6C;">int</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">10</span><span style="color:#A6ACCD;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">    c2 </span><span style="color:#F78C6C;">varchar</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">30</span><span style="color:#A6ACCD;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">    c3 enum(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">西校区</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">东校区</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">武汉校区</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">    c4 </span><span style="color:#F78C6C;">decimal</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">25</span><span style="color:#A6ACCD;">,</span><span style="color:#F78C6C;">11</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">-- 还可以根据一个数据表生成另一个数据表</span></span>
<span class="line"><span style="color:#676E95;">-- 浅拷贝，即只复制数据表的所有字段，不会复制任何元组</span></span>
<span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> Student1 </span><span style="color:#F78C6C;">like</span><span style="color:#A6ACCD;"> Student;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">-- 深拷贝，既复制数据表的所有字段，又会复制所有元组</span></span>
<span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> Student2 </span><span style="color:#F78C6C;">as</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student;</span></span>
<span class="line"></span></code></pre></div><blockquote><p>tab键缩进</p></blockquote><h3 id="查看数据表信息" tabindex="-1">查看数据表信息 <a class="header-anchor" href="#查看数据表信息" aria-hidden="true">#</a></h3><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#676E95;">-- 查看创建的所有数据表的大致信息</span></span>
<span class="line"><span style="color:#A6ACCD;">show tables;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">-- 表创建好之后可以使用如下语句查看表的基本结构，用来验证是否创建成功是再好不过啦。</span></span>
<span class="line"><span style="color:#A6ACCD;">describe table_name </span><span style="color:#676E95;">-- 或者</span></span>
<span class="line"><span style="color:#F78C6C;">desc</span><span style="color:#A6ACCD;"> table_name</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">-- 查看创建数据表的方式（脚本）。</span></span>
<span class="line"><span style="color:#A6ACCD;">show </span><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> Student;</span></span>
<span class="line"></span></code></pre></div><blockquote><p><code>DESCRIBE</code>查表的结构中各个字段的含义分别为：</p><ul><li><code>NULL</code>：表示该列是否能存储 <code>NULL</code> 值；</li><li><code>Key</code>：表示该列是否已编制索引；</li><li><code>PRI</code>：表示该列是此表主键的一部分；</li><li><code>UNI</code>：表示该列是 <code>UNIQUE</code> 索引的一部分；</li><li><code>MUL</code>：表示在列中某个给定值允许出现多次；</li><li><code>Default</code>：表示该列是否有默认值，如果有的话值是多少；</li><li><code>Extra</code>：表示可以获取的与给定列有关的附加信息。</li></ul></blockquote><h3 id="修改数据表" tabindex="-1">修改数据表 <a class="header-anchor" href="#修改数据表" aria-hidden="true">#</a></h3><blockquote><p>格式：<code>alter table 表名 修改手段</code></p></blockquote><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#676E95;">-- 修改表名：ALTER TABLE 旧表名 RENAME 新表名; </span></span>
<span class="line"><span style="color:#F78C6C;">ALTER</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> tab1 RENAME new_tab; </span></span>
<span class="line"><span style="color:#676E95;">-- 修改Student表，新增字段Sqq</span></span>
<span class="line"><span style="color:#F78C6C;">alter</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">add</span><span style="color:#A6ACCD;"> Sqq </span><span style="color:#F78C6C;">varchar</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">12</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#676E95;">-- 修改字段名qq为Sqq</span></span>
<span class="line"><span style="color:#676E95;">-- 在此句可以同时修改字段的数据类型，但也只能修改数据类型</span></span>
<span class="line"><span style="color:#676E95;">-- 不改类型就保证数据类型和原来的一样即可，不可遗漏新名称的数据类型声明。</span></span>
<span class="line"><span style="color:#F78C6C;">alter</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> Student change qq Sqq </span><span style="color:#F78C6C;">int</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">11</span><span style="color:#A6ACCD;">);  </span></span>
<span class="line"><span style="color:#676E95;">-- 修改字段Sqq的数据类型</span></span>
<span class="line"><span style="color:#F78C6C;">alter</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">modify</span><span style="color:#A6ACCD;"> Sqq </span><span style="color:#F78C6C;">varchar</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">30</span><span style="color:#A6ACCD;">);  </span></span>
<span class="line"><span style="color:#676E95;">-- 修改Student表，删除字段Sqq</span></span>
<span class="line"><span style="color:#F78C6C;">alter</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">drop</span><span style="color:#A6ACCD;"> Sqq;</span></span>
<span class="line"><span style="color:#676E95;">-- 修改Student表，为Sage添加check约束</span></span>
<span class="line"><span style="color:#676E95;">-- 约束格式：&quot;约束名 约束类型（目标字段）&quot;</span></span>
<span class="line"><span style="color:#F78C6C;">alter</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">add</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">constraint</span><span style="color:#A6ACCD;"> ck_Sage </span><span style="color:#C792EA;">check</span><span style="color:#A6ACCD;">(Sage </span><span style="color:#89DDFF;">&gt;=</span><span style="color:#F78C6C;">18</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#676E95;">-- 修改Student表，删除约束ck_Sage</span></span>
<span class="line"><span style="color:#F78C6C;">alter</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">drop</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">constraint</span><span style="color:#A6ACCD;"> ck_Sage;</span></span>
<span class="line"></span></code></pre></div><h3 id="删除数据表" tabindex="-1">删除数据表 <a class="header-anchor" href="#删除数据表" aria-hidden="true">#</a></h3><blockquote><p>格式：<code>drop table 表名</code></p></blockquote><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#676E95;">-- 对于有外键约束的表，先将约束表删除，再把其他表删了。</span></span>
<span class="line"><span style="color:#F78C6C;">drop</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> SC;</span></span>
<span class="line"><span style="color:#F78C6C;">drop</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> Student;</span></span>
<span class="line"><span style="color:#676E95;">-- 嫌麻烦还可以直接一次性删除多个表</span></span>
<span class="line"><span style="color:#F78C6C;">drop</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> Student,Course,SC;</span></span>
<span class="line"></span></code></pre></div><h2 id="数据操作" tabindex="-1">数据操作 <a class="header-anchor" href="#数据操作" aria-hidden="true">#</a></h2><h3 id="插入数据" tabindex="-1">插入数据 <a class="header-anchor" href="#插入数据" aria-hidden="true">#</a></h3><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#676E95;">-- 格式：insert into 数据表名 values(值)</span></span>
<span class="line"><span style="color:#676E95;">-- 向Student:表插入一条记录</span></span>
<span class="line"><span style="color:#F78C6C;">insert</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">values</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2022007</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">007</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">男</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">，</span><span style="color:#F78C6C;">20</span><span style="color:#A6ACCD;">，</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">cs</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#676E95;">-- 向SC表插入选课记录</span></span>
<span class="line"><span style="color:#F78C6C;">insert</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> SC </span><span style="color:#F78C6C;">values</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2022007</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">1001</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span><span style="color:#F78C6C;">100</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">insert</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> SC </span><span style="color:#F78C6C;">values</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2022007</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">1002</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span><span style="color:#F78C6C;">100</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#676E95;">-- 一次插入多条记录</span></span>
<span class="line"><span style="color:#F78C6C;">insert</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> SC </span><span style="color:#F78C6C;">values</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2022007</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">1003</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">100</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">2022007</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1004</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">100</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#676E95;">-- 缺省插入：</span></span>
<span class="line"><span style="color:#F78C6C;">insert</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> SC(Sno,Cno)</span><span style="color:#F78C6C;">values</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2022003</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">1002</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span></code></pre></div><blockquote><p>运行代码后，若显示“影响行数”是所加入数据的个数时就说明加入成功了。</p></blockquote><p><img src="/frontend-blog/assets/image-20220927092251124.ee3d26ec.png" alt="image-20220927092251124"></p><p><strong>带子查询</strong></p><blockquote><ol><li><p>将<em>查询结果</em>存到一个已经存在的一个表中：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">insert</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> 表名 </span><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> ... </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> ... </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> ...;</span></span>
<span class="line"></span></code></pre></div></li><li><p>将查询结果存到一个不存在的一个表中：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> avgTable </span><span style="color:#F78C6C;">as</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> ... </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> ... </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> ...;</span></span>
<span class="line"></span></code></pre></div></li></ol></blockquote><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">insert</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> avgTable ;</span></span>
<span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> avgTable </span><span style="color:#F78C6C;">as</span></span>
<span class="line"><span style="color:#A6ACCD;">elect Sno学号，</span><span style="color:#82AAFF;">avg</span><span style="color:#A6ACCD;">(Grade)平均成绩</span></span>
<span class="line"><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> SC</span></span>
<span class="line"><span style="color:#F78C6C;">group by</span><span style="color:#A6ACCD;"> Sno;</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> avgTable;</span></span>
<span class="line"></span></code></pre></div><h3 id="修改数据" tabindex="-1">修改数据 <a class="header-anchor" href="#修改数据" aria-hidden="true">#</a></h3><blockquote><p>格式：<code>update 数据表 set 某数据修改方法 where 条件</code>；</p><p>当数据修改后不满足约束时会被阻止🚫</p></blockquote><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#676E95;">-- 数据赋值固定值</span></span>
<span class="line"><span style="color:#F78C6C;">update</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> CCname </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">?</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">, Cpno </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">?</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">, CCrredit </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">?</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Cno </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">?</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#676E95;">-- 数据自身变化</span></span>
<span class="line"><span style="color:#F78C6C;">update</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> Sage Sage</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Ssex</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">女</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><p><strong>带子查询</strong></p><blockquote><p>将查询结果存到一个已经存在的一个表中：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">update</span><span style="color:#A6ACCD;"> SC</span></span>
<span class="line"><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> Grade Grade </span><span style="color:#89DDFF;">+</span><span style="color:#F78C6C;">5</span></span>
<span class="line"><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sno </span><span style="color:#F78C6C;">in</span><span style="color:#A6ACCD;"> (</span><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> Sno </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sdept </span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ne</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">).</span></span>
<span class="line"></span></code></pre></div></blockquote><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#676E95;">-- 将ne系所有学生的成绩加5分</span></span>
<span class="line"><span style="color:#F78C6C;">update</span><span style="color:#A6ACCD;"> SC</span></span>
<span class="line"><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> Grade Grade </span><span style="color:#89DDFF;">+</span><span style="color:#F78C6C;">5</span></span>
<span class="line"><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sno </span><span style="color:#F78C6C;">in</span><span style="color:#A6ACCD;"> (</span><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> Sno </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sdept </span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ne</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">).</span></span>
<span class="line"><span style="color:#F78C6C;">update</span><span style="color:#A6ACCD;"> SC,Student</span></span>
<span class="line"><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> Grade Grade</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">5</span></span>
<span class="line"><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Student.Sno SC.Sno </span><span style="color:#F78C6C;">and</span><span style="color:#A6ACCD;"> Sdept </span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ne</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><h3 id="删除数据" tabindex="-1">删除数据 <a class="header-anchor" href="#删除数据" aria-hidden="true">#</a></h3><blockquote><p>格式：<code>delete from 数据表 where 删除条件;</code></p><p><code>truncate</code>比<code>delete</code>执行速度要快，但<code>truncate</code>==不记录事务日志==，也==不触发触发器==。</p><p>一般推荐<code>delete</code>来清空数据表的所有数据。</p></blockquote><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">delete</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> SC </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Grade </span><span style="color:#F78C6C;">60</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#676E95;">-- 删除表中的所有数据</span></span>
<span class="line"><span style="color:#676E95;">-- 方法1</span></span>
<span class="line"><span style="color:#F78C6C;">delete</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> SC;</span></span>
<span class="line"><span style="color:#676E95;">-- 方法2</span></span>
<span class="line"><span style="color:#F78C6C;">truncate</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> SC;</span></span>
<span class="line"><span style="color:#676E95;">-- 删除表</span></span>
<span class="line"><span style="color:#F78C6C;">drop</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> SC;</span></span>
<span class="line"></span></code></pre></div><h2 id="数据表查询" tabindex="-1">数据表查询 <a class="header-anchor" href="#数据表查询" aria-hidden="true">#</a></h2><h3 id="单表查询" tabindex="-1">单表查询 <a class="header-anchor" href="#单表查询" aria-hidden="true">#</a></h3><h4 id="总览" tabindex="-1">总览 <a class="header-anchor" href="#总览" aria-hidden="true">#</a></h4><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;">...</span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;">...</span></span>
<span class="line"><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;">...</span></span>
<span class="line"><span style="color:#F78C6C;">group by</span><span style="color:#A6ACCD;">...</span></span>
<span class="line"><span style="color:#F78C6C;">having</span><span style="color:#A6ACCD;">...</span></span>
<span class="line"><span style="color:#F78C6C;">order by</span><span style="color:#A6ACCD;">...</span></span>
<span class="line"><span style="color:#F78C6C;">limit</span><span style="color:#A6ACCD;">...</span></span>
<span class="line"></span></code></pre></div><table><thead><tr><th>子句</th><th>作用</th></tr></thead><tbody><tr><td>select</td><td>指定从数起表中查询哪些属性列，属性列之间用迎号隔开</td></tr><tr><td>from</td><td>指定查询的改据源，可以是一个或多个数据表，表之间用逗号隔开</td></tr><tr><td>where</td><td>指定查询溶透条件</td></tr><tr><td>group by</td><td>将查询结果按照指定的列进行分组</td></tr><tr><td>having</td><td>对分组后的结果进行端透；</td></tr><tr><td>order by</td><td>对查询结果按指定的列进行排序。<br>ASC表示升序，DESC表示降序</td></tr><tr><td>limit</td><td>限制查询结果的行数</td></tr></tbody></table><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#676E95;">-- 案例</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">Name</span><span style="color:#A6ACCD;">,Salary </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> tb_emp;</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> tb_emp </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> DeptId </span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">301</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">and</span><span style="color:#A6ACCD;"> salary </span><span style="color:#89DDFF;">&gt;</span><span style="color:#F78C6C;">3000</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> tb_score </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> class_id </span><span style="color:#F78C6C;">in</span><span style="color:#A6ACCD;"> (</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">order by</span><span style="color:#A6ACCD;"> score </span><span style="color:#F78C6C;">desc</span><span style="color:#A6ACCD;">; </span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> tb_class </span><span style="color:#F78C6C;">group by</span><span style="color:#A6ACCD;"> class_id;</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> tb_score </span><span style="color:#F78C6C;">order by</span><span style="color:#A6ACCD;"> score </span><span style="color:#F78C6C;">desc</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">limit</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">,</span><span style="color:#F78C6C;">4</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><h4 id="基本查询" tabindex="-1">基本查询 <a class="header-anchor" href="#基本查询" aria-hidden="true">#</a></h4><blockquote><ol><li><p>SELECT 基本语法规则为： <code>SELECT 字段名 FROM 表名;</code> 。</p></li><li><p>从表中选择几个字段： <code>SELECT 字段名1，字段名2，...,字段名n FROM 表名;</code> 。</p></li><li><p>选择表中所有字段：<code>SELECT * FROM 表名;</code> 。</p></li><li><p>取别名：<code>SELECT 字段名1 as 别名1，字段名2 as 别名2，...,字段名n as 别名n FROM 表名;</code> ；</p><p>或者<code>SELECT 字段名1 别名1，字段名2 别名2，...,字段名n 别名n FROM 表名;</code> ，可以不写as。</p></li><li><p>用distinct关键字去重：<code>SELECT distinct 字段名 FROM 表名;</code></p></li></ol></blockquote><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">Name</span><span style="color:#A6ACCD;">,Salary </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> tb_emp;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> tb_emp;</span></span>
<span class="line"></span></code></pre></div><h4 id="限制范围" tabindex="-1">限制范围 <a class="header-anchor" href="#限制范围" aria-hidden="true">#</a></h4><blockquote><p>我们会在where子句里面编写我们的筛选条件。</p><ol><li><p>用<code>in</code>,<code>not in</code> 限定在一个或多个可能取值内的数据</p></li><li><p>用<code>between ... and ...</code>和 <code>not between ... and ...</code>限定在某一数值范围内符合条件的数据</p><p>可以等于边界值</p></li><li><p>用<code>and</code>、<code>or</code>、<code>not</code>来形成复合的筛选条件。用<code>&gt;</code>,<code>&lt;</code>,<code>&gt;=</code>,<code>&lt;=</code>,<code>=</code>,<code>!=</code>（<code>&lt;&gt;</code>）来限制数值或元素范围</p><p>其中重要级：<em>not &gt; and &gt; or</em></p></li><li><p>用<code>is null</code>，<code>is not null</code>筛选某数据项==是否为空值==的元组</p></li><li><p>用<code>any</code>表示在一个或多个可能取值内的数据的任意一个数据，<code>=any</code>与<code>in</code>等价，</p><p>用<code>all</code>表示在一个或多个可能取值内的数据的所有数据，<code>!=all</code>与<code>not in</code>等价，</p></li></ol></blockquote><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sdept </span><span style="color:#F78C6C;">in</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">cs</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ne</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student</span></span>
<span class="line"><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sdept </span><span style="color:#F78C6C;">not</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">in</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">cs</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ne</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#676E95;">-- 在某范围内</span></span>
<span class="line"><span style="color:#676E95;">--  SELECT 字段名 FROM 表名 WHERE 字段名 BETWEEN n1 AND n2;</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">Name</span><span style="color:#A6ACCD;">,Salary </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> tb_emp </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Salary </span><span style="color:#F78C6C;">BETWEEN</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3000</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">and</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">5000</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#676E95;">-- 无效筛选条件，但能运行，前者相当于还是选全部数据，后者不会筛选任何数据数据</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">!=</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#676E95;">-- SQL注入常用伎俩</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> users</span></span>
<span class="line"><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> userName </span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">fhdajf</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F78C6C;">and</span><span style="color:#A6ACCD;"> userPwd </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">or</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">1</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">1</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> users</span></span>
<span class="line"><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> userName </span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">1</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F78C6C;">or</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">-- &#39;and userPwd =&#39;fdlfldafladkfd&#39;;</span></span>
<span class="line"><span style="color:#676E95;">-- 判断空值is null,,is not null</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Course </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Cpno </span><span style="color:#F78C6C;">null</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Course </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Cpno </span><span style="color:#F78C6C;">is</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">null</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Course </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Cpno </span><span style="color:#F78C6C;">is</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">not</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">null</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><h4 id="模糊查询" tabindex="-1">模糊查询 <a class="header-anchor" href="#模糊查询" aria-hidden="true">#</a></h4><p><strong>通配符</strong></p><blockquote><ol><li><code>_</code>：1个任意的字符</li><li><code>%</code>：表示0个或多个任意的字符</li></ol><p>用<code>like</code>和<code>not like</code>来匹配指定模式</p></blockquote><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#676E95;">-- 只匹配&#39;王%&#39;</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sname</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">王%</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">；</span></span>
<span class="line"><span style="color:#676E95;">-- 查询所有姓王的同学</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sname </span><span style="color:#F78C6C;">like</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">王%</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">；</span></span>
<span class="line"><span style="color:#676E95;">-- 查询所有不姓王的同学</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sname </span><span style="color:#F78C6C;">not</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">like</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">%</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#676E95;">-- 查询所有姓王且全名只要两个字的同学</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sname </span><span style="color:#F78C6C;">like</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">王_</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#676E95;">-- 查询姓王或刘的同学</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sname </span><span style="color:#F78C6C;">like</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">王%</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">or</span><span style="color:#A6ACCD;"> Sname </span><span style="color:#F78C6C;">like</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">刘%</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><p><strong>正则表达式</strong></p><p>关于正则表达式的内容，烦请参照<a href="https://regexlearn.com/zh-cn/cheatsheet" target="_blank" rel="noreferrer">正则表达式速查表</a>，此处不再赘述。</p><img src="/frontend-blog/assets/image-20220930094757062.dc1d4f5b.png" alt="image-20220930094757062" style="zoom:50%;"><p>用<code>regexp &quot;正则表达式匹配模式&quot;</code>关键字来匹配指定的模式</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#676E95;">-- 查询所有姓王的同学</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sname regexp</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">^王</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">；</span></span>
<span class="line"><span style="color:#676E95;">-- 一查询所有不姓王的同学</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sname regexp</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">^[^王]</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#676E95;">-- 查询姓王或刘的同学</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sname regexp </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">^[王刘]</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><h4 id="查询结果排序" tabindex="-1">查询结果排序 <a class="header-anchor" href="#查询结果排序" aria-hidden="true">#</a></h4><blockquote><p>关键字：<code>order by</code></p><p>按照第某列排序：<code>order by &lt;数字&gt;</code></p><p>完整格式：<code>order by 字段1 asc|desc, 字段2 asc|desc ,..., 字段n asc|desc</code></p><p>以先出现的字段排序为主，以之后出现的字段的排序为辅。</p><p>每个指定字段默认是升序，可以指定desc使得排序为降序。</p></blockquote><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#676E95;">-- 查询选修了1001号课程的学生，查询结果按成绩降序排列</span></span>
<span class="line"></span></code></pre></div><h4 id="查询结果限制" tabindex="-1">查询结果限制 <a class="header-anchor" href="#查询结果限制" aria-hidden="true">#</a></h4><blockquote><p>关键字：limit</p><p>完整格式：<code>limit 初值,限制长度</code>，初值以0开始</p><p>限制查询结果的行数：分页查询</p></blockquote><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Course</span></span>
<span class="line"><span style="color:#F78C6C;">limit</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">,</span><span style="color:#F78C6C;">4</span><span style="color:#A6ACCD;">; </span><span style="color:#676E95;">-- 从第3条记录开始，取4条记录</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Course</span></span>
<span class="line"><span style="color:#F78C6C;">limit</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">,</span><span style="color:#F78C6C;">4</span><span style="color:#A6ACCD;">; </span><span style="color:#676E95;">-- 从第1条记录开始，取4条记录</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Course</span></span>
<span class="line"><span style="color:#F78C6C;">limit</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">4</span><span style="color:#A6ACCD;">;</span><span style="color:#676E95;">-- 从第1条记录开始，取4条记录</span></span>
<span class="line"></span></code></pre></div><blockquote><p>由于限制查询<code>limit</code>是后于排序查询<code>order by</code>执行</p><p>所以在排序、限制都存在的时候，限制处理的是排序后的记录。</p><hr><p>==例子（头歌）==：使用<code>LIMIT</code>关键字查询班级中第<code>2</code>名到第<code>5</code>名的学生信息，并根据学生成绩进行降序排序。</p><p>原表的情况：乱序，<img src="/frontend-blog/assets/image-20220930164456810.d2de76f9.png" alt="image-20220930164456810" style="zoom:43%;">；输出要求：按成绩降序，限制选择：<img src="/frontend-blog/assets/image-20220930164657250.c9220165.png" alt="image-20220930164657250" style="zoom:80%;">，答案如下：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> tb_score </span><span style="color:#F78C6C;">order by</span><span style="color:#A6ACCD;"> score </span><span style="color:#F78C6C;">desc</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">limit</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">,</span><span style="color:#F78C6C;">4</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div></blockquote><h4 id="查询分组" tabindex="-1">查询分组 <a class="header-anchor" href="#查询分组" aria-hidden="true">#</a></h4><blockquote><p>group by字段1,字段2，..</p></blockquote><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#676E95;">-- 查询每门课的选课人数</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> Cno, </span><span style="color:#82AAFF;">count</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">)</span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> sC</span></span>
<span class="line"><span style="color:#F78C6C;">group by</span><span style="color:#A6ACCD;"> Cno;</span></span>
<span class="line"><span style="color:#676E95;">-- 查询每个学生的学号及选课门数</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> Sno, </span><span style="color:#82AAFF;">count</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">）选课人数 </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> scgroup </span><span style="color:#F78C6C;">by</span><span style="color:#A6ACCD;"> Sno</span></span>
<span class="line"><span style="color:#676E95;">-- 查询每个学生的学号及选课门数</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> Sno, </span><span style="color:#82AAFF;">count</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">）选课人数 </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> scgroup </span><span style="color:#F78C6C;">by</span><span style="color:#A6ACCD;"> Sno</span></span>
<span class="line"><span style="color:#A6ACCD;">having选课人数</span><span style="color:#89DDFF;">&gt;</span><span style="color:#F78C6C;">2</span></span>
<span class="line"><span style="color:#676E95;">-- 比较where与having的区别</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> Cno, </span><span style="color:#82AAFF;">Count</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> sc</span></span>
<span class="line"><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Grade </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">60</span></span>
<span class="line"><span style="color:#F78C6C;">group by</span><span style="color:#A6ACCD;"> Cno</span></span>
<span class="line"><span style="color:#F78C6C;">having</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">count</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">) </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><p><strong>where与having的区别</strong></p><blockquote><p>where：是对整个原始表做筛选，会先于<code>group by</code>子句被执行</p><p>having：是对分组（group by）后的结果做筛选，会后于<code>group by</code>子句被执行</p></blockquote><h3 id="连接查询" tabindex="-1">连接查询 <a class="header-anchor" href="#连接查询" aria-hidden="true">#</a></h3><h4 id="笛卡尔积" tabindex="-1">笛卡尔积 <a class="header-anchor" href="#笛卡尔积" aria-hidden="true">#</a></h4><blockquote><p>格式：<code>select 表1.字段1, 表2.字段2 from 表1, 表2;</code></p><p>或者<code>select 表1.字段1, 表2.字段2 from 表1 cross join 表2;</code></p><p>如果表名很长，可以直接为表取别名。</p><p>其格式为：<code>select 表别名1.字段1, 表别名2.字段2 from 表1 as 表别名1, 表2 as 表别名2;</code></p></blockquote><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#676E95;">-- 将两个表所有字段拼到一起，所有内容做笛卡尔积。</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> Student.</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> ,SC.</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student, SC;</span></span>
<span class="line"></span></code></pre></div><h4 id="等值连接" tabindex="-1">等值连接 <a class="header-anchor" href="#等值连接" aria-hidden="true">#</a></h4><blockquote><p>由于笛卡尔积的原理，经过笛卡尔积处理后的数据通常不合理。</p><p>等值连接，重点在等值，不能遗漏。一般要用到n个表就需要n-1个等值连接。</p><p>格式：<code>select Student.*, SC.*from Student, SC where Student.Sno = sc.Sno;</code></p></blockquote><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#676E95;">-- 查询选修了课程的学生的学号和姓名</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> Student.</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> , SC.</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student,SC</span></span>
<span class="line"><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Student.Sno </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> sc.Sno;</span></span>
<span class="line"><span style="color:#676E95;">-- 查询选修了课程的学生的学号和姓名</span></span>
<span class="line"><span style="color:#F78C6C;">select distinct</span><span style="color:#A6ACCD;"> Student.Sno, Snamefrom Student, SC</span></span>
<span class="line"><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Student.Sno </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> SC.Sno</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">-- 查询选修了1号课程的学生的学号和姓名</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> Student.Sno, Sname</span></span>
<span class="line"><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student, sc</span></span>
<span class="line"><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Student.Sno </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> SC.Sno</span></span>
<span class="line"><span style="color:#F78C6C;">and</span><span style="color:#A6ACCD;"> Cno </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">1</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span><span style="color:#676E95;">-- 等值连接!等值连接!等值连接!</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">-- 更复杂的例子</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> student.Sno,Sname,Cname,Grade </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> student,sc,course</span></span>
<span class="line"><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Cname </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">数据库</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">  </span><span style="color:#676E95;">-- 筛选条件</span></span>
<span class="line"><span style="color:#F78C6C;">and</span><span style="color:#A6ACCD;"> student.Sno </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> sc.Sno </span><span style="color:#F78C6C;">and</span><span style="color:#A6ACCD;"> course.Cno </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> sc.Cno;  </span><span style="color:#676E95;">-- 等值条件</span></span>
<span class="line"></span></code></pre></div><p><img src="/frontend-blog/assets/image-20220930142912934.5f2da959.png" alt="image-20220930142912934"></p><h4 id="自连接" tabindex="-1">自连接 <a class="header-anchor" href="#自连接" aria-hidden="true">#</a></h4><blockquote><p>在这条件下，也就是当表和本身做连接时，有必要给同一个表取两个不同的别名。</p><p>格式：<code>select 别名1.字段1, 别名2.字段2 from 表名 别名1, 表名 别名2 where 别名1.字段1&#39; = 别名2.字段2&#39;;</code></p></blockquote><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#676E95;">-- 查询每门课的间接先修课</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> A.Cno,B.Cpno</span></span>
<span class="line"><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Course A,Course B</span></span>
<span class="line"><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> A.Cpno </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> B.Cno;</span></span>
<span class="line"></span></code></pre></div><p>效果如下：</p><img src="/frontend-blog/assets/image-20220930192401787.15968b23.png" alt="image-20220930192401787" style="zoom:67%;"><h4 id="内连接" tabindex="-1">内连接 <a class="header-anchor" href="#内连接" aria-hidden="true">#</a></h4><blockquote><p>关键字：<code>inner join</code></p><p>格式：<code>select ..from 表1 inner join 表2 on 条件表达式;</code></p><p>执行过程：执行两个表链接，</p></blockquote><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;">..from表1 inner join表2on条件表达式</span></span>
<span class="line"></span></code></pre></div><h4 id="外连接" tabindex="-1">外连接 <a class="header-anchor" href="#外连接" aria-hidden="true">#</a></h4><blockquote><p>关键字：<code>out join</code>；分类：<em>左外连接</em>：<code>left (out) join</code><em>右外连接</em>：<code>right (out) join</code></p><p>格式：<code>select ..from 表1 out join 表2 on 条件表达式;</code></p><p>左外连接：在内连接的基础上，还包含表1中所有不符合条件的数据行，并在其中的表2列填写 NULL；</p><p>右外连接：在内连接的基础上，还包含表2中所有不符合条件的数据行，并在其中的表1列填写 NULL。</p></blockquote><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> Student.Sno,Sname,Cno,Grade </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">inner join</span><span style="color:#A6ACCD;"> SC</span></span>
<span class="line"><span style="color:#F78C6C;">on</span><span style="color:#A6ACCD;"> Student.Sno SC.Sno </span><span style="color:#F78C6C;">and</span><span style="color:#A6ACCD;"> Cno </span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> Student.Sno,Sname,Cno,Grade </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">left join</span><span style="color:#A6ACCD;"> SC</span></span>
<span class="line"><span style="color:#F78C6C;">on</span><span style="color:#A6ACCD;"> Student.Sno SC.Sno </span><span style="color:#F78C6C;">and</span><span style="color:#A6ACCD;"> Cno </span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> Student.Sno,Sname,Cno,Grade </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> SC </span><span style="color:#F78C6C;">right join</span><span style="color:#A6ACCD;"> Student</span></span>
<span class="line"><span style="color:#F78C6C;">on</span><span style="color:#A6ACCD;"> Student.Sno SC.Sno </span><span style="color:#F78C6C;">and</span><span style="color:#A6ACCD;"> Cno </span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span></code></pre></div><h3 id="嵌套查询" tabindex="-1">嵌套查询 <a class="header-anchor" href="#嵌套查询" aria-hidden="true">#</a></h3><blockquote><p>顾名思义，就是在一个查询结果的基础上再做另一个查询。</p><p>格式是：<code>select ..from...where ....(select ...from ...where...)</code></p><p>子查询返回一个值时就可以用<code>=</code>或<code>in</code>连接：<code>... where 字段1 = (子查询)</code>或<code>... where 字段1 in (子查询)</code></p><p>子查询返回一个值时就只能用<code>in</code>连接：<code>... where 字段1 in (子查询)</code></p></blockquote><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#676E95;">-- 查询“王敏”同学的选课信息</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> SC</span></span>
<span class="line"><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sno</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> Sno </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sname</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">王敏</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)；</span></span>
<span class="line"><span style="color:#676E95;">-- 查询选修了2号课程的学生姓名</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> Sname </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student</span></span>
<span class="line"><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sno </span><span style="color:#F78C6C;">in</span><span style="color:#A6ACCD;"> (</span><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> Sno </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> SC </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Cno </span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#676E95;">-- 无关子查询</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> Sname </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student</span></span>
<span class="line"><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sno </span><span style="color:#F78C6C;">in</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2022001</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2022002</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span></code></pre></div><blockquote><p>关键字<code>any</code>和<code>all</code>在这经常用，用作返回结果的判断（见<a href="#%E9%99%90%E5%88%B6%E8%8C%83%E5%9B%B4">限制范围</a>）</p></blockquote><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#A6ACCD;">#</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">.使用 ALL 关键字进行查询</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> position,salary </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> tb_salary</span></span>
<span class="line"><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> salary</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">all(</span><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> salary </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> tb_salary </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> position </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Java</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">#</span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">.使用 ANY 关键字进行查询</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> position,salary </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> tb_salary</span></span>
<span class="line"><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> salary</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">any(</span><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> salary </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> tb_salary </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> position </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Java</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">#</span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;">.使用 </span><span style="color:#F78C6C;">IN</span><span style="color:#A6ACCD;"> 关键字进行查询</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> position,salary </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> tb_salary</span></span>
<span class="line"><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> salary </span><span style="color:#F78C6C;">in</span><span style="color:#A6ACCD;"> (</span><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> salary </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> tb_salary </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> position </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Java</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span></code></pre></div><blockquote><p><code>exists</code>运算符用于判断查询子句是否有记录，如果有一条或多条记录存在返回 True，否则返回 False。</p><p>格式：<code>select ...from ..where exists (select from ... where...)</code></p></blockquote><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#676E95;">-- 查询选修了2号课程的学生姓名</span></span>
<span class="line"><span style="color:#676E95;">-- 相关子查询</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> Sname</span></span>
<span class="line"><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student</span></span>
<span class="line"><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">exists</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> SC</span></span>
<span class="line"><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> SC.Sno Student.Sno </span><span style="color:#F78C6C;">and</span><span style="color:#A6ACCD;"> Cno </span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#676E95;">-- 这样写执行结果是错误的</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> Sname</span></span>
<span class="line"><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student</span></span>
<span class="line"><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">exists</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> SC </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Cno </span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#676E95;">-- 查询没有选修2号课程的学生姓名</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> Sname</span></span>
<span class="line"><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student</span></span>
<span class="line"><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">not</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">exists</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> SC</span></span>
<span class="line"><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> SC.Sno</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">Student.Sno </span><span style="color:#F78C6C;">and</span><span style="color:#A6ACCD;"> Cno </span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span></code></pre></div><p>带子查询更新操作</p><h3 id="集合查询" tabindex="-1">集合查询 <a class="header-anchor" href="#集合查询" aria-hidden="true">#</a></h3><blockquote><p>并：union，union all</p><p>交：（SQL server，oracle）： intersect</p><p>补：（SQL server）：except；（oracle ） minus</p></blockquote><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sdept </span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">CS</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F78C6C;">union all</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sage </span><span style="color:#F78C6C;">18</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><h2 id="sql编程" tabindex="-1">SQL编程 <a class="header-anchor" href="#sql编程" aria-hidden="true">#</a></h2><h3 id="常量与变量" tabindex="-1">常量与变量 <a class="header-anchor" href="#常量与变量" aria-hidden="true">#</a></h3><ol><li><p>常量</p><p>字符串类型的常量、日期时间类型的常量要用单引号括起来。</p></li></ol><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Chinese Dream</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2022-10-01</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span></code></pre></div><p>NULL值</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">NULL</span></span>
<span class="line"></span></code></pre></div><ol start="2"><li>变量</li></ol><p>MySQL中的变量分为两种：系统变量、自定义变量</p><p>==系统变量==由系统定义，分为：<em>全局变量</em>和<em>会话变量</em>。 ==自定义变量==由用户自己定义的，分为：<em>用户变量</em>和<em>局部变量</em>。</p><ul><li><p>全局变量</p><blockquote><p>全局变量的值影响整个MySQL服务器。 全局变量的值在MySQL启动时由服务器自动初始化为默认值。</p></blockquote><p><strong>作用域</strong>：MySQL服务器的整个生命周期。</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#676E95;">-- 查看全局变量</span></span>
<span class="line"><span style="color:#A6ACCD;">show </span><span style="color:#F78C6C;">global</span><span style="color:#A6ACCD;"> variables;</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> @@</span><span style="color:#F78C6C;">global</span><span style="color:#A6ACCD;">.auto_increment_increment;</span></span>
<span class="line"><span style="color:#A6ACCD;">show </span><span style="color:#F78C6C;">global</span><span style="color:#A6ACCD;"> variables </span><span style="color:#F78C6C;">like</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">auto%</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">修改全局变量</span></span>
<span class="line"><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">global</span><span style="color:#A6ACCD;"> auto_increment_increment </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> @@</span><span style="color:#F78C6C;">global</span><span style="color:#A6ACCD;">.auto_increment_increment </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><p>修改配置文件my.ini,重启服务。</p><p>赋值的操作符：<code>=</code>或<code>:=</code>。 作用域：针对于当前会话（连接）有效，同于会话变量的作用域，应用在任何地方，也就是<code>begin...end</code>里面或<code>begin...end</code>外边。</p><ul><li>声明变量并初始化</li></ul><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">SET</span><span style="color:#A6ACCD;"> @用户变量名 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> 值;</span><span style="color:#F78C6C;">SET</span><span style="color:#A6ACCD;"> @用户变量名 :</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> 值;</span></span>
<span class="line"></span></code></pre></div></li><li><p>会话变量</p><blockquote><p>在每次建立一个连接时，MySQL服务器将当前所有的全局变量的值复制一份给会话变量。</p></blockquote><p><strong>作用域</strong>：仅限于当前会话。每个客户端连接中的会话变量是相互独立的。</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#676E95;">-- 查看会话变量</span></span>
<span class="line"><span style="color:#A6ACCD;">show </span><span style="color:#F78C6C;">session</span><span style="color:#A6ACCD;"> variables;</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> @@</span><span style="color:#F78C6C;">session</span><span style="color:#A6ACCD;">.auto_increment_increment;</span></span>
<span class="line"><span style="color:#A6ACCD;">show </span><span style="color:#F78C6C;">session</span><span style="color:#A6ACCD;"> variables </span><span style="color:#F78C6C;">like</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">auto%</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#676E95;">-- 修改会话变量</span></span>
<span class="line"><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">session</span><span style="color:#A6ACCD;"> auto_increment_increment </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> @@</span><span style="color:#F78C6C;">session</span><span style="color:#A6ACCD;">.auto_increment_increment </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div></li><li><p>局部变量</p><blockquote><p>一般==用于begin...end语句块==中，作用域仅限于该语句块。 beign...end代码块,以及局部变量只能==用在函数、存储过程、游标、触发器中==。</p></blockquote><p>使用declare关键字进行声明。</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#676E95;">-- 声明局部变量</span></span>
<span class="line"><span style="color:#F78C6C;">declare</span><span style="color:#A6ACCD;"> 变量名数据类型（长度）；</span></span>
<span class="line"><span style="color:#F78C6C;">declare</span><span style="color:#A6ACCD;"> 变量名数据类型（长度）default初始值；</span></span>
<span class="line"><span style="color:#676E95;">-- 为局部变量赋值</span></span>
<span class="line"><span style="color:#A6ACCD;">set局部变量1</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">值1，局部变量2</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">值2，…</span></span>
<span class="line"><span style="color:#A6ACCD;">select字段l,字段2，</span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> 局部变量l,局部变量2，.</span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;">..</span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;">.…</span></span>
<span class="line"></span></code></pre></div></li><li><p>用户变量</p></li></ul><h3 id="流程控制语句" tabindex="-1">流程控制语句 <a class="header-anchor" href="#流程控制语句" aria-hidden="true">#</a></h3><p>流程控制语句要放在存储过程、存储函数、游标、触发器的内部。</p><ol><li><p><code>if</code></p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">if</span><span style="color:#A6ACCD;">...</span><span style="color:#F78C6C;">then</span><span style="color:#A6ACCD;">...</span></span>
<span class="line"><span style="color:#A6ACCD;">elseif ...</span><span style="color:#F78C6C;">then</span><span style="color:#A6ACCD;">...</span></span>
<span class="line"><span style="color:#F78C6C;">else</span><span style="color:#A6ACCD;">...</span></span>
<span class="line"><span style="color:#F78C6C;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">if</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div></li><li><p><code>while</code></p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">while</span><span style="color:#A6ACCD;">...#继续循环条件</span></span>
<span class="line"><span style="color:#A6ACCD;">do</span></span>
<span class="line"><span style="color:#A6ACCD;"># 循环体</span></span>
<span class="line"><span style="color:#F78C6C;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">while</span></span>
<span class="line"></span></code></pre></div></li><li><p><code>repeat</code></p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">repeat</span></span>
<span class="line"><span style="color:#A6ACCD;">#循环体</span></span>
<span class="line"><span style="color:#A6ACCD;">until ...#终止循环条件</span></span>
<span class="line"><span style="color:#F78C6C;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">repeat</span></span>
<span class="line"></span></code></pre></div></li><li><p><code>loop</code></p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">loop</span></span>
<span class="line"><span style="color:#A6ACCD;">#循环体</span></span>
<span class="line"><span style="color:#F78C6C;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">loop</span></span>
<span class="line"></span></code></pre></div></li><li><p><code>leave</code></p><blockquote><p>用于跳出循环，类似于C语言中的<code>break</code>;</p></blockquote></li><li><p><code>iterate</code></p><blockquote><p>用于退出本次循环，类以于C语言中的<code>continue</code></p></blockquote></li></ol><p>eg:<code>1+2+..+100</code></p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">procedure</span><span style="color:#A6ACCD;"> usp_Sum(n </span><span style="color:#F78C6C;">int</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#F78C6C;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">declare</span><span style="color:#A6ACCD;"> i,</span><span style="color:#82AAFF;">sum</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">int</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> i</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">,</span><span style="color:#82AAFF;">sum</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">while</span><span style="color:#A6ACCD;"> i</span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">n do</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> i</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">i</span><span style="color:#89DDFF;">+</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">sum</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">sum</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;">i;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F78C6C;">while</span><span style="color:#A6ACCD;"> i</span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">n do</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> i</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">i</span><span style="color:#89DDFF;">+</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">sum</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">sum</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;">i;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F78C6C;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">while</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">concat</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">1+2+..+100=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span><span style="color:#82AAFF;">sum</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F78C6C;">end</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">while</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">concat</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">1+2+..+100=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span><span style="color:#82AAFF;">sum</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">end</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">调用</span></span>
<span class="line"><span style="color:#F78C6C;">call</span><span style="color:#A6ACCD;"> usp_Sum(</span><span style="color:#F78C6C;">100</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span></code></pre></div><p>7、<code>case</code>两种用法： (1)</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">case</span><span style="color:#A6ACCD;"> case_value</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">when</span><span style="color:#A6ACCD;"> 值1 </span><span style="color:#F78C6C;">then</span><span style="color:#A6ACCD;"> 语句1</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">when</span><span style="color:#A6ACCD;"> 值2 </span><span style="color:#F78C6C;">then</span><span style="color:#A6ACCD;"> 语句2</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">else</span><span style="color:#A6ACCD;">...</span></span>
<span class="line"><span style="color:#F78C6C;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">case</span></span>
<span class="line"></span></code></pre></div><p>(2)</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">case</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">when</span><span style="color:#A6ACCD;"> 条件1 </span><span style="color:#F78C6C;">then</span><span style="color:#A6ACCD;"> 语句l;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">when</span><span style="color:#A6ACCD;"> 条件2 </span><span style="color:#F78C6C;">then</span><span style="color:#A6ACCD;"> 语句2；</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">when</span><span style="color:#A6ACCD;"> 条件n </span><span style="color:#F78C6C;">then</span><span style="color:#A6ACCD;"> 语句n;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">else</span><span style="color:#A6ACCD;">....</span></span>
<span class="line"><span style="color:#F78C6C;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">case</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">when</span><span style="color:#A6ACCD;"> 条件n </span><span style="color:#F78C6C;">then</span><span style="color:#A6ACCD;"> 语句n;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">else</span><span style="color:#A6ACCD;">...</span></span>
<span class="line"><span style="color:#F78C6C;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">case</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><p>思考+20 -输入学生的学号和课程号，输出该生该门课的等级(ABCED)</p><h3 id="函数" tabindex="-1">函数 <a class="header-anchor" href="#函数" aria-hidden="true">#</a></h3><blockquote><p>下面我们要接触是用户自定义函数。</p></blockquote><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#A6ACCD;">delimiter </span><span style="color:#89DDFF;">//</span><span style="color:#A6ACCD;">　　#如果函数体只有一条语句, begin和end可以省略, 同时delimiter也可以省略</span></span>
<span class="line"><span style="color:#A6ACCD;">　　</span><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">函数名</span><span style="color:#A6ACCD;">(形参列表) </span><span style="color:#F78C6C;">returns</span><span style="color:#A6ACCD;"> 返回类型　　#注意是retruns</span></span>
<span class="line"><span style="color:#A6ACCD;">　　</span><span style="color:#F78C6C;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">　　　　函数体　　　　#函数内定义的变量如：</span><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> @x </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">; 变量x为全局变量，在函数外面也可以使用</span></span>
<span class="line"><span style="color:#A6ACCD;">　　　　返回值</span></span>
<span class="line"><span style="color:#A6ACCD;">　　</span><span style="color:#F78C6C;">end</span></span>
<span class="line"><span style="color:#A6ACCD;">　　</span><span style="color:#89DDFF;">//</span></span>
<span class="line"><span style="color:#A6ACCD;">delimiter ;</span></span>
<span class="line"></span></code></pre></div><p>关于函数体:</p><ol><li>函数体由合法的<code>SQL</code>语句构成；</li><li>函数体可以是简单的<code>SELECT</code>或<code>INSERT</code>语句；</li><li>函数体如果为复合结构则使用<code>begin...end</code>语句；</li><li>复合结构可以包含声明，循环，控制结构。</li></ol><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#676E95;">-- 输入：学号</span></span>
<span class="line"><span style="color:#676E95;">-- 返回值：平均分</span></span>
<span class="line"><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">global</span><span style="color:#A6ACCD;"> log_bin_trust_function_creators </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">true;</span></span>
<span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">function</span><span style="color:#A6ACCD;"> fn_GetAvgGrade(vSno </span><span style="color:#F78C6C;">int</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">returns</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">int</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;">-- 函数的返回值的数据类型是int</span></span>
<span class="line"><span style="color:#F78C6C;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">declare</span><span style="color:#A6ACCD;"> vGrade </span><span style="color:#F78C6C;">int</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">avg</span><span style="color:#A6ACCD;">(Grade)</span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> vGrade </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> SC </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sno vSno;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">return</span><span style="color:#A6ACCD;"> vGrade;</span></span>
<span class="line"><span style="color:#F78C6C;">end</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#676E95;">-- 调用</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> fn_GetAvgGrade(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2022001</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span></code></pre></div><h2 id="视图" tabindex="-1">视图 <a class="header-anchor" href="#视图" aria-hidden="true">#</a></h2><blockquote><p>1、什么是视图？</p><p>视图View是从一个或多个基本表或视图中导出的一个==虚表==。 视图中==不存放数据==的；数据是存放在基本表中的。 和基本表一样，对视图也可以执行增删改查操作。*对视图的操作，都会转换为对基本表的操作。*这叫<strong>视图消解</strong>。</p><p>2、为什么要使用视图？</p><p>(1)可以简化查询操作 (2)可以提高数据的安全性</p></blockquote><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> view 视图名</span></span>
<span class="line"><span style="color:#F78C6C;">as</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> ...;</span></span>
<span class="line"></span></code></pre></div><h3 id="创建视图" tabindex="-1">创建视图 <a class="header-anchor" href="#创建视图" aria-hidden="true">#</a></h3><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#A6ACCD;">#创建多表视图</span></span>
<span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> view v1</span></span>
<span class="line"><span style="color:#F78C6C;">as</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> student.Sno,student.Sname,course.Cname,sc.Grade</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> student </span><span style="color:#F78C6C;">INNER JOIN</span><span style="color:#A6ACCD;"> sc</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#F78C6C;">ON</span><span style="color:#A6ACCD;"> student.Sno sc.Sno </span><span style="color:#F78C6C;">INNER JOIN</span><span style="color:#A6ACCD;"> course </span><span style="color:#F78C6C;">ON</span><span style="color:#A6ACCD;"> sc.Cno course.Cno;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> student.Sno,student.Sname,course.Cname,sc.Grade</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> student </span><span style="color:#F78C6C;">INNER JOIN</span><span style="color:#A6ACCD;"> sc</span></span>
<span class="line"><span style="color:#F78C6C;">ON</span><span style="color:#A6ACCD;"> student.Sno sc.Sno </span><span style="color:#F78C6C;">INNER JOIN</span><span style="color:#A6ACCD;"> course </span><span style="color:#F78C6C;">ON</span><span style="color:#A6ACCD;"> sc.Cno course.Cno;</span></span>
<span class="line"><span style="color:#F78C6C;">and</span><span style="color:#A6ACCD;"> Cname</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">数据库</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> student.Sno,student.Sname,course.Cname,sc.Grade</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> student </span><span style="color:#F78C6C;">INNER JOIN</span><span style="color:#A6ACCD;"> sc</span></span>
<span class="line"><span style="color:#F78C6C;">ON</span><span style="color:#A6ACCD;"> student.Sno sc.Sno </span><span style="color:#F78C6C;">INNER JOIN</span><span style="color:#A6ACCD;"> course </span><span style="color:#F78C6C;">ON</span><span style="color:#A6ACCD;"> sc.Cno course.Cno</span></span>
<span class="line"><span style="color:#F78C6C;">and</span><span style="color:#A6ACCD;"> Grade </span><span style="color:#F78C6C;">60</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><h3 id="视图操作" tabindex="-1">视图操作 <a class="header-anchor" href="#视图操作" aria-hidden="true">#</a></h3><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#676E95;">-- 查询视图</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> v1;</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#89DDFF;">*</span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> vl </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Cname</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">数据库</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">；</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> v1 </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Grade </span><span style="color:#F78C6C;">60</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">-- 通过视图像基本表中插入数据</span></span>
<span class="line"><span style="color:#F78C6C;">insert</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> v2 </span><span style="color:#F78C6C;">values</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2021005</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">小吴</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">男</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span><span style="color:#F78C6C;">18</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">CS</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#89DDFF;">*</span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student;</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#89DDFF;">*</span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> v2;</span></span>
<span class="line"><span style="color:#F78C6C;">insert</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> v2 </span><span style="color:#F78C6C;">values</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2021006</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">小六</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">男</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span><span style="color:#F78C6C;">18</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">MA</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">-- 修改视图</span></span>
<span class="line"><span style="color:#F78C6C;">alter</span><span style="color:#A6ACCD;"> view v2</span></span>
<span class="line"><span style="color:#F78C6C;">as</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">select</span><span style="color:#89DDFF;">*</span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sdept</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">cs</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">with</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">check</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">option</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#89DDFF;"> </span><span style="color:#676E95;">--  查询视图和基本表</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">select</span><span style="color:#89DDFF;">*</span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> v2;</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">select</span><span style="color:#89DDFF;">*</span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student;</span></span>
<span class="line"><span style="color:#89DDFF;"> </span><span style="color:#676E95;">-- 通过视图向基本表中插入数据</span></span>
<span class="line"><span style="color:#F78C6C;">insert</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> v2 </span><span style="color:#F78C6C;">values</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2021007</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">小七</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">男</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span><span style="color:#F78C6C;">18</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">CS</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">insert</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> v2 </span><span style="color:#F78C6C;">values</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2021008</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">小八</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">男</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span><span style="color:#F78C6C;">18</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">MA</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span><span style="color:#676E95;">-- 	会提示错误</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">-- 	通过视图修改基本表</span></span>
<span class="line"><span style="color:#F78C6C;">update</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> Sage</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">18</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">update</span><span style="color:#A6ACCD;"> v2 </span><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> Sage</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">Sage</span><span style="color:#89DDFF;">+</span><span style="color:#F78C6C;">10</span><span style="color:#A6ACCD;">;</span><span style="color:#676E95;">-- 该语句会转化为：</span></span>
<span class="line"><span style="color:#F78C6C;">update</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> Sage</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">Sage</span><span style="color:#89DDFF;">+</span><span style="color:#F78C6C;">10</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sdept</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">cs</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">-- 修改视图:并不是所有视图都可以更新</span></span>
<span class="line"><span style="color:#676E95;">-- 创建一个视图：修改每个学生的学号和平均成绩</span></span>
<span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> view v3</span></span>
<span class="line"><span style="color:#F78C6C;">as</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> Sno,</span><span style="color:#82AAFF;">avg</span><span style="color:#A6ACCD;">(Grade) avgGrade </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> sc </span></span>
<span class="line"><span style="color:#F78C6C;">group by</span><span style="color:#A6ACCD;"> Sno;</span></span>
<span class="line"><span style="color:#676E95;">-- 查询视图</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> v3;</span></span>
<span class="line"><span style="color:#676E95;">-- 修改视图</span></span>
<span class="line"><span style="color:#F78C6C;">update</span><span style="color:#A6ACCD;"> v3 </span><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> avgGrade</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">80</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sno</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2022001</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> SC;</span></span>
<span class="line"></span></code></pre></div><blockquote><p>问：什么样的视图是可以更新的？什么样的视图是不可以更新的？</p><p>答: 一般的行列子集视图是可以更新的。视图不能更新有以下情况:</p><ol><li>视图的字段来自<em>字段表达式</em>或常数</li><li>视图的字段来自<em>聚集函数</em></li><li>视图的定义中含有<em>Group By子句</em></li><li>视图的定义中含有<em>DISTINCT</em>关键字</li><li>视图定义中有<em>嵌套查询</em></li></ol></blockquote><h2 id="索引" tabindex="-1">索引 <a class="header-anchor" href="#索引" aria-hidden="true">#</a></h2><blockquote><p><strong>什么是索引？</strong> 类似于书的目录。索引的创建和维护需要时间的。</p><p><strong>为什么使用索引？</strong> 提高数据的查询速度。可索引并非越多越好。</p></blockquote><p>索引的类型：</p><ol><li>普通索引和唯一索引</li><li>单列索引和组合索引</li></ol><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">index</span><span style="color:#A6ACCD;"> 索引名 </span><span style="color:#F78C6C;">on</span><span style="color:#A6ACCD;"> 表名 (字段名 </span><span style="color:#F78C6C;">asc</span><span style="color:#A6ACCD;">|</span><span style="color:#F78C6C;">desc</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">show </span><span style="color:#F78C6C;">index</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> 表名;</span></span>
<span class="line"><span style="color:#A6ACCD;">explain </span><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> ...;</span></span>
<span class="line"></span></code></pre></div><p><strong>如何使用索引？</strong></p><ol><li><p>方法1：在<code>create table</code>语句中指定索引列</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student;</span></span>
<span class="line"><span style="color:#676E95;">-- eg</span></span>
<span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> Books</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">    bklD </span><span style="color:#F78C6C;">char</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">7</span><span style="color:#A6ACCD;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">    bkName </span><span style="color:#F78C6C;">varchar</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">30</span><span style="color:#A6ACCD;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">    bkAuthor </span><span style="color:#F78C6C;">varchar</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">30</span><span style="color:#A6ACCD;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">    bkPrice </span><span style="color:#F78C6C;">int</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#A6ACCD;">#创建索引</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">index</span><span style="color:#A6ACCD;">(bkName)</span></span>
<span class="line"><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#676E95;">-- 查看Books表的定义</span></span>
<span class="line"><span style="color:#A6ACCD;">show </span><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> Books;</span></span>
<span class="line"><span style="color:#676E95;">-- 查看索引</span></span>
<span class="line"><span style="color:#A6ACCD;">show </span><span style="color:#F78C6C;">index</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Books;</span></span>
<span class="line"></span></code></pre></div></li><li><p>方法2：使用<code>alter table</code> 语句中创建索引</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> Books1</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">    bklD </span><span style="color:#F78C6C;">char</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">7</span><span style="color:#A6ACCD;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">    bkName </span><span style="color:#F78C6C;">varchar</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">30</span><span style="color:#A6ACCD;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">    bkAuthor </span><span style="color:#F78C6C;">varchar</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">30</span><span style="color:#A6ACCD;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">    bkPrice </span><span style="color:#F78C6C;">int</span></span>
<span class="line"><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">-- 查看索引</span></span>
<span class="line"><span style="color:#A6ACCD;">show </span><span style="color:#F78C6C;">index</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Books1;</span></span>
<span class="line"><span style="color:#F78C6C;">alter</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> Books1 </span><span style="color:#F78C6C;">add</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">index</span><span style="color:#A6ACCD;"> idx_bkName(bkName </span><span style="color:#F78C6C;">desc</span><span style="color:#A6ACCD;">);</span><span style="color:#676E95;">-- 普通索引</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">-- 删除索引</span></span>
<span class="line"><span style="color:#F78C6C;">drop</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">index</span><span style="color:#A6ACCD;"> idx_bkName </span><span style="color:#F78C6C;">on</span><span style="color:#A6ACCD;"> Books1;</span></span>
<span class="line"><span style="color:#F78C6C;">alter</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> Books1 </span><span style="color:#F78C6C;">add</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">unique</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">index</span><span style="color:#A6ACCD;"> idx_bkName(bkName </span><span style="color:#F78C6C;">desc</span><span style="color:#A6ACCD;">);</span><span style="color:#676E95;">-- 唯一索引</span></span>
<span class="line"><span style="color:#A6ACCD;">show </span><span style="color:#F78C6C;">index</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Books1;</span></span>
<span class="line"></span></code></pre></div></li><li><p>方法3：使用<code>create index</code>语句中创建索引</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> [unique] </span><span style="color:#F78C6C;">index</span><span style="color:#A6ACCD;"> 索引名 </span><span style="color:#F78C6C;">on</span><span style="color:#A6ACCD;"> 表名(字段1[desc|asc],字段2[desc|asc]...)</span></span>
<span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> Books2</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">    bklD </span><span style="color:#F78C6C;">char</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">7</span><span style="color:#A6ACCD;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">    bkName </span><span style="color:#F78C6C;">varchar</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">30</span><span style="color:#A6ACCD;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">    bkAuthor </span><span style="color:#F78C6C;">varchar</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">30</span><span style="color:#A6ACCD;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">    bkPrice </span><span style="color:#F78C6C;">int</span></span>
<span class="line"><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">-- 创建索引</span></span>
<span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">unique</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">index</span><span style="color:#A6ACCD;"> idx_NameAuthor </span><span style="color:#F78C6C;">on</span><span style="color:#A6ACCD;"> Books2(bkName </span><span style="color:#F78C6C;">asc</span><span style="color:#A6ACCD;">,bkAuthor </span><span style="color:#F78C6C;">desc</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#676E95;">-- 查看索引</span></span>
<span class="line"><span style="color:#A6ACCD;">show </span><span style="color:#F78C6C;">index</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Books2;</span></span>
<span class="line"></span></code></pre></div></li></ol><h2 id="存储过程" tabindex="-1">存储过程 <a class="header-anchor" href="#存储过程" aria-hidden="true">#</a></h2><p>(1)什么是存储过程</p><blockquote><p>是一组完成特定功能的SQL语句，经过编译后保存在数据库中的。 用户可以通过存储过程名及参数值来调用存储过程。</p></blockquote><p>(2)为什么要使用存储过程？</p><blockquote><ol><li>模块化编程；</li><li>减少网络流量；</li><li>更快的执行速度；</li><li>提高数据的安全性</li></ol></blockquote><p>(3)如何使用存储过程？</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">procedure</span><span style="color:#A6ACCD;"> 存储过程名([in out inout]参数l数据类型（长度），…)</span></span>
<span class="line"><span style="color:#F78C6C;">begin</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#A6ACCD;"># 过程体；	</span></span>
<span class="line"><span style="color:#F78C6C;">end</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">#</span><span style="color:#F78C6C;">in</span><span style="color:#A6ACCD;">:输入参数（默认）</span></span>
<span class="line"><span style="color:#A6ACCD;">#</span><span style="color:#F78C6C;">out</span><span style="color:#A6ACCD;">:输出参数</span></span>
<span class="line"><span style="color:#A6ACCD;">#inout:输入输出参数</span></span>
<span class="line"></span></code></pre></div><p>-eg:<em>不带参数的存储过程</em></p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">procedure</span><span style="color:#A6ACCD;"> usp_t1</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#F78C6C;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sdept </span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">cs</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">end</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#676E95;">-- 调用存储过程</span></span>
<span class="line"><span style="color:#F78C6C;">call</span><span style="color:#A6ACCD;"> usp_t1</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><p>-eg:<em>带输入参数的存储过程</em></p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">drop</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">procedure</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">exists</span><span style="color:#A6ACCD;"> usp_t1;</span></span>
<span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">procedure</span><span style="color:#A6ACCD;"> usp_t1</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#F78C6C;">in</span><span style="color:#A6ACCD;"> vSdept </span><span style="color:#F78C6C;">char</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">), </span><span style="color:#676E95;">-- 输入参数，in可以省略</span></span>
<span class="line"><span style="color:#F78C6C;">in</span><span style="color:#A6ACCD;"> vSsex </span><span style="color:#F78C6C;">char</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">) </span><span style="color:#676E95;">-- 输入参数，in可以省略</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#F78C6C;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sdept vSdept </span><span style="color:#F78C6C;">and</span><span style="color:#A6ACCD;"> Ssex vSsex;</span></span>
<span class="line"><span style="color:#F78C6C;">end</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#676E95;">-- 调用存储过程</span></span>
<span class="line"><span style="color:#F78C6C;">call</span><span style="color:#A6ACCD;"> usp_t1(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">cS</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">男</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)；</span></span>
<span class="line"><span style="color:#F78C6C;">call</span><span style="color:#A6ACCD;"> usp_t1(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">SE</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">女</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)；</span></span>
<span class="line"></span></code></pre></div><p>eg:<em>带输入参数和输出参数的存储过程</em></p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#676E95;">-- 功能：输入学生的学号，从Stuent:表中删除该生，输出该生的姓名。</span></span>
<span class="line"><span style="color:#676E95;">-- 输入参数：学号</span></span>
<span class="line"><span style="color:#676E95;">-- 输出参数：姓名</span></span>
<span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">procedure</span><span style="color:#A6ACCD;"> usp_t2(</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">in</span><span style="color:#A6ACCD;"> vSno </span><span style="color:#F78C6C;">char</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">7</span><span style="color:#A6ACCD;">),</span><span style="color:#676E95;">-- 输入参数</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">out</span><span style="color:#A6ACCD;"> vSname </span><span style="color:#F78C6C;">varchar</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">4</span><span style="color:#A6ACCD;">)</span><span style="color:#676E95;">-- 输出参数</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#F78C6C;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> Sname </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> vSname </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sno vSno;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">delete</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sno vSno;</span></span>
<span class="line"><span style="color:#F78C6C;">end</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#676E95;">-- 调用存储过程</span></span>
<span class="line"><span style="color:#676E95;">-- 通过用户变量@Sname来接收存储过程输出的值。</span></span>
<span class="line"><span style="color:#F78C6C;">call</span><span style="color:#A6ACCD;"> usp_t2(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2021007</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,@Sname);</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> @Sname;</span></span>
<span class="line"><span style="color:#F78C6C;">call</span><span style="color:#A6ACCD;"> usp_t2(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2021001</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,@Sname);</span></span>
<span class="line"><span style="color:#676E95;">-- 思考：修改过程体中的代码</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> student;</span></span>
<span class="line"></span></code></pre></div><h3 id="delimiter" tabindex="-1">delimiter <a class="header-anchor" href="#delimiter" aria-hidden="true">#</a></h3><blockquote><p>主要用命令行输入SQL语句时会用到。</p><p>用来修改结束符，以在命令中同时书写多个语句。</p></blockquote><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">procedure</span><span style="color:#A6ACCD;"> usp_t2(</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">in</span><span style="color:#A6ACCD;"> vSno </span><span style="color:#F78C6C;">char</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">7</span><span style="color:#A6ACCD;">),</span><span style="color:#676E95;">-- 输入参数</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">out</span><span style="color:#A6ACCD;"> vSname </span><span style="color:#F78C6C;">varchar</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">4</span><span style="color:#A6ACCD;">)</span><span style="color:#676E95;">-- 输出参数</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">delimiter $$</span></span>
<span class="line"><span style="color:#F78C6C;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> Sname </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> vSname </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sno vSno;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">delete</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sno vSno;</span></span>
<span class="line"><span style="color:#F78C6C;">end</span><span style="color:#A6ACCD;"> $$</span></span>
<span class="line"><span style="color:#A6ACCD;">delimiter ;</span></span>
<span class="line"></span></code></pre></div><h2 id="事件处理程序" tabindex="-1">事件处理程序 <a class="header-anchor" href="#事件处理程序" aria-hidden="true">#</a></h2><blockquote><p>保证程序在遇到错误的时候能够继续还行，避免程序异常而停止执行。</p></blockquote><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#676E95;">-- eg</span></span>
<span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> test</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">    c1 </span><span style="color:#F78C6C;">int</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">primary</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">key</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    c2 </span><span style="color:#F78C6C;">varchar</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">10</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;">-- create a stored procedure</span></span>
<span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">procedure</span><span style="color:#A6ACCD;"> usp_t4</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#F78C6C;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> @x </span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">insert</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> test </span><span style="color:#F78C6C;">values</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hello</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> @x </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">insert</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> test </span><span style="color:#F78C6C;">values</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">world</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> @x </span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">end</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#676E95;">-- call</span></span>
<span class="line"><span style="color:#F78C6C;">call</span><span style="color:#A6ACCD;"> usp_t4</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> @x;</span></span>
<span class="line"></span></code></pre></div><p>-MySQL的错误 mysql&gt;use TeachDB; Database changed mysql&gt;delete from tablel; ERROR 1146(42S02):Table &#39;teachdb.table1&#39;doesn&#39;t exist&#39; 两种方法来表示错误 整数类型的错误代码(mysql error code):如1146 长度为5的字符串类型的错误代码(sqlstate_value),如42S02 mysql&gt;insert into test values(1,&#39;world&#39;); ERROR 1062(23000):Duplicate entry &#39;1&#39;for key &#39;test.PRIMARY&#39; 整数类型的错误代码(mysql_error_.code)：1062</p><p>2、事件 create event 执行定时或周期性的任务；</p><h2 id="触发器" tabindex="-1">触发器 <a class="header-anchor" href="#触发器" aria-hidden="true">#</a></h2><blockquote><p><strong>什么是触发器</strong></p><p>触发器trigger,是由事件触发自动执行的一组完成特定功能的SQL语句。</p><p><strong>存储过程和触发器的区别</strong></p><p>存储过程中的这一组SQL语句：需要用户调用存储过程才执行。 触发器中的这一组SQL语句：由事件触发自动执行。</p></blockquote><p>事件：insert,update,delete</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#A6ACCD;">#</span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;">、如何使用触发器</span></span>
<span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> trigger 触发器名 {</span><span style="color:#F78C6C;">before</span><span style="color:#A6ACCD;">|</span><span style="color:#F78C6C;">after</span><span style="color:#A6ACCD;">}{</span><span style="color:#F78C6C;">insert</span><span style="color:#A6ACCD;">|</span><span style="color:#F78C6C;">update</span><span style="color:#A6ACCD;">|</span><span style="color:#F78C6C;">delete</span><span style="color:#A6ACCD;">} on表名</span></span>
<span class="line"><span style="color:#A6ACCD;">for each </span><span style="color:#F78C6C;">row</span></span>
<span class="line"><span style="color:#F78C6C;">begin</span></span>
<span class="line"><span style="color:#89DDFF;">	</span><span style="color:#A6ACCD;">#一组SQL语句；</span></span>
<span class="line"><span style="color:#F78C6C;">end</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#676E95;">-- 例：理解 before</span></span>
<span class="line"><span style="color:#F78C6C;">drop</span><span style="color:#A6ACCD;"> trigger </span><span style="color:#F78C6C;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">exists</span><span style="color:#A6ACCD;"> tri_t1;</span></span>
<span class="line"><span style="color:#A6ACCD;">delimiter </span><span style="color:#89DDFF;">//</span></span>
<span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> trigger tri_t1 </span><span style="color:#F78C6C;">before</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">insert</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">on</span><span style="color:#A6ACCD;"> Student</span></span>
<span class="line"><span style="color:#A6ACCD;">for each </span><span style="color:#F78C6C;">row</span></span>
<span class="line"><span style="color:#F78C6C;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Student表上的触发器执行啦!</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> @Msg;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">count</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> @Count </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student;	</span></span>
<span class="line"><span style="color:#F78C6C;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">//</span></span>
<span class="line"><span style="color:#A6ACCD;">delimiter ;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">-- 测试触发器</span></span>
<span class="line"><span style="color:#F78C6C;">insert</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">values</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2017007</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">王五</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">男</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">20</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">cs</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> @Msg, @Count;  </span></span>
<span class="line"><span style="color:#F78C6C;">insert</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">values</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2017005</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">王五</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">男</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">20</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">cs</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> @Msg, @Count;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">drop</span><span style="color:#A6ACCD;"> trigger </span><span style="color:#F78C6C;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">exists</span><span style="color:#A6ACCD;"> tri_t1;</span></span>
<span class="line"><span style="color:#A6ACCD;">delimiter </span><span style="color:#89DDFF;">//</span></span>
<span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> trigger tri_t1 </span><span style="color:#F78C6C;">after</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">delete</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">on</span><span style="color:#A6ACCD;"> Student</span></span>
<span class="line"><span style="color:#A6ACCD;">for each </span><span style="color:#F78C6C;">row</span></span>
<span class="line"><span style="color:#F78C6C;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Student表上的触发器执行啦!</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> @Msg;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">count</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> @Count </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student;	</span></span>
<span class="line"><span style="color:#F78C6C;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">//</span></span>
<span class="line"><span style="color:#A6ACCD;">delimiter ;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">-- 测试触发器</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> @Msg, @Count;</span></span>
<span class="line"><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> @Msg </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">null</span><span style="color:#A6ACCD;">, @Count </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> @Msg, @Count;</span></span>
<span class="line"><span style="color:#F78C6C;">delete</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sno </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2017005</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> @Msg, @Count;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">drop</span><span style="color:#A6ACCD;"> trigger </span><span style="color:#F78C6C;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">exists</span><span style="color:#A6ACCD;"> tri_t1;</span></span>
<span class="line"><span style="color:#A6ACCD;">delimiter </span><span style="color:#89DDFF;">//</span></span>
<span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> trigger tri_t1 </span><span style="color:#F78C6C;">after</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">insert</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">on</span><span style="color:#A6ACCD;"> Student</span></span>
<span class="line"><span style="color:#A6ACCD;">for each </span><span style="color:#F78C6C;">row</span></span>
<span class="line"><span style="color:#F78C6C;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">	 </span><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> @Sno </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> new.Sno, @Sname </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> new.Sname, </span></span>
<span class="line"><span style="color:#A6ACCD;">	     @Ssex </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> new.Ssex, @Sage </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> new.Sage, @Sdept </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> new.Sdep;</span></span>
<span class="line"><span style="color:#F78C6C;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">//</span></span>
<span class="line"><span style="color:#A6ACCD;">delimiter ;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">-- 测试触发器</span></span>
<span class="line"><span style="color:#F78C6C;">insert</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">values</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2017005</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">王五</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">男</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">20</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">cs</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> @Sno, @Sname, @Ssex, @Sage, @Sdept;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">drop</span><span style="color:#A6ACCD;"> trigger </span><span style="color:#F78C6C;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">exists</span><span style="color:#A6ACCD;"> tri_t1;</span></span>
<span class="line"><span style="color:#A6ACCD;">delimiter </span><span style="color:#89DDFF;">//</span></span>
<span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> trigger tri_t1 </span><span style="color:#F78C6C;">before</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">update</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">on</span><span style="color:#A6ACCD;"> Student</span></span>
<span class="line"><span style="color:#A6ACCD;">for each </span><span style="color:#F78C6C;">row</span></span>
<span class="line"><span style="color:#F78C6C;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">	 </span><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> @Sno1 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> new.Sno, @Sname1 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> new.Sname, </span></span>
<span class="line"><span style="color:#A6ACCD;">	     @Ssex1 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> new.Ssex, @Sage1 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> new.Sage, @Sdept1 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> new.Sdep;</span></span>
<span class="line"><span style="color:#A6ACCD;">	 </span><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> @Sno2 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> old.Sno, @Sname2 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> old.Sname, </span></span>
<span class="line"><span style="color:#A6ACCD;">	     @Ssex2 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> old.Ssex, @Sage2 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> old.Sage, @Sdept2 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> old.Sdep;		 </span></span>
<span class="line"><span style="color:#F78C6C;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">//</span></span>
<span class="line"><span style="color:#A6ACCD;">delimiter ;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">update</span><span style="color:#A6ACCD;"> Student </span><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> Sname </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">王六</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, Ssex </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">女</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, Sage </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">18</span><span style="color:#A6ACCD;">, Sdep </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">EN</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sno </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2017005</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> @Sno1, @Sname1, @Ssex1, @Sage1, @Sdept1;</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> @Sno2, @Sname2, @Ssex2, @Sage2, @Sdept2;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">drop</span><span style="color:#A6ACCD;"> trigger </span><span style="color:#F78C6C;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">exists</span><span style="color:#A6ACCD;"> tri_t1;</span></span>
<span class="line"><span style="color:#A6ACCD;">delimiter </span><span style="color:#89DDFF;">//</span></span>
<span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> trigger tri_t1 </span><span style="color:#F78C6C;">after</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">update</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">on</span><span style="color:#A6ACCD;"> SC</span></span>
<span class="line"><span style="color:#A6ACCD;">for each </span><span style="color:#F78C6C;">row</span></span>
<span class="line"><span style="color:#F78C6C;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> @Count </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> @Count </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">;			 </span></span>
<span class="line"><span style="color:#F78C6C;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">//</span></span>
<span class="line"><span style="color:#A6ACCD;">delimiter ;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">-- 测试触发器</span></span>
<span class="line"><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> @Count </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">update</span><span style="color:#A6ACCD;"> SC </span><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> Grade </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> Grade </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> @Count;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">drop</span><span style="color:#A6ACCD;"> trigger </span><span style="color:#F78C6C;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">exists</span><span style="color:#A6ACCD;"> avgTriggle;</span></span>
<span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> trigger avgTriggle </span><span style="color:#F78C6C;">after</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">insert</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">on</span><span style="color:#A6ACCD;"> sc</span></span>
<span class="line"><span style="color:#A6ACCD;">for each </span><span style="color:#F78C6C;">row</span></span>
<span class="line"><span style="color:#F78C6C;">begin</span></span>
<span class="line"><span style="color:#F78C6C;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">exists</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> avgTable </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sno</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">New.Sno) </span><span style="color:#F78C6C;">then</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#F78C6C;">update</span><span style="color:#A6ACCD;"> avgTable</span></span>
<span class="line"><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> avgGrade</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">avg</span><span style="color:#A6ACCD;">(Grade) </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Sc </span><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sno</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">New.Sno)</span></span>
<span class="line"><span style="color:#F78C6C;">where</span><span style="color:#A6ACCD;"> Sno</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">New.Sno ;</span></span>
<span class="line"><span style="color:#F78C6C;">else</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#F78C6C;">insert</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> avgtable </span><span style="color:#F78C6C;">values</span><span style="color:#A6ACCD;"> (New.Sno,New.Grade); </span></span>
<span class="line"><span style="color:#F78C6C;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">if</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">end</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> sc;</span></span>
<span class="line"><span style="color:#F78C6C;">drop</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">exists</span><span style="color:#A6ACCD;"> avgTable;</span></span>
<span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> avgTable </span><span style="color:#F78C6C;">as</span></span>
<span class="line"><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;">  Sno ,</span><span style="color:#82AAFF;">avg</span><span style="color:#A6ACCD;">(Grade)  avgGrade </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> Sc </span><span style="color:#F78C6C;">group by</span><span style="color:#A6ACCD;"> Sno ;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> TRIGGER AP </span><span style="color:#F78C6C;">AFTER</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">INSERT</span></span>
<span class="line"><span style="color:#F78C6C;">ON</span><span style="color:#A6ACCD;"> SC FOR EACH </span><span style="color:#F78C6C;">ROW</span></span>
<span class="line"><span style="color:#82AAFF;">REPLACE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">INTO</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">AVG</span><span style="color:#A6ACCD;">(Sno,avgGrade) </span><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> Sno,</span><span style="color:#82AAFF;">AVG</span><span style="color:#A6ACCD;">(Grade) </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> SC </span><span style="color:#F78C6C;">GROUP BY</span><span style="color:#A6ACCD;"> Sno;</span></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><h2 id="游标" tabindex="-1">游标 <a class="header-anchor" href="#游标" aria-hidden="true">#</a></h2><blockquote><p>名称是cursor，与一条select关联。</p><p>游标由select语句得到的查询结果集和指向结果集中特定记录的位置指针组成。 <code>select Sno,Sname,Sage from Student;</code></p><p>好处：通过游标可以==逐行地读取==select查询结果集中的记录。</p></blockquote><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">procedure</span><span style="color:#A6ACCD;"> usp_cursor</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#F78C6C;">begin</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">declare</span><span style="color:#A6ACCD;"> done </span><span style="color:#F78C6C;">int</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">declare</span><span style="color:#A6ACCD;"> vSno </span><span style="color:#F78C6C;">char</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">7</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">declare</span><span style="color:#A6ACCD;"> vSname </span><span style="color:#F78C6C;">varchar</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">20</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">declare</span><span style="color:#A6ACCD;"> vSage </span><span style="color:#F78C6C;">int</span><span style="color:#A6ACCD;">;</span><span style="color:#676E95;">-- 声明变量</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">-- 1.声明游标</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">declare</span><span style="color:#A6ACCD;"> curStudent </span><span style="color:#F78C6C;">cursor</span><span style="color:#A6ACCD;"> for </span><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> sno,sname,sage </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> student;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">declare</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">continue</span><span style="color:#A6ACCD;"> handler for </span><span style="color:#F78C6C;">not</span><span style="color:#A6ACCD;"> found </span><span style="color:#F78C6C;">set</span><span style="color:#A6ACCD;"> done</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">-- 2.打开游标</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">open</span><span style="color:#A6ACCD;"> curStudent;</span></span>
<span class="line"><span style="color:#A6ACCD;">    label1:</span><span style="color:#F78C6C;">loop</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">-- 3.使用游标</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F78C6C;">fetch</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">next</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">from</span><span style="color:#A6ACCD;"> curStudent </span><span style="color:#F78C6C;">into</span><span style="color:#A6ACCD;"> vSno,vSname,vSage;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F78C6C;">if</span><span style="color:#A6ACCD;"> done </span><span style="color:#F78C6C;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">            leave label1;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F78C6C;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">if</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F78C6C;">select</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">concat</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">学号</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,vSno,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">姓名</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,vSname,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">年龄</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,vSage);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">end</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">loop</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;">-- 4.关闭游标</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">close</span><span style="color:#A6ACCD;"> curStudent;</span></span>
<span class="line"><span style="color:#F78C6C;">end</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#676E95;">-- 调用</span></span>
<span class="line"><span style="color:#F78C6C;">call</span><span style="color:#A6ACCD;"> usp_cursor</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><h2 id="事务" tabindex="-1">事务 <a class="header-anchor" href="#事务" aria-hidden="true">#</a></h2><blockquote></blockquote><p>-- 执行查询语句，查看查询操作是否使用了索引 explain select<em>from Books2 where bkName=&#39;数据库原理及应用&#39;; explain select</em>from Books2 where bkPrice&gt;50;</p><p>思考：什么样的查询操作不会使用索引？</p><p>-- 系统会自动在主键列或唯一列上创建索引 show index from Student;</p><p><img src="/frontend-blog/assets/5TVJ.d3dad751.png" alt="img"></p><p>难道&lt;&gt;all是和&lt;&gt;some等价吗？</p><p>-- 查询每门课都及格的学生</p></div></div></main><!--[--><!--]--><footer class="VPDocFooter" data-v-37ebe389 data-v-a54a85bd><!----><div class="prev-next" data-v-a54a85bd><div class="pager" data-v-a54a85bd><!----></div><div class="pager" data-v-a54a85bd><a class="pager-link next" href="/frontend-blog/pages/computer-knowledge-stack/db-theorm/" data-v-a54a85bd><span class="desc" data-v-a54a85bd>Next page</span><span class="title" data-v-a54a85bd>数据库原理</span></a></div></div></footer><!--[--><!--]--></div></div></div></div></div><!----><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"index.md\":\"ce14b226\",\"pages_computer-knowledge-stack_index.md\":\"6e47c09b\",\"pages_computer-knowledge-stack_sql_index.md\":\"12f61af7\",\"pages_front-end-stack1_basic_css1_index.md\":\"8d2d8520\",\"pages_front-end-stack1_basic_css2_index.md\":\"8f411985\",\"pages_front-end-stack1_basic_html_index.md\":\"18ffe35f\",\"pages_front-end-stack1_basic_js1_index.md\":\"ea8cbc0b\",\"pages_front-end-stack1_basic_js2_index.md\":\"96ee6f04\",\"pages_front-end-stack1_basic_js3_index.md\":\"3353963a\",\"pages_front-end-stack1_basic_js4_index.md\":\"802cbbfc\",\"pages_front-end-stack1_index.md\":\"8fa34353\",\"pages_front-end-stack1_tools_emmet_index.md\":\"fec99e67\",\"pages_front-end-stack1_tools_jquery_index.md\":\"8c264d95\",\"pages_front-end-stack2_framework_nodejs_index.md\":\"5b67c8f7\",\"pages_front-end-stack2_framework_react_index.md\":\"d4244a66\",\"pages_front-end-stack2_framework_typescript_index.md\":\"d572ebed\",\"pages_front-end-stack2_framework_vue1_index.md\":\"7017104a\",\"pages_front-end-stack2_framework_vue2_index.md\":\"3d6e1a27\",\"pages_front-end-stack2_index.md\":\"f4e2244e\",\"pages_front-end-stack2_vis_canvas_index.md\":\"97d30e53\",\"pages_front-end-stack2_vis_d3_index.md\":\"8047a2b1\",\"pages_front-end-stack2_vis_echarts_index.md\":\"1a25a6b3\",\"pages_front-end-stack2_vis_svg_index.md\":\"fe3fa6e3\",\"pages_thoughts_index.md\":\"8391ee96\"}")</script>
    <script type="module" async src="/frontend-blog/assets/app.1804b206.js"></script>
    
  </body>
</html>